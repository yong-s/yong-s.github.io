<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>搭建 frp 内网穿透服务 | 张三的网络日志</title>
<meta name="keywords" content="frp, 内网穿透">
<meta name="description" content="简单搭建frps 内网穿透服务">
<meta name="author" content="
作者:&nbsp;张三">
<link rel="canonical" href="https://blog.zsan.ml/posts/building-frp-intranet-penetration-service/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.81d291b5bc5da0ffa35066fdfd1ad72fce6ceba3c1990d0831362f7a4aadf938.css" integrity="sha256-gdKRtbxdoP&#43;jUGb9/RrXL85s66PBmQ0IMTYvekqt&#43;Tg=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blog.zsan.ml/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blog.zsan.ml/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blog.zsan.ml/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blog.zsan.ml/apple-touch-icon.png">
<link rel="mask-icon" href="https://blog.zsan.ml/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2X66ETNYD8"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-2X66ETNYD8', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="搭建 frp 内网穿透服务" />
<meta property="og:description" content="简单搭建frps 内网穿透服务" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.zsan.ml/posts/building-frp-intranet-penetration-service/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-14T21:12:45+08:00" />
<meta property="article:modified_time" content="2023-04-22T20:11:26+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="搭建 frp 内网穿透服务"/>
<meta name="twitter:description" content="简单搭建frps 内网穿透服务"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blog.zsan.ml/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "搭建 frp 内网穿透服务",
      "item": "https://blog.zsan.ml/posts/building-frp-intranet-penetration-service/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "搭建 frp 内网穿透服务",
  "name": "搭建 frp 内网穿透服务",
  "description": "简单搭建frps 内网穿透服务",
  "keywords": [
    "frp", "内网穿透"
  ],
  "articleBody": " 必需：有公网IP的服务器一台\n服务端部署 在具有公网 IP 的机器上部署\n采用一键部署脚本安装\nwget https://raw.githubusercontent.com/MvsCode/frps-onekey/master/install-frps.sh -O ./install-frps.sh chmod 700 ./install-frps.sh ./install-frps.sh install 简单用法\nUsage: /etc/init.d/frps {start|stop|restart|status|config|version}\n客户端部署 下载Releases · fatedier/frp · GitHub\n解压缩下载的压缩包，将其中的 frpc 拷贝到内网服务所在的机器上\n配置 这里可以下载配置文件frp/conf at dev · fatedier/frp · GitHub\n服务端配置 下面是服务端的最全配置，一些配置都是可以不用配置的\n# [common] is integral section [common] # A literal address or host name for IPv6 must be enclosed # in square brackets, as in \"[::1]:80\", \"[ipv6-host]:http\" or \"[ipv6-host%zone]:80\" # For single \"bind_addr\" field, no need square brackets, like \"bind_addr = ::\". bind_addr = 0.0.0.0 bind_port = 7000 # udp port to help make udp hole to penetrate nat bind_udp_port = 7001 # udp port used for kcp protocol, it can be same with 'bind_port'. # if not set, kcp is disabled in frps. kcp_bind_port = 7000 # udp port used for quic protocol. # if not set, quic is disabled in frps. # quic_bind_port = 7002 # quic protocol options # quic_keepalive_period = 10 # quic_max_idle_timeout = 30 # quic_max_incoming_streams = 100000 # specify which address proxy will listen for, default value is same with bind_addr # proxy_bind_addr = 127.0.0.1 # if you want to support virtual host, you must set the http port for listening (optional) # Note: http port and https port can be same with bind_port vhost_http_port = 80 vhost_https_port = 443 # response header timeout(seconds) for vhost http server, default is 60s # vhost_http_timeout = 60 # tcpmux_httpconnect_port specifies the port that the server listens for TCP # HTTP CONNECT requests. If the value is 0, the server will not multiplex TCP # requests on one single port. If it's not - it will listen on this value for # HTTP CONNECT requests. By default, this value is 0. # tcpmux_httpconnect_port = 1337 # If tcpmux_passthrough is true, frps won't do any update on traffic. # tcpmux_passthrough = false # set dashboard_addr and dashboard_port to view dashboard of frps # dashboard_addr's default value is same with bind_addr # dashboard is available only if dashboard_port is set # 管理面板 dashboard_addr = 0.0.0.0 dashboard_port = 7500 # dashboard user and passwd for basic auth protect dashboard_user = admin dashboard_pwd = admin # dashboard TLS mode dashboard_tls_mode = false # dashboard_tls_cert_file = server.crt # dashboard_tls_key_file = server.key # enable_prometheus will export prometheus metrics on {dashboard_addr}:{dashboard_port} in /metrics api. enable_prometheus = true # dashboard assets directory(only for debug mode) # assets_dir = ./static # console or real logFile path like ./frps.log log_file = ./frps.log # trace, debug, info, warn, error log_level = info log_max_days = 3 # disable log colors when log_file is console, default is false disable_log_color = false # DetailedErrorsToClient defines whether to send the specific error (with debug info) to frpc. By default, this value is true. detailed_errors_to_client = true # authentication_method specifies what authentication method to use authenticate frpc with frps. # If \"token\" is specified - token will be read into login message. # If \"oidc\" is specified - OIDC (Open ID Connect) token will be issued using OIDC settings. By default, this value is \"token\". authentication_method = token # authenticate_heartbeats specifies whether to include authentication token in heartbeats sent to frps. By default, this value is false. authenticate_heartbeats = false # AuthenticateNewWorkConns specifies whether to include authentication token in new work connections sent to frps. By default, this value is false. authenticate_new_work_conns = false # auth token token = 12345678 # oidc_issuer specifies the issuer to verify OIDC tokens with. # By default, this value is \"\". oidc_issuer = # oidc_audience specifies the audience OIDC tokens should contain when validated. # By default, this value is \"\". oidc_audience = # oidc_skip_expiry_check specifies whether to skip checking if the OIDC token is expired. # By default, this value is false. oidc_skip_expiry_check = false # oidc_skip_issuer_check specifies whether to skip checking if the OIDC token's issuer claim matches the issuer specified in OidcIssuer. # By default, this value is false. oidc_skip_issuer_check = false # heartbeat configure, it's not recommended to modify the default value # the default value of heartbeat_timeout is 90. Set negative value to disable it. # heartbeat_timeout = 90 # user_conn_timeout configure, it's not recommended to modify the default value # the default value of user_conn_timeout is 10 # user_conn_timeout = 10 # only allow frpc to bind ports you list, if you set nothing, there won't be any limit allow_ports = 2000-3000,3001,3003,4000-50000 # pool_count in each proxy will change to max_pool_count if they exceed the maximum value max_pool_count = 5 # max ports can be used for each client, default value is 0 means no limit max_ports_per_client = 0 # tls_only specifies whether to only accept TLS-encrypted connections. By default, the value is false. tls_only = false # tls_cert_file = server.crt # tls_key_file = server.key # tls_trusted_ca_file = ca.crt # if subdomain_host is not empty, you can set subdomain when type is http or https in frpc's configure file # when subdomain is test, the host used by routing is test.frps.com subdomain_host = frps.com # if tcp stream multiplexing is used, default is true # tcp_mux = true # specify keep alive interval for tcp mux. # only valid if tcp_mux is true. # tcp_mux_keepalive_interval = 60 # tcp_keepalive specifies the interval between keep-alive probes for an active network connection between frpc and frps. # If negative, keep-alive probes are disabled. # tcp_keepalive = 7200 # custom 404 page for HTTP requests # custom_404_page = /path/to/404.html # specify udp packet size, unit is byte. If not set, the default value is 1500. # This parameter should be same between client and server. # It affects the udp and sudp proxy. udp_packet_size = 1500 # Enable golang pprof handlers in dashboard listener. # Dashboard port must be set first pprof_enable = false [plugin.user-manager] addr = 127.0.0.1:9000 path = /handler ops = Login [plugin.port-manager] addr = 127.0.0.1:9001 path = /handler ops = NewProxy 配置完成之后\n/etc/init.d/frps start\n公网IP:dashboard_port访问管理面板\n客户端配置 [common] server_addr = 服务端公网IP #服务端bind_addr server_port = 7000 #服务端bind_port token = 服务端auth_token [服务名字] # 远程访问端口 remote_port = 8888 type = tcp local_ip = 192.168.1.9 local_port = 8888 [服务名字] # 远程访问端口 remote_port = 8889 type = tcp local_ip = 192.168.1.77 local_port = 8889 启动\n./frpc -c ./frpc.ini\n",
  "wordCount" : "1239",
  "inLanguage": "zh",
  "datePublished": "2023-03-14T21:12:45+08:00",
  "dateModified": "2023-04-22T20:11:26.03523675+08:00",
  "author":[{
    "@type": "Person",
    "name": "张三"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blog.zsan.ml/posts/building-frp-intranet-penetration-service/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "张三的网络日志",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blog.zsan.ml/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blog.zsan.ml/" accesskey="h" title="张三的网络日志 (Alt + H)">张三的网络日志</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blog.zsan.ml/search" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://blog.zsan.ml/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://blog.zsan.ml/tags" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://blog.zsan.ml/about" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blog.zsan.ml/">主页</a>&nbsp;»&nbsp;<a href="https://blog.zsan.ml/posts/">Posts</a></div>
    <h1 class="post-title">
      搭建 frp 内网穿透服务
    </h1>
    <div class="post-description">
      简单搭建frps 内网穿透服务
    </div>
    <div class="post-meta">










创建:&nbsp;<span title='2023-03-14 21:12:45 +0800 CST'>2023-03-14</span>&nbsp;|&nbsp;更新:&nbsp;2023-04-22&nbsp;|&nbsp;字数:&nbsp;1239字&nbsp;|&nbsp;时长: 3分钟&nbsp;|&nbsp;
作者:&nbsp;张三

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e6%9c%8d%e5%8a%a1%e7%ab%af%e9%83%a8%e7%bd%b2" aria-label="服务端部署">服务端部署</a></li>
                    <li>
                        <a href="#%e5%ae%a2%e6%88%b7%e7%ab%af%e9%83%a8%e7%bd%b2" aria-label="客户端部署">客户端部署</a></li>
                    <li>
                        <a href="#%e9%85%8d%e7%bd%ae" aria-label="配置">配置</a><ul>
                            
                    <li>
                        <a href="#%e6%9c%8d%e5%8a%a1%e7%ab%af%e9%85%8d%e7%bd%ae" aria-label="服务端配置">服务端配置</a></li>
                    <li>
                        <a href="#%e5%ae%a2%e6%88%b7%e7%ab%af%e9%85%8d%e7%bd%ae" aria-label="客户端配置">客户端配置</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>


  
  <div class="post-content"><blockquote>
<p>必需：有公网IP的服务器一台</p>
</blockquote>
<h2 id="服务端部署">服务端部署<a hidden class="anchor" aria-hidden="true" href="#服务端部署">#</a></h2>
<p>在具有公网 IP 的机器上部署</p>
<p>采用<a href="https://github.com/MvsCode/frps-onekey">一键部署脚本安装</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget https://raw.githubusercontent.com/MvsCode/frps-onekey/master/install-frps.sh -O ./install-frps.sh
</span></span><span style="display:flex;"><span>chmod <span style="color:#ae81ff">700</span> ./install-frps.sh
</span></span><span style="display:flex;"><span>./install-frps.sh install
</span></span></code></pre></div><p>简单用法</p>
<p><code> Usage: /etc/init.d/frps {start|stop|restart|status|config|version}</code></p>
<h2 id="客户端部署">客户端部署<a hidden class="anchor" aria-hidden="true" href="#客户端部署">#</a></h2>
<p>下载<a href="https://github.com/fatedier/frp/releases">Releases · fatedier/frp · GitHub</a></p>
<p>解压缩下载的压缩包，将其中的 frpc 拷贝到内网服务所在的机器上</p>
<h2 id="配置">配置<a hidden class="anchor" aria-hidden="true" href="#配置">#</a></h2>
<p>这里可以下载配置文件<a href="https://github.com/fatedier/frp/tree/dev/conf">frp/conf at dev · fatedier/frp · GitHub</a></p>
<h3 id="服务端配置">服务端配置<a hidden class="anchor" aria-hidden="true" href="#服务端配置">#</a></h3>
<p>下面是服务端的最全配置，一些配置都是可以不用配置的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#75715e"># [common] is integral section</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[common]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># A literal address or host name for IPv6 must be enclosed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># in square brackets, as in &#34;[::1]:80&#34;, &#34;[ipv6-host]:http&#34; or &#34;[ipv6-host%zone]:80&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For single &#34;bind_addr&#34; field, no need square brackets, like &#34;bind_addr = ::&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0.0.0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># udp port to help make udp hole to penetrate nat</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_udp_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7001</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># udp port used for kcp protocol, it can be same with &#39;bind_port&#39;.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if not set, kcp is disabled in frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">kcp_bind_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># udp port used for quic protocol.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if not set, quic is disabled in frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_bind_port = 7002</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic protocol options</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_keepalive_period = 10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_max_idle_timeout = 30</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_max_incoming_streams = 100000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># specify which address proxy will listen for, default value is same with bind_addr</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># proxy_bind_addr = 127.0.0.1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if you want to support virtual host, you must set the http port for listening (optional)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Note: http port and https port can be same with bind_port</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vhost_http_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">80</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vhost_https_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">443</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># response header timeout(seconds) for vhost http server, default is 60s</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># vhost_http_timeout = 60</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcpmux_httpconnect_port specifies the port that the server listens for TCP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HTTP CONNECT requests. If the value is 0, the server will not multiplex TCP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># requests on one single port. If it&#39;s not - it will listen on this value for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HTTP CONNECT requests. By default, this value is 0.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcpmux_httpconnect_port = 1337</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If tcpmux_passthrough is true, frps won&#39;t do any update on traffic.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcpmux_passthrough = false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># set dashboard_addr and dashboard_port to view dashboard of frps</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard_addr&#39;s default value is same with bind_addr</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard is available only if dashboard_port is set</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 管理面板</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0.0.0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard user and passwd for basic auth protect</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_user</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">admin</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_pwd</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">admin</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard TLS mode</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_tls_mode</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard_tls_cert_file = server.crt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard_tls_key_file = server.key</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># enable_prometheus will export prometheus metrics on {dashboard_addr}:{dashboard_port} in /metrics api.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">enable_prometheus</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard assets directory(only for debug mode)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># assets_dir = ./static</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># console or real logFile path like ./frps.log</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_file</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">./frps.log</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># trace, debug, info, warn, error</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_level</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">info</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_max_days</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># disable log colors when log_file is console, default is false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">disable_log_color</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># DetailedErrorsToClient defines whether to send the specific error (with debug info) to frpc. By default, this value is true.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">detailed_errors_to_client</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># authentication_method specifies what authentication method to use authenticate frpc with frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If &#34;token&#34; is specified - token will be read into login message.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If &#34;oidc&#34; is specified - OIDC (Open ID Connect) token will be issued using OIDC settings. By default, this value is &#34;token&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">authentication_method</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">token</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># authenticate_heartbeats specifies whether to include authentication token in heartbeats sent to frps. By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">authenticate_heartbeats</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># AuthenticateNewWorkConns specifies whether to include authentication token in new work connections sent to frps. By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">authenticate_new_work_conns</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># auth token</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">12345678</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_issuer specifies the issuer to verify OIDC tokens with.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is &#34;&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_issuer</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_audience specifies the audience OIDC tokens should contain when validated.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is &#34;&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_audience</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_skip_expiry_check specifies whether to skip checking if the OIDC token is expired.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_skip_expiry_check</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_skip_issuer_check specifies whether to skip checking if the OIDC token&#39;s issuer claim matches the issuer specified in OidcIssuer.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_skip_issuer_check</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># heartbeat configure, it&#39;s not recommended to modify the default value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the default value of heartbeat_timeout is 90. Set negative value to disable it.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># heartbeat_timeout = 90</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># user_conn_timeout configure, it&#39;s not recommended to modify the default value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the default value of user_conn_timeout is 10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># user_conn_timeout = 10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># only allow frpc to bind ports you list, if you set nothing, there won&#39;t be any limit</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allow_ports</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">2000-3000,3001,3003,4000-50000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># pool_count in each proxy will change to max_pool_count if they exceed the maximum value</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_pool_count</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># max ports can be used for each client, default value is 0 means no limit</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_ports_per_client</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_only specifies whether to only accept TLS-encrypted connections. By default, the value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tls_only</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_cert_file = server.crt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_key_file = server.key</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_trusted_ca_file = ca.crt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if subdomain_host is not empty, you can set subdomain when type is http or https in frpc&#39;s configure file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># when subdomain is test, the host used by routing is test.frps.com</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">subdomain_host</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">frps.com</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if tcp stream multiplexing is used, default is true</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_mux = true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># specify keep alive interval for tcp mux.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># only valid if tcp_mux is true.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_mux_keepalive_interval = 60</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_keepalive specifies the interval between keep-alive probes for an active network connection between frpc and frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If negative, keep-alive probes are disabled.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_keepalive = 7200</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># custom 404 page for HTTP requests</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># custom_404_page = /path/to/404.html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># specify udp packet size, unit is byte. If not set, the default value is 1500.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This parameter should be same between client and server.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># It affects the udp and sudp proxy.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">udp_packet_size</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enable golang pprof handlers in dashboard listener.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Dashboard port must be set first</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pprof_enable</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[plugin.user-manager]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">127.0.0.1:9000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">path</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/handler</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ops</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">Login</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[plugin.port-manager]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">127.0.0.1:9001</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">path</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/handler</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ops</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">NewProxy</span>
</span></span></code></pre></div><p>配置完成之后</p>
<p><code>/etc/init.d/frps start</code></p>
<p><code>公网IP:dashboard_port</code>访问管理面板</p>
<h3 id="客户端配置">客户端配置<a hidden class="anchor" aria-hidden="true" href="#客户端配置">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#66d9ef">[common]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server_addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">服务端公网IP #服务端bind_addr</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7000 #服务端bind_port</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">服务端auth_token</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[服务名字]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 远程访问端口</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">remote_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8888</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">type</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">tcp</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_ip</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">192.168.1.9</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8888</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[服务名字]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 远程访问端口</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">remote_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8889</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">type</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">tcp</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_ip</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">192.168.1.77</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8889</span>
</span></span></code></pre></div><p>启动</p>
<p><code>./frpc -c ./frpc.ini</code></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blog.zsan.ml/tags/frp/">frp</a></li>
      <li><a href="https://blog.zsan.ml/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/">内网穿透</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blog.zsan.ml/posts/setting-up-server-monitoring-service-nezha-probe/">
    <span class="title">« 上一页</span>
    <br>
    <span>搭建服务器监控服务-哪吒探针</span>
  </a>
  <a class="next" href="https://blog.zsan.ml/posts/nfc-card-simulation-access-control/">
    <span class="title">下一页 »</span>
    <br>
    <span>NFC 复制模拟门禁卡</span>
  </a>
</nav>

  </footer>
<div>
    <div class="pagination__title">
        <span class="pagination__title-h" style="font-size: 20px;">评论</span>
        <hr />
    </div>
    <div id="tcomment"></div>
    <script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js"></script>
    <script>
        twikoo.init({
            envId: "https://twikoo.zsan.ml/",  
            el: "#tcomment",
            lang: 'zh-CN',
            
            path: 'window.TWIKOO_MAGIC_PATH||window.location.pathname',
        });
    </script>
</div>

</article>
    </main>
    
<footer class="footer">
    <span><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">CC BY-NC-SA 4.0</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
