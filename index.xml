<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>张三的网络日志</title>
    <link>https://blog.zsan.cf/</link>
    <description>Recent content on 张三的网络日志</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh&#34; target=&#34;_blank&#34;&gt;CC BY-NC-SA 4.0&lt;/a&gt;</copyright>
    <lastBuildDate>Sun, 11 Jun 2023 18:35:38 +0800</lastBuildDate><atom:link href="https://blog.zsan.cf/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Docker更换默认目录</title>
      <link>https://blog.zsan.cf/posts/docker-change-directory/</link>
      <pubDate>Sun, 11 Jun 2023 18:35:38 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/docker-change-directory/</guid>
      <description>查询目前已安装的路径 sudo docker info | grep &amp;quot;Docker Root Dir&amp;quot;
备份旧数据到新目录 cp -a /var/lib/docker /path/to/docker
修改配置文件 docker 版本 &amp;gt; 17.05 vim /etc/docker/daemon.json
{ &amp;#34;data-root&amp;#34;: &amp;#34;/path/to/docker&amp;#34;, &amp;#34;storage-driver&amp;#34;: &amp;#34;overlay2&amp;#34; # 这个是Docker的默认设置，这里也可以不用加 } 重启docker sudo systemctl restart docker
参考 两种方式迁移Docker</description>
      <content:encoded><![CDATA[<h2 id="查询目前已安装的路径">查询目前已安装的路径</h2>
<p><code>sudo docker info | grep &quot;Docker Root Dir&quot;</code></p>
<h2 id="备份旧数据到新目录">备份旧数据到新目录</h2>
<p><code>cp -a /var/lib/docker /path/to/docker</code></p>
<h2 id="修改配置文件">修改配置文件</h2>
<h3 id="docker-版本--1705">docker 版本 &gt; 17.05</h3>
<p><code>vim /etc/docker/daemon.json</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;data-root&#34;</span>: <span style="color:#e6db74">&#34;/path/to/docker&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;storage-driver&#34;</span>: <span style="color:#e6db74">&#34;overlay2&#34;</span>   <span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#960050;background-color:#1e0010">这个是Docker的默认设置，这里也可以不用加</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="重启docker">重启docker</h2>
<p><code>sudo systemctl restart docker</code></p>
<h2 id="参考">参考</h2>
<blockquote>
<p><a href="https://strikefreedom.top/archives/migrate-docker-installation-directory">两种方式迁移Docker</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>保护您的服务器</title>
      <link>https://blog.zsan.cf/posts/set-up-and-secure/</link>
      <pubDate>Sun, 04 Jun 2023 16:59:21 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/set-up-and-secure/</guid>
      <description>新买的服务器通常需要一系列保护措施</description>
      <content:encoded><![CDATA[<h2 id="执行系统更新">执行系统更新</h2>
<p>经常更新您的系统是您可以对任何操作系统采取的最大的安全预防措施。软件更新的范围从关键漏洞补丁到小错误修复，许多软件漏洞在公开时实际上已经被修补。更新还为您提供了可用于您的分发的最新软件版本。</p>
<h3 id="ubuntudebian-和-kali-linux">Ubuntu、Debian 和 Kali Linux</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt update <span style="color:#f92672">&amp;&amp;</span> apt upgrade
</span></span></code></pre></div><h3 id="centosrhel-stream-和-fedora">CentOS/RHEL Stream 和 Fedora</h3>
<p>包括 CentOS Stream 8（及更高版本）、CentOS 8、其他 RHEL 衍生产品（包括 AlmaLinux 8 和 Rocky Linux 8）和 Fedora</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dnf upgrade
</span></span></code></pre></div><h2 id="设置时区">设置时区</h2>
<p>默认情况下，所有新的计算实例都设置为 UTC 时间。但是，您可能更喜欢使用您居住的时区，因此日志文件时间戳是相对于您当地时间的。</p>
<h3 id="大多数发行版">大多数发行版</h3>
<p>包括 CentOS Stream 8（及更新版本）、CentOS 7（及更新版本）、其他 RHEL 衍生产品（包括 AlmaLinux 8 和 Rocky Linux 8）、Fedora 和 Arch。这些说明也适用于大多数 Ubuntu、Debian 和 openSUSE 发行版，但在这些情况下可能首选其他方法。</p>
<ol>
<li>
<p>使用 <code>timedatectl</code> 输出可用时区列表</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>timedatectl list-timezones
</span></span></code></pre></div></li>
<li>
<p>使用箭头键、 <code>Page Up</code> 和 <code>Page Down</code> 浏览列表。复制或记下您想要的时区，然后按 q 退出列表。</p>
</li>
<li>
<p>使用以下命令设置时区，将 America/New_York 替换为您喜欢的时区。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>timedatectl set-timezone <span style="color:#e6db74">&#39;America/New_York&#39;</span>
</span></span></code></pre></div></li>
</ol>
<h3 id="ubuntu-debian-和-kali-linux">Ubuntu, Debian 和 Kali Linux</h3>
<p>Ubuntu 和 Debian 都带有一个更友好的工具，称为 <code>tzdata</code></p>
<ol>
<li>
<p>打开 <code>tzdata</code> 工具</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dpkg-reconfigure tzdata
</span></span></code></pre></div></li>
<li>
<p>使用箭头键选择您选择的大陆，然后按 Enter</p>
</li>
<li>
<p>使用箭头键选择您所在的地区，然后按 Enter</p>
</li>
</ol>
<h3 id="检查时间">检查时间</h3>
<p>使用 <code>date</code> 命令根据您的服务器查看当前日期和时间</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@localhost:~# date
</span></span><span style="display:flex;"><span>Thu Feb <span style="color:#ae81ff">16</span> 12:17:52 EST <span style="color:#ae81ff">2018</span>
</span></span></code></pre></div><h2 id="配置自定义主机名">配置自定义主机名</h2>
<p>主机名用于使用易于记忆的名称来标识您的计算实例。它可以是描述性的和结构化的（详细说明系统的用途）或通用词或短语。</p>
<p>简单点就是默认有 <code>locahost</code>变为你设置的新的<code>web-app</code>名字，还可用作系统的 FQDN（完全限定域名）的一部分。</p>
<h3 id="大多数发行版-1">大多数发行版</h3>
<p>将 <code>example-hostname</code> 替换为您的选择之一</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hostnamectl set-hostname example-hostname
</span></span></code></pre></div><h3 id="更新系统的hosts文件">更新系统的<code>hosts</code>文件</h3>
<p><code>hosts</code> 文件在 IP 地址和主机名或域之间创建静态关联，系统优先考虑在 DNS 之前进行名称解析</p>
<ol>
<li>
<p>在文本编辑器（例如 Nano）中打开 <code>hosts</code> 文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nano /etc/hosts
</span></span></code></pre></div></li>
<li>
<p>为您的计算实例的公共 IP 地址添加一行。您可以将此地址与实例的完全限定域名 (FQDN) 相关联（如果有的话），并与您在上述步骤中设置的本地主机名相关联。在下面的示例中， <code>203.0.113.10</code> 是公共 IP 地址， <code>example-hostname</code> 是本地主机名， <code>example-hostname.example.com</code> 是 FQDN</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>127.0.0.1 localhost.localdomain localhost 
</span></span><span style="display:flex;"><span>203.0.113.10 example-hostname.example.com example-hostname
</span></span></code></pre></div></li>
<li>
<p>为您的计算实例的 IPv6 地址添加一行。如果没有此条目，需要 IPv6 的应用程序将无法运行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>127.0.0.1 localhost.localdomain localhost
</span></span><span style="display:flex;"><span>203.0.113.10 example-hostname.example.com example-hostname
</span></span><span style="display:flex;"><span>2600:3c01::a123:b456:c789:d012 example-hostname.example.com example-hostname
</span></span></code></pre></div></li>
</ol>
<p>由于这里并没有配置<code>FQDN</code>所以只修改了<code>127.0.1.1</code></p>
<h2 id="添加受限用户账户">添加受限用户账户</h2>
<p>到目前为止，您已经以 <code>root</code> 用户的身份访问了您的计算实例，该用户拥有无限的权限并且可以执行任何命令——甚至是可能会意外中断您的服务器的命令。我们建议创建一个受限用户帐户并始终使用该帐户。管理任务将使用 <code>sudo</code> 来临时提升您的受限用户的权限，以便您可以管理您的服务器。稍后，当您想要限制用户的 sudo 访问权限时，请参阅 Linux 用户和组。</p>
<h3 id="ubuntu-和-debian">Ubuntu 和 Debian</h3>
<ol>
<li>
<p>创建用户，用你想要的用户名替换 <code>example_user</code> 。然后，系统会要求您为用户分配一个密码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adduser example_user
</span></span></code></pre></div></li>
<li>
<p>将用户添加到 <code>sudo</code> 组，以便您拥有管理权限：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>adduser example_user sudo
</span></span></code></pre></div></li>
</ol>
<h3 id="centosrhel-stream-和-fedora-1">CentOS/RHEL Stream 和 Fedora</h3>
<ol>
<li>
<p>创建用户，用你想要的用户名替换 <code>example_user</code> ，并指定一个密码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>useradd example_user <span style="color:#f92672">&amp;&amp;</span> passwd example_user
</span></span></code></pre></div></li>
<li>
<p>将用户添加到 <code>wheel</code> 组以获得 sudo 权限：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>usermod -aG wheel example_user
</span></span></code></pre></div></li>
</ol>
<h3 id="以新用户身份登录">以新用户身份登录</h3>
<ol>
<li>
<p>创建受限用户后，断开与计算实例的连接：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>exit
</span></span></code></pre></div></li>
<li>
<p>以您的新用户身份重新登录。将 <code>example_user</code> 替换为您的用户名，将示例 IP 地址替换为您实例的 IP 地址：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh example_user@192.0.2.1
</span></span></code></pre></div></li>
</ol>
<p>现在您可以从您的新用户帐户而不是 <code>root</code> 管理您的计算实例。几乎所有超级用户命令都可以使用 <code>sudo</code> （例如： <code>sudo iptables -L -nv</code> ）执行，这些命令将被记录到 <code>/var/log/auth.log</code> </p>
<h2 id="安全访问ssh">安全访问ssh</h2>
<p>默认情况下，密码身份验证用于通过 SSH 连接到您的计算实例。加密密钥对更安全，因为私钥取代了密码，而密码通常更难通过暴力解密。在本节中，我们将创建一个密钥对并将您的系统配置为不接受 SSH 登录的密码。</p>
<h3 id="创建身份密钥对ssh-key">创建身份密钥对ssh-key</h3>
<ol>
<li>
<p>命令创建</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-keygen -b <span style="color:#ae81ff">4096</span>
</span></span></code></pre></div></li>
<li>
<p>公钥上传到您的服务器</p>
<ul>
<li><strong>Linux</strong></li>
</ul>
<p>从您的本地计算机：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-copy-id example_user@192.0.2.1
</span></span></code></pre></div><ul>
<li><strong>macOS</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>scp ~/.ssh/id_rsa.pub example_user@203.0.113.10:~/.ssh/authorized_keys
</span></span></code></pre></div></li>
<li>
<p>最后，您需要为公钥目录和密钥文件本身设置权限</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chmod -R <span style="color:#ae81ff">700</span> ~/.ssh <span style="color:#f92672">&amp;&amp;</span> chmod <span style="color:#ae81ff">600</span> ~/.ssh/authorized_keys
</span></span></code></pre></div></li>
<li>
<p>现在退出并重新登录到您的计算实例</p>
</li>
</ol>
<h3 id="ssh守护进程设置">ssh守护进程设置</h3>
<ol>
<li>
<p>使用 Linux 文本编辑器（例如 nano 或 vim）打开计算实例上的 SSH 配置文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nano /etc/ssh/sshd_config
</span></span></code></pre></div></li>
<li>
<p>禁止通过 SSH 进行 root 登录。这要求所有 SSH 连接都由非 root 用户进行。一旦连接了受限用户帐户，就可以通过使用 <code>sudo</code> 或使用 <code>su -</code> 更改为root shell 来访问管理权限。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Authentication:</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>PermitRootLogin no
</span></span></code></pre></div></li>
<li>
<p>禁用 SSH 密码验证。这要求所有通过 SSH 连接的用户都使用密钥身份验证。根据 Linux 发行版，可能需要添加行 <code>PasswordAuthentication</code> ，或者通过删除前导 <code>#</code> 来取消注释。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Change to no to disable tunnelled clear text passwords</span>
</span></span><span style="display:flex;"><span>PasswordAuthentication no
</span></span></code></pre></div></li>
<li>
<p>只监听一种互联网协议。默认情况下，SSH 守护程序监听通过 IPv4 和 IPv6 的传入连接。除非您需要使用这两种协议通过 SSH 连接到您的计算实例，否则请禁用您不需要的任何一个。这不会在系统范围内禁用该协议，它仅适用于 SSH 守护进程。根据 Linux 发行版，可能需要添加行 <code>AddressFamily</code> ，或者通过删除前导 <code>#</code> 取消注释</p>
</li>
</ol>
<p>   Use the option: 使用选项：</p>
<p>      <code>AddressFamily inet</code> 仅在 IPv4 上侦听。</p>
<p>      <code>AddressFamily inet6</code> 仅在 IPv6 上侦听。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Port 22</span>
</span></span><span style="display:flex;"><span> AddressFamily inet
</span></span></code></pre></div><ol start="5">
<li>重新启动 SSH 服务以加载新配置</li>
</ol>
<ul>
<li>
<p>如果您使用的是使用 systemd 的 Linux 发行版（CentOS 7、Debian 8、Fedora、Ubuntu 15.10+）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart sshd
</span></span></code></pre></div></li>
<li>
<p>如果您的初始化系统是 SystemV 或 Upstart（CentOS 6、Debian 7、Ubuntu 14.04）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo service sshd restart
</span></span></code></pre></div></li>
</ul>
<h3 id="使用fail2ban保护ssh登录">使用Fail2Ban保护ssh登录</h3>
<p>Fail2Ban 是一个应用程序，它可以在登录尝试失败次数过多后禁止 IP 地址登录您的服务器。由于合法登录通常不会超过三次尝试成功（并且使用 SSH 密钥，最多不会超过一次），因此服务器被不成功登录的垃圾邮件表明试图进行恶意访问</p>
<p>Fail2Ban 可以监控多种协议，包括 SSH、HTTP 和 SMTP。默认情况下，Fail2Ban 仅监控 SSH，并且对任何服务器都是一种有用的安全威慑，因为 SSH 守护程序通常配置为持续运行并侦听来自任何远程 IP 地址的连接</p>
<p>具体可参考<a href="https://www.linode.com/docs/guides/using-fail2ban-to-secure-your-server-a-tutorial/">这篇</a></p>
<p>参考：</p>
<blockquote>
<p>大部分是摘抄下文并做了汉化，国内这些资料太少了😢</p>
<p><a href="https://www.linode.com/docs/products/compute/compute-instances/guides/set-up-and-secure/">Guides - Setting Up and Securing a Compute Instance</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>hugo更换404公益页面</title>
      <link>https://blog.zsan.cf/posts/404public-interest/</link>
      <pubDate>Sun, 28 May 2023 19:49:45 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/404public-interest/</guid>
      <description>layouts文件夹，新建404.html
&amp;lt;!DOCTYPE HTML&amp;gt; &amp;lt;html&amp;gt; &amp;lt;head&amp;gt; &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34; /&amp;gt; &amp;lt;meta name=&amp;#34;description&amp;#34; content=&amp;#34;公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。&amp;#34; /&amp;gt; &amp;lt;link rel=&amp;#34;icon&amp;#34; href=&amp;#34;data:image/gif;base64,R0lGODdhIAAgANUAAAAAAAgFBgYICAwMDBAPDxAQDxQTFBUYFxcaGRwcHCQkJCQoJykqKTQ0ND09PUJCQktMTFZWVltcXF1hYGNjY2doaGpqanNzc3d5eHp6eoODg4uLi5eXl5mamqOjo62tra+wr7S0tLe5uLu7u7/AwMPEw83NzdbX1tfa2dra2uTk5Ovr6+/w7/T09Pj39/f4+P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkAADEALAAAAAAgACAAAAb/QJhwOGyZOpIGQ6FgNCQcU4tIrcJaIwlgy+1uJaOplZqydBOSzGaTkSS6lNN4ONoOAJRQajV0rVAgFF0jcyEAbw9hc1cjD4cAIVZ1DAAXKotEKxkAlIREJ48bYphFGwAKAHJCLWaVo6RFF1sWYnUDDpewVSoOd4QtWgCeMCmXLaqfUyopdF9GWxRiKQAVKh3CRHUdKhQEzFeCAEdbH6uOh28A3ypbCQhbEGIfWx2CCd8wJhB2CpFDIQvuAIBgYkiKN0kASOAzRJYjBwyFrGgAwNGFTFqUAMjwYogpA1woMFwRDgDIDUQ2LQGAcoiGLRr2QRgp8yUADURMMWFJRYMH3BglJOQSwq0EDA84c56ilOGVLisqKUaISKVFihIjRJRI4XTIiggAGggygKxICAoguSDI0/UEyAnXAJTLJMtLlwxUYcwD0MEEtIgtBKGi0OHDh3qn8IwKvEVKuGHXGAwI8apFCAOUOvxzBqNOAVzgthi1UgKasl7YrtS9MMXI6DEjpKieNWoaSA1dF7V4+QafkNKoLOlSIQsVCUkmATgYwWIRCxEOAByANKc0AAEAJnzYI6bFihQfBAUQjSlF3S0GIqjZgCFC2i0XfM/BUtJuSEVPjdRTwsQJYdljBAEAOw==&amp;#34;&amp;gt; &amp;lt;title&amp;gt;404 您访问的页面搞丢了&amp;lt;/title&amp;gt; &amp;lt;/head&amp;gt; &amp;lt;body&amp;gt; &amp;lt;script&amp;gt; let s = document.createElement(&amp;#34;script&amp;#34;); s.src=&amp;#34;//volunteer.cdn-go.cn/404/latest/404.js&amp;#34; s.crossorigin=&amp;#34;anonymous&amp;#34; document.getElementsByTagName(&amp;#34;head&amp;#34;)[0].appendChild(s); &amp;lt;/script&amp;gt; &amp;lt;/body&amp;gt; &amp;lt;/html&amp;gt; &amp;lt;!-- */ //--&amp;gt; </description>
      <content:encoded><![CDATA[<p>layouts文件夹，新建<code>404.html</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE HTML&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;description&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;icon&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;data:image/gif;base64,R0lGODdhIAAgANUAAAAAAAgFBgYICAwMDBAPDxAQDxQTFBUYFxcaGRwcHCQkJCQoJykqKTQ0ND09PUJCQktMTFZWVltcXF1hYGNjY2doaGpqanNzc3d5eHp6eoODg4uLi5eXl5mamqOjo62tra+wr7S0tLe5uLu7u7/AwMPEw83NzdbX1tfa2dra2uTk5Ovr6+/w7/T09Pj39/f4+P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkAADEALAAAAAAgACAAAAb/QJhwOGyZOpIGQ6FgNCQcU4tIrcJaIwlgy+1uJaOplZqydBOSzGaTkSS6lNN4ONoOAJRQajV0rVAgFF0jcyEAbw9hc1cjD4cAIVZ1DAAXKotEKxkAlIREJ48bYphFGwAKAHJCLWaVo6RFF1sWYnUDDpewVSoOd4QtWgCeMCmXLaqfUyopdF9GWxRiKQAVKh3CRHUdKhQEzFeCAEdbH6uOh28A3ypbCQhbEGIfWx2CCd8wJhB2CpFDIQvuAIBgYkiKN0kASOAzRJYjBwyFrGgAwNGFTFqUAMjwYogpA1woMFwRDgDIDUQ2LQGAcoiGLRr2QRgp8yUADURMMWFJRYMH3BglJOQSwq0EDA84c56ilOGVLisqKUaISKVFihIjRJRI4XTIiggAGggygKxICAoguSDI0/UEyAnXAJTLJMtLlwxUYcwD0MEEtIgtBKGi0OHDh3qn8IwKvEVKuGHXGAwI8apFCAOUOvxzBqNOAVzgthi1UgKasl7YrtS9MMXI6DEjpKieNWoaSA1dF7V4+QafkNKoLOlSIQsVCUkmATgYwWIRCxEOAByANKc0AAEAJnzYI6bFihQfBAUQjSlF3S0GIqjZgCFC2i0XfM/BUtJuSEVPjdRTwsQJYdljBAEAOw==&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">title</span>&gt;404 您访问的页面搞丢了&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#34;script&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;//volunteer.cdn-go.cn/404/latest/404.js&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">crossorigin</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;anonymous&#34;</span>
</span></span><span style="display:flex;"><span>document.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#34;head&#34;</span>)[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">appendChild</span>(<span style="color:#a6e22e">s</span>);
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- */ //--&gt;</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>个人理财工具-Firefly Iii安装</title>
      <link>https://blog.zsan.cf/posts/firefly-iii-install/</link>
      <pubDate>Sun, 28 May 2023 18:09:34 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/firefly-iii-install/</guid>
      <description>⚠️：你必须准备
域名：国内可能需要备案
服务器：Linux
‼️‼️‼️新买的服务器一定要做一些安全的防护具体可参考 保护您的服务器 日期: 2023-06-04 &amp;nbsp; 标签: #安全&amp;nbsp; #服务器&amp;nbsp; 执行系统更新 经常更新您的系统是您可以对任何操作系统采取的最大的安全预防措施。软件更新的范围从关键漏洞补丁到小错误修复，许多软件漏洞在公开时实际上已经被修补。更新还为您提供了可用于您的分发的最新软件版本。 Ubuntu、Debian 和 Kali Linux apt update &amp;amp;amp;&amp;amp;amp; apt upgrade CentOS/RHEL Stream 和 Fedora 包括 CentOS Stream 8（及更高版本）、CentOS 8、其他 RHEL 衍生产品（包括 AlmaLinux 8 和 Rocky Linux 8）和 Fedora dnf upgrade 设置时区 默认情况下，所有新的计算实例都设置为 UTC 时间。但是，您可能更喜欢使用您居住的时区，因此日志文件时间戳是相对于您当地时间的。 大多数发行版 包括 CentOS Stream 8（及更新版本）、CentOS 7（及更新版本）、其他 RHEL 衍生产品（包括 AlmaLinux 8 和 Rocky Linux 8）、Fedora 和 Arch。这些说明也适用于大多数 Ubuntu、Debian 和 openSUSE 发行版，但在这些情况下可能首选其他方法。 使用 timedatectl 输出可用时区列表 timedatectl list-timezones 使用箭头键、 Page Up 和 Page Down 浏览列表。复制或记下您想要的时区，然后按 q 退出列表。 使用以下命令设置时区，将 America/New_York 替换为您喜欢的时区。 timedatectl set-timezone &amp;amp;#39;America/New_York&amp;amp;#39; Ubuntu, Debian 和 Kali Linux Ubuntu 和 Debian 都带有一个更友好的工具，称为 tzdata 打开 tzdata 工具 dpkg-reconfigure tzdata 使用箭头键选择您选择的大陆，然后按 Enter 使用箭头键选择您所在的地区，然后按 Enter 检查时间 使用 date 命令根据您的服务器查看当前日期和时间 root@localhost:~# date Thu Feb 16 12:17:52 EST 2018 配置自定义主机名 主机名用于使用易于记忆的名称来标识您的计算实例。它可以是描述性的和结构化的（详细说明系统的用途）或通用词或短语。 简单点就是默认有 locahost变为你设置的新的web-app名字，还可用作系统的 FQDN（完全限定域名）的一部分。 大多数发行版 将 example-hostname 替换为您的选择之一 hostnamectl set-hostname example-hostname 更新系统的hosts文件 hosts 文件在 IP 地址和主机名或域之间创建静态关联，系统优先考虑在 DNS 之前进行名称解析 在文本编辑器（例如 Nano）中打开 hosts 文件 nano /etc/hosts 为您的计算实例的公共 IP 地址添加一行。您可以将此地址与实例的完全限定域名 (FQDN) 相关联（如果有的话），并与您在上述步骤中设置的本地主机名相关联。在下面的示例中， 203.0.113.10 是公共 IP 地址， example-hostname 是本地主机名， example-hostname.</description>
      <content:encoded><![CDATA[<blockquote>
<p>⚠️：你必须准备</p>
<p>域名：国内可能需要备案</p>
<p>服务器：Linux</p>
<p>‼️‼️‼️新买的服务器一定要做一些安全的防护具体可参考<div style="height: 200px;margin: 1em auto;position: relative;
        box-shadow: 0 2px 4px rgb(0 0 0 / 25%), 0 0 2px rgb(0 0 0 / 25%);
        border-radius: 15px;padding: 23px;max-width: 780px;background: var(--entry);">
    
    
    <div style="font-size: 22px; font-weight: 600">
        <a target="_blank" href="https://blog.zsan.cf/posts/set-up-and-secure/" style="box-shadow: none">保护您的服务器</a>
    </div>
    <span style="font-size: 14px; color: #999">
        日期: 2023-06-04
        &nbsp;
        标签:
        
            #安全&nbsp;
        
            #服务器&nbsp;
        
    </span>
    <div style="font-size: 14px; line-height: 1.825;max-height: 75px; overflow: hidden;margin-top: 5px;">
        执行系统更新 经常更新您的系统是您可以对任何操作系统采取的最大的安全预防措施。软件更新的范围从关键漏洞补丁到小错误修复，许多软件漏洞在公开时实际上已经被修补。更新还为您提供了可用于您的分发的最新软件版本。
Ubuntu、Debian 和 Kali Linux apt update &amp;amp;&amp;amp; apt upgrade CentOS/RHEL Stream 和 Fedora 包括 CentOS Stream 8（及更高版本）、CentOS 8、其他 RHEL 衍生产品（包括 AlmaLinux 8 和 Rocky Linux 8）和 Fedora
dnf upgrade 设置时区 默认情况下，所有新的计算实例都设置为 UTC 时间。但是，您可能更喜欢使用您居住的时区，因此日志文件时间戳是相对于您当地时间的。
大多数发行版 包括 CentOS Stream 8（及更新版本）、CentOS 7（及更新版本）、其他 RHEL 衍生产品（包括 AlmaLinux 8 和 Rocky Linux 8）、Fedora 和 Arch。这些说明也适用于大多数 Ubuntu、Debian 和 openSUSE 发行版，但在这些情况下可能首选其他方法。
使用 timedatectl 输出可用时区列表
timedatectl list-timezones 使用箭头键、 Page Up 和 Page Down 浏览列表。复制或记下您想要的时区，然后按 q 退出列表。
使用以下命令设置时区，将 America/New_York 替换为您喜欢的时区。
timedatectl set-timezone &amp;#39;America/New_York&amp;#39; Ubuntu, Debian 和 Kali Linux Ubuntu 和 Debian 都带有一个更友好的工具，称为 tzdata
打开 tzdata 工具
dpkg-reconfigure tzdata 使用箭头键选择您选择的大陆，然后按 Enter
使用箭头键选择您所在的地区，然后按 Enter
检查时间 使用 date 命令根据您的服务器查看当前日期和时间
root@localhost:~# date Thu Feb 16 12:17:52 EST 2018 配置自定义主机名 主机名用于使用易于记忆的名称来标识您的计算实例。它可以是描述性的和结构化的（详细说明系统的用途）或通用词或短语。
简单点就是默认有 locahost变为你设置的新的web-app名字，还可用作系统的 FQDN（完全限定域名）的一部分。
大多数发行版 将 example-hostname 替换为您的选择之一
hostnamectl set-hostname example-hostname 更新系统的hosts文件 hosts 文件在 IP 地址和主机名或域之间创建静态关联，系统优先考虑在 DNS 之前进行名称解析
在文本编辑器（例如 Nano）中打开 hosts 文件
nano /etc/hosts 为您的计算实例的公共 IP 地址添加一行。您可以将此地址与实例的完全限定域名 (FQDN) 相关联（如果有的话），并与您在上述步骤中设置的本地主机名相关联。在下面的示例中， 203.0.113.10 是公共 IP 地址， example-hostname 是本地主机名， example-hostname.example.com 是 FQDN
127.0.0.1 localhost.localdomain localhost 203.0.113.10 example-hostname.example.com example-hostname 为您的计算实例的 IPv6 地址添加一行。如果没有此条目，需要 IPv6 的应用程序将无法运行 ......
    </div>
    
    
</div></p>
</blockquote>
<h2 id="省流版">省流版</h2>
<h3 id="docker一把过">docker一把过</h3>
<p>1、首先新建文件夹，比如<code>fireflyiii</code></p>
<p><code>cd fireflyiii</code>，创建<code>docker-compose.yml</code></p>
<p>拷贝下面,把<code>{{}}</code>内的改为自己的，不要<code>{{}}</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.3&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx-proxy</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginxproxy/nginx-proxy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nginx-proxy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;80:80&#34;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;443:443&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/var/run/docker.sock:/tmp/docker.sock:ro</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./certs:/etc/nginx/certs:ro</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./vhost:/etc/nginx/vhost.d</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./html:/usr/share/nginx/html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx-proxy-acme</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginxproxy/acme-companion</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nginx-proxy-acme</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/var/run/docker.sock:/var/run/docker.sock:ro</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./acme:/etc/acme.sh</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./certs:/etc/nginx/certs</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./vhost:/etc/nginx/vhost.d</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./html:/usr/share/nginx/html</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 警告接收email地址</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">DEFAULT_EMAIL={{acme@fireflyiii.com}}</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">NGINX_PROXY_CONTAINER=nginx-proxy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">nginx-proxy</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">app</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">fireflyiii/core:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">firefly_app</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./firefly_iii_upload:/var/www/html/storage/upload</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">env_file</span>: <span style="color:#ae81ff">.env</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">db</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;8080&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 这里要改为自己的域名</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">VIRTUAL_HOST={{fireflyiii.com}}</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">VIRTUAL_PORT=8080</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">LETSENCRYPT_HOST={{fireflyiii.com}}</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">LETSENCRYPT_EMAIL={{acme@fireflyiii.com}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">db</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># docker 20.10.10 以上使用最新</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mariadb:latest </span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># image: mariadb:10.7.8-focal</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">firefly_db</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hostname</span>: <span style="color:#ae81ff">fireflyiiidb</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 和下面.env 配置文件内一致</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">MYSQL_RANDOM_ROOT_PASSWORD=yes</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">MYSQL_USER=firefly</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">MYSQL_PASSWORD={{.env内的}}</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">MYSQL_DATABASE=firefly</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./firefly_iii_db:/var/lib/mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">cron</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">alpine</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">firefly_cron</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 使用登录之后的选项--命令行令牌的</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: <span style="color:#ae81ff">sh -c &#34;echo \&#34;0 3 * * * wget -qO- http://app:8080/api/v1/cron/{{登录之后的选项--命令行令牌获取}}\&#34; | crontab - &amp;&amp; crond -f -L /dev/stdout&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">redis</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">redis:6.0.9</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">redis</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>: 
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./redis/data:/data</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./redis/logs:/var/log/redis</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./redis/conf/redis.conf:/etc/redis/redis.conf</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/etc/localtime:/etc/localtime:ro</span> <span style="color:#75715e"># 设置容器时区与宿主机保持一致</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">TZ=Asia/Shanghai</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">LANG=en_US.UTF-8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">redis-server /etc/redis/redis.conf</span> <span style="color:#75715e"># 启动redis命令</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">firefly_iii_upload</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">firefly_iii_db</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">certs</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">vhost</span>:
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">html</span>:
</span></span></code></pre></div><p>2、修改配置文件</p>
<h4 id="fireflyiii配置文件">fireflyiii配置文件</h4>
<p>下载<code>wget https://raw.githubusercontent.com/firefly-iii/firefly-iii/v6.0.11/.env.example</code></p>
<p><code>cp .env.example .env</code></p>
<p>根据自己需要自行修改即可，简单说下配置redis</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># If you&#39;re looking for performance improvements, you could install memcached or redis
</span></span><span style="display:flex;"><span>CACHE_DRIVER=redis
</span></span><span style="display:flex;"><span>SESSION_DRIVER=redis
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># If you set either of the options above to &#39;redis&#39;, you might want to update these settings too
</span></span><span style="display:flex;"><span># If you use Docker or similar, you can set REDIS_HOST_FILE, REDIS_PASSWORD_FILE or
</span></span><span style="display:flex;"><span># REDIS_PORT_FILE to set the value from a file instead of from an environment variable
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># can be tcp, unix or http
</span></span><span style="display:flex;"><span>REDIS_SCHEME=tcp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># use only when using &#39;unix&#39; for REDIS_SCHEME. Leave empty otherwise.
</span></span><span style="display:flex;"><span>REDIS_PATH=
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># use only when using &#39;tcp&#39; or &#39;http&#39; for REDIS_SCHEME. Leave empty otherwise.
</span></span><span style="display:flex;"><span>REDIS_HOST=redis
</span></span><span style="display:flex;"><span>REDIS_PORT=6379
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Use only with Redis 6+ with proper ACL set. Leave empty otherwise.
</span></span><span style="display:flex;"><span>REDIS_USERNAME=
</span></span><span style="display:flex;"><span>REDIS_PASSWORD=
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># always use quotes and make sure redis db &#34;0&#34; and &#34;1&#34; exists. Otherwise change accordingly.
</span></span><span style="display:flex;"><span>REDIS_DB=&#34;0&#34;
</span></span><span style="display:flex;"><span>REDIS_CACHE_DB=&#34;1&#34;
</span></span></code></pre></div><h4 id="redis-配置文件">redis 配置文件</h4>
<p>下载<code>wget https://raw.githubusercontent.com/redis/redis/unstable/redis.conf</code></p>
<p>根据自己需要自行修改即可</p>
<p>最后<code>docker-compose up -d</code>启动</p>
<p><code>docker-compose logs -f --tail=500</code> 查看日志</p>
<p>现在fireflyiii已成功启动了，你可能会遇到很多错误，养成看日志的习惯，接下来就是使用了，不难😎
<div style="height: 200px;margin: 1em auto;position: relative;
        box-shadow: 0 2px 4px rgb(0 0 0 / 25%), 0 0 2px rgb(0 0 0 / 25%);
        border-radius: 15px;padding: 23px;max-width: 780px;background: var(--entry);">
    
    
    <div style="font-size: 22px; font-weight: 600">
        <a target="_blank" href="https://blog.zsan.cf/posts/personalfinance/" style="box-shadow: none">Firefly Iii使用</a>
    </div>
    <span style="font-size: 14px; color: #999">
        日期: 2023-05-28
        &nbsp;
        标签:
        
            #理财&nbsp;
        
            #预算&nbsp;
        
            #存钱&nbsp;
        
            #买车&nbsp;
        
            #生活&nbsp;
        
    </span>
    <div style="font-size: 14px; line-height: 1.825;max-height: 75px; overflow: hidden;margin-top: 5px;">
        为何要用Firefly Iii 简介及特点
Login to Firefly III Demo
安全
账本的安全，不言而喻了，它是自托管和隔离的，意味着数据完全掌握在自己手里
复式记账
预算、存钱
自动化，可以自动化设置一些操作
各端体验 PC端：web页面访问，适合PC浏览器上查看，特别是报表，很适合大屏观看
移动端：没有单独的App，但是支持PWA，推荐用chrome打开，然后添加到桌面就行了，和App无异
说点题外的，当年PWA出来的时候Safari是支持的，后来支持的功能就少了，是因为自己的App Store出来了。但是最近貌似对PWA的支持友好了😂
不扯太远了，总之只要支持PWA，基本上和App无异，对App有执念的，可以做个客户端，官方API都是开放的
登录 在firefly配置文件env内搜索SITE_OWNER
这个值就是配置的管理员邮箱
建议使用和域名相同的邮箱登录，如果无配置邮箱服务，可以使用阿里的邮箱推送服务，目前有免费额度可以用
安全设置 两步验证 打开firefly点击选项 个人档案 两步验证点击启用
手机下载Google Authenticator，切记不要登录Google账号，会上传到云上去
启用之后，重新登录
选项设置 货币 默认是欧元，可切换到人民币Chinese yuan (RMB) (¥)，如果有其他货币也可自行切换
管理 包括检查更新，邮箱测试等
初始化设置 账户 分类 标签 高级设置 预算👍 制定预算将帮助您更有效地分配资金并更轻松地实现财务目标
预算这个功能超级好用
首先，点击左侧预算，创建新预算
右侧选填字段内
自动预算 选择最后一个Adjusted (&amp;quot;... and correct for overspending&amp;quot;)
举🌰
每个月预算都是5000
1月预算5000，到月底花了8000，超预算3000
2月预算就变为2000，到月底花了1000
3月预算就变为6000
这个功能一直在找，是因为某财经大佬曾说过
然后，当你点开“本月支出建议”表格时，
“根据您过去十二个月的支出以及理财目标、收入情况综合分析，建议您本月食物支出不要超过元，休闲娱乐支出不要超过元……祝您早日达成理财目标。”
下个月：
“您上个月非常节俭，比预计多剩余了2000元。不妨拿出500元买点喜欢的东西奖励自己！”
当然自己开发一个这个软件耗时耗力，所以当时就在找类似开源软件，扯的有点远了😂😂😄
预算如何分配？ 50/30/20 预算法则
50/30/20 预算法则是一种简单的预算策略，可以帮助您优先考虑财务目标：
50% 用于必需品：将收入的 50% 用于支付基本生活费用，如住房、水电费、日常食品购买和交通费。
30% 用于愿望：将收入的 30% 用于自由支配花费和非必需开销，如外出就餐、娱乐、爱好和购物。
20% 用于储蓄和债务偿还：将收入的 20% 用于储蓄、投资和偿还债务。
这个体系的目的是确保您的基本需求得到满足，有一定的自由支配费用空间，并优先为未来储蓄和管理债务。
这些百分比并非一成不变。如果资金紧张，您可能需要将收入的更高比例用于支付必需品。如果您的债务很大，您可以选择分配超过 20% 的收入用于债务偿还，以加快进度。同样，如果您的储蓄目标雄心勃勃，可以将更高的比例分配给储蓄。
购买汽车的预算 一条经验法则是，您车辆的总价值不应超过您年收入的50%
另一个好的经验法则是 20/4/10 规则：
至少支付 20% 的首付款。
永远不要获得超过 4 年的贷款。
您总收入的 10% 或更少用于所有车辆支出，包括贷款支付、保险、汽油、登记费、维护和修理。
另外一个法则：
年收入买车
月收入买表
如果您的预算符合以下任一情况，您应该考虑改变您的生活方式：
您每月的抵押贷款/租金超过您实得工资的 30%。你可能想考虑找个室友，或者搬到更便宜的地方。
您每月在车辆上的总支出超过您实得工资的 15%。您可能需要考虑拼车上班、减少出行次数，或者乘坐公共汽车或自行车。如果可以的话，您可能还想考虑搬到更近的地方或卖掉您的汽车。每月预算的 10% 是一个更健康的汽车支出数字。
本杰明·富兰克林曾说：“省下一分钱就等于赚了一分钱。”如果这句话是真的，那么削减预算就相当于提高了你的收入。
常被提及的减少开支的方法有：削减有线电视、将手机套餐调整到实际使用的通话/数据量、在家烹饪/带食物去工作、重新评估贷款、扔掉优惠券、下单前先找找优惠券、取消在线购物网站的信用卡关联、减少信用卡使用并改用现金、不用时关闭灯光、不在家或睡觉时降低暖气/空调等。
账单 存钱罐👍 这个功能有助于帮助您实现您的财务目标
应急资金（fuck money） 对大多数人来说，3 到 6 个月的开支就足够了。如果您的收入不稳定或不确定，可能需要更大的应急基金（例如 9 到 12 个月）
一般放银行存款或货币基金内r1r2即可
超长期养老 以后养老要靠自己了，每月拿出收入的10%或20%放到长期账户内，为以后退休做准备
自动化 参考 Managing your finances - Firefly III documentation
budgeting
commontopics
commontopics
emergencyfunds
early_career
organizing ......
    </div>
    
    
</div>
浏览器输入域名访问即可，英文不好，点击<code>选项-偏好设定</code>修改语言为中文</p>
<h2 id="详细版">详细版</h2>
<p>空了再写吧！🤣</p>
<h2 id="备份">备份</h2>
<p>财务数据特别重要，所以一定要备份</p>
<h3 id="下载sh">下载sh</h3>
<p><a href="https://gist.github.com/dawid-czarnecki/8fa3420531f88b2b2631250854e23381#file-firefly-iii-backuper-sh">Script to backup Firefly III database, uploads and config files installed with docker-compose · GitHub</a></p>
<!-- <!DOCTYPE HTML>
<html lang="en">

<head>
    <style type="text/css">
        .github {
            border: 1px solid var(--color-contrast-low);
            border-radius: 3px;
            margin: 0 auto;
            margin-bottom: 1em;
            padding: 1em;
        }

        .github .github-icon {
            width: 1.2em;
            height: 1.2em;
            margin-right: 0.5em;
            margin-bottom: 0.2em;
            fill: var(--color-contrast-high);
            transition: all 0.5s;
        }

        .github .name {
            font-weight: bold;
            color: var(--color-primary);
            text-decoration: none;
        }

        .github .description {
            margin-top: 0.5em;
            margin-bottom: 1em;
            color: var(--color-contrast-high);
            text-align: justify;
            font-size: 90%;
            transition: all 0.5s;
        }

        .github .language-color {
            position: relative;
            top: 1px;
            display: inline-block;
            width: 0.75em;
            height: 0.75em;
            border-radius: 50%;
        }

        .github .language-name {
            color: var(--color-contrast-high);
            font-size: 90%;
            margin-left: 0.5em;
            transition: all 0.5s;
        }
    </style>
    <title></title>
</head>

<body>
    <div class="github">
        <div class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 2.5C2 1.83696 2.26339 1.20107 2.73223 0.732233C3.20108 0.263392 3.83696 0 4.5 0L13.25 0C13.4489 0 13.6397 0.0790176 13.7803 0.21967C13.921 0.360322 14 0.551088 14 0.75V13.25C14 13.4489 13.921 13.6397 13.7803 13.7803C13.6397 13.921 13.4489 14 13.25 14H10.75C10.5511 14 10.3603 13.921 10.2197 13.7803C10.079 13.6397 10 13.4489 10 13.25C10 13.0511 10.079 12.8603 10.2197 12.7197C10.3603 12.579 10.5511 12.5 10.75 12.5H12.5V10.5H4.5C4.30308 10.5 4.11056 10.5582 3.94657 10.6672C3.78257 10.7762 3.65442 10.9312 3.57816 11.1128C3.50191 11.2943 3.48096 11.4943 3.51793 11.6878C3.5549 11.8812 3.64816 12.0594 3.786 12.2C3.92524 12.3422 4.0023 12.5338 4.00024 12.7328C3.99818 12.9318 3.91716 13.1218 3.775 13.261C3.63285 13.4002 3.4412 13.4773 3.24222 13.4752C3.04325 13.4732 2.85324 13.3922 2.714 13.25C2.25571 12.7829 1.99929 12.1544 2 11.5V2.5ZM12.5 1.5V9H4.5C4.144 9 3.806 9.074 3.5 9.208V2.5C3.5 2.23478 3.60536 1.98043 3.79289 1.79289C3.98043 1.60536 4.23478 1.5 4.5 1.5H12.5ZM5 12.25V15.5C5 15.5464 5.01293 15.5919 5.03734 15.6314C5.06175 15.6709 5.09667 15.7028 5.1382 15.7236C5.17972 15.7444 5.22621 15.7532 5.27245 15.749C5.31869 15.7448 5.36286 15.7279 5.4 15.7L6.85 14.613C6.89328 14.5805 6.94591 14.563 7 14.563C7.05409 14.563 7.10673 14.5805 7.15 14.613L8.6 15.7C8.63714 15.7279 8.68131 15.7448 8.72755 15.749C8.77379 15.7532 8.82028 15.7444 8.8618 15.7236C8.90333 15.7028 8.93826 15.6709 8.96266 15.6314C8.98707 15.5919 9 15.5464 9 15.5V12.25C9 12.1837 8.97366 12.1201 8.92678 12.0732C8.87989 12.0263 8.81631 12 8.75 12H5.25C5.1837 12 5.12011 12.0263 5.07322 12.0732C5.02634 12.1201 5 12.1837 5 12.25Z"/></svg>

            
            <a class="name" href=https://gist.github.com/dawid-czarnecki/8fa3420531f88b2b2631250854e23381#file-firefly-iii-backuper-sh target="_blank">file-firefly-iii-backuper-sh</a>
        </div>
        <div class="description">Script to backup Firefly III database, uploads and config files installed with docker-compose · GitHub</div> 
        <div class="language">
            <span class="language-color" style="background-color: #e16737"></span>
            <span class="language-name">Shell</span>
        </div>
    </div>

    
    
    
</body>

</html>
 -->
<p>这个shell 根据命令执行即可备份</p>
<h3 id="添加为定时任务">添加为定时任务</h3>
<p>新建backup.sh</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#本地备份</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;开始备份&#34;</span>
</span></span><span style="display:flex;"><span>bash /path/to/fireflyiii/firefly-iii-backuper.sh backup /path/to/fireflyiii/backup/firefly-<span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%F&#39;</span><span style="color:#66d9ef">)</span>.tar
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;备份完成&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#备份到tg群里,不要删掉即可</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Define variables</span>
</span></span><span style="display:flex;"><span>token<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>chat_id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>message_thread_id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>file_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/path/to/fireflyiii/backup/firefly-</span><span style="color:#66d9ef">$(</span>date <span style="color:#e6db74">&#39;+%F&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">.tar&#34;</span>
</span></span><span style="display:flex;"><span>text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;备份成功&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Send file to telegram</span>
</span></span><span style="display:flex;"><span>curl -F chat_id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$chat_id<span style="color:#e6db74">&#34;</span> -F message_thread_id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$message_thread_id<span style="color:#e6db74">&#34;</span> -F document<span style="color:#f92672">=</span>@<span style="color:#e6db74">&#34;</span>$file_path<span style="color:#e6db74">&#34;</span> https://api.telegram.org/bot$token/sendDocument
</span></span></code></pre></div><p>添加到cron内</p>
<p><code>3 1 * * * bash /path/to/fireflyiii/backup.sh</code></p>
<h2 id="参考">参考</h2>
<blockquote>
<p><a href="https://docs.firefly-iii.org/firefly-iii/installation/docker/?mtm_campaign=docu-internal&amp;mtm_kwd=docker">Docker - Firefly III documentation</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>Firefly Iii使用</title>
      <link>https://blog.zsan.cf/posts/personalfinance/</link>
      <pubDate>Sun, 28 May 2023 17:55:20 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/personalfinance/</guid>
      <description>个人理财，好好生活</description>
      <content:encoded><![CDATA[<h2 id="为何要用firefly-iii">为何要用Firefly Iii</h2>
<p><a href="https://docs.firefly-iii.org/firefly-iii/about-firefly-iii/introduction/">简介及特点</a></p>
<p><a href="https://demo.firefly-iii.org/login">Login to Firefly III Demo</a></p>
<ul>
<li>
<p>安全</p>
<p>账本的安全，不言而喻了，它是自托管和隔离的，意味着数据完全掌握在自己手里</p>
</li>
<li>
<p>复式记账</p>
</li>
<li>
<p>预算、存钱</p>
</li>
<li>
<p>自动化，可以自动化设置一些操作</p>
</li>
</ul>
<h2 id="各端体验">各端体验</h2>
<p>PC端：web页面访问，适合PC浏览器上查看，特别是报表，很适合大屏观看</p>
<p>移动端：没有单独的App，但是支持PWA，推荐用chrome打开，然后添加到桌面就行了，和App无异</p>
<blockquote>
<p>说点题外的，当年PWA出来的时候Safari是支持的，后来支持的功能就少了，是因为自己的App Store出来了。但是最近貌似对PWA的支持友好了😂</p>
<p>不扯太远了，总之只要支持PWA，基本上和App无异，对App有执念的，可以做个客户端，官方API都是开放的</p>
</blockquote>
<h2 id="登录">登录</h2>
<p>在<code>firefly</code>配置文件<code>env</code>内搜索<code>SITE_OWNER</code></p>
<p>这个值就是配置的管理员邮箱</p>
<p>建议使用和域名相同的邮箱登录，如果无配置邮箱服务，可以使用阿里的邮箱推送服务，目前有免费额度可以用</p>
<h2 id="安全设置">安全设置</h2>
<h3 id="两步验证">两步验证</h3>
<p>打开<code>firefly</code>点击<code>选项</code> <code>个人档案</code> <code>两步验证</code>点击<code>启用</code></p>
<p>手机下载<code>Google Authenticator</code>，切记不要登录Google账号，会上传到云上去</p>
<p>启用之后，重新登录</p>
<h2 id="选项设置">选项设置</h2>
<h3 id="货币">货币</h3>
<p>默认是欧元，可切换到人民币<code>Chinese yuan (RMB) (¥)</code>，如果有其他货币也可自行切换</p>
<h3 id="管理">管理</h3>
<p>包括检查更新，邮箱测试等</p>
<h2 id="初始化设置">初始化设置</h2>
<h3 id="账户">账户</h3>
<h3 id="分类">分类</h3>
<h3 id="标签">标签</h3>
<h2 id="高级设置">高级设置</h2>
<h3 id="预算">预算👍</h3>
<p>制定预算将帮助您更有效地分配资金并更轻松地实现财务目标</p>
<p>预算这个功能超级好用</p>
<p>首先，点击左侧<code>预算</code>，创建新预算</p>
<p>右侧<code>选填字段</code>内</p>
<p><code>自动预算</code> 选择最后一个<code>Adjusted (&quot;... and correct for overspending&quot;)</code></p>
<p>举🌰</p>
<p>每个月预算都是5000</p>
<ul>
<li>
<p>1月预算5000，到月底花了8000，超预算3000</p>
</li>
<li>
<p>2月预算就变为2000，到月底花了1000</p>
</li>
<li>
<p>3月预算就变为6000</p>
</li>
</ul>
<p>这个功能一直在找，是因为某财经大佬曾说过</p>
<blockquote>
<p>然后，当你点开“本月支出建议”表格时，</p>
<p>“根据您过去十二个月的支出以及理财目标、收入情况综合分析，建议您本月食物支出不要超过<strong><strong>元，休闲娱乐支出不要超过</strong></strong>元……祝您早日达成理财目标。”</p>
<p>下个月：</p>
<p>“您上个月非常节俭，比预计多剩余了2000元。不妨拿出500元买点喜欢的东西奖励自己！”</p>
</blockquote>
<p>当然自己开发一个这个软件耗时耗力，所以当时就在找类似开源软件，扯的有点远了😂😂😄</p>
<h4 id="预算如何分配">预算如何分配？</h4>
<p><strong>50/30/20 预算法则</strong></p>
<p>50/30/20 预算法则是一种简单的预算策略，可以帮助您优先考虑财务目标：</p>
<blockquote>
<ul>
<li>
<p>50% 用于必需品：将收入的 50% 用于支付基本生活费用，如住房、水电费、日常食品购买和交通费。</p>
</li>
<li>
<p>30% 用于愿望：将收入的 30% 用于自由支配花费和非必需开销，如外出就餐、娱乐、爱好和购物。</p>
</li>
<li>
<p>20% 用于储蓄和债务偿还：将收入的 20% 用于储蓄、投资和偿还债务。</p>
</li>
</ul>
</blockquote>
<p>这个体系的目的是确保您的基本需求得到满足，有一定的自由支配费用空间，并优先为未来储蓄和管理债务。</p>
<p>这些百分比并非一成不变。如果资金紧张，您可能需要将收入的更高比例用于支付必需品。如果您的债务很大，您可以选择分配超过 20% 的收入用于债务偿还，以加快进度。同样，如果您的储蓄目标雄心勃勃，可以将更高的比例分配给储蓄。</p>
<h5 id="购买汽车的预算">购买汽车的预算</h5>
<p>一条经验法则是，您车辆的总价值不应超过您年收入的<code>50%</code></p>
<p>另一个好的经验法则是 20/4/10 规则：</p>
<blockquote>
<ul>
<li>
<p>至少支付 20% 的首付款。</p>
</li>
<li>
<p>永远不要获得超过 4 年的贷款。</p>
</li>
<li>
<p>您总收入的 10% 或更少用于所有车辆支出，包括贷款支付、保险、汽油、登记费、维护和修理。</p>
</li>
</ul>
</blockquote>
<p>另外一个法则：</p>
<blockquote>
<p>年收入买车</p>
<p>月收入买表</p>
</blockquote>
<p>如果您的预算符合以下任一情况，您应该考虑改变您的生活方式：</p>
<blockquote>
<ul>
<li>
<p>您每月的抵押贷款/租金超过您实得工资的 30%。你可能想考虑找个室友，或者搬到更便宜的地方。</p>
</li>
<li>
<p>您每月在车辆上的总支出超过您实得工资的 15%。您可能需要考虑拼车上班、减少出行次数，或者乘坐公共汽车或自行车。如果可以的话，您可能还想考虑搬到更近的地方或卖掉您的汽车。每月预算的 10% 是一个更健康的汽车支出数字。</p>
</li>
</ul>
</blockquote>
<p>本杰明·富兰克林曾说：“省下一分钱就等于赚了一分钱。”如果这句话是真的，那么削减预算就相当于提高了你的收入。</p>
<blockquote>
<p>常被提及的减少开支的方法有：削减有线电视、将手机套餐调整到实际使用的通话/数据量、在家烹饪/带食物去工作、重新评估贷款、扔掉优惠券、下单前先找找优惠券、取消在线购物网站的信用卡关联、减少信用卡使用并改用现金、不用时关闭灯光、不在家或睡觉时降低暖气/空调等。</p>
</blockquote>
<h3 id="账单">账单</h3>
<h3 id="存钱罐">存钱罐👍</h3>
<p>这个功能有助于帮助您实现您的财务目标</p>
<h4 id="应急资金fuck-money">应急资金（fuck money）</h4>
<p>对大多数人来说，3 到 6 个月的开支就足够了。如果您的收入不稳定或不确定，可能需要更大的应急基金（例如 9 到 12 个月）</p>
<blockquote>
<p>一般放银行存款或货币基金内r1r2即可</p>
</blockquote>
<h4 id="超长期养老">超长期养老</h4>
<p>以后养老要靠自己了，每月拿出收入的10%或20%放到长期账户内，为以后退休做准备</p>
<h3 id="自动化">自动化</h3>
<p> </p>
<h2 id="参考">参考</h2>
<blockquote>
<p><a href="https://docs.firefly-iii.org/firefly-iii/faq/financials/">Managing your finances - Firefly III documentation</a></p>
<p><a href="https://www.reddit.com/r/personalfinance/wiki/budgeting/">budgeting</a></p>
<p><a href="https://www.reddit.com/r/personalfinance/wiki/vehicles/">commontopics</a></p>
<p><a href="https://www.reddit.com/r/personalfinance/wiki/commontopics/">commontopics</a></p>
<p><a href="https://www.reddit.com/r/personalfinance/wiki/emergencyfunds/">emergencyfunds</a></p>
<p><a href="https://www.reddit.com/r/personalfinance/wiki/early_career/">early_career</a></p>
<p><a href="https://docs.firefly-iii.org/firefly-iii/financial-concepts/organizing/">organizing</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>PaperMod文章添加过时提醒</title>
      <link>https://blog.zsan.cf/posts/add-outdated-info-warning/</link>
      <pubDate>Sun, 26 Mar 2023 11:40:12 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/add-outdated-info-warning/</guid>
      <description>技术快速迭代并且方法不断改变，该博客通过魔改实现了针对该主题的内容提醒功能</description>
      <content:encoded><![CDATA[<p>技术性文章没有内容提醒怎么行的，技术快速迭代，今天可以的方法明天可能就不行了</p>
<p>网上搜了一圈，对应主题的没找到现成的，只能魔改了</p>
<p>只针对PaperMod主题的，其他自己魔改，大同小异</p>
<h2 id="1添加自定义模版">1、添加自定义模版</h2>
<p>Hugo根目录创建<code>layouts\partials\outdated_warning.html</code></p>
<p>复制下面代码到 <code>outdated_warning.html</code>内</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{- if or .Params.enableOutdatedInfoWarning (and .Site.Params.outdatedInfoWarning.enable (ne .Params.enableOutdatedInfoWarning false)) }}
</span></span><span style="display:flex;"><span>{{- $daysAgo := div (sub now.Unix $.Page.Params.Lastmod.Unix) 86400 }}
</span></span><span style="display:flex;"><span>{{- $hintThreshold := .Site.Params.outdatedInfoWarning.hint | default 30 }}
</span></span><span style="display:flex;"><span>{{- $warnThreshold := .Site.Params.outdatedInfoWarning.warn | default 180 }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- $updateTime := $.Page.Params.Lastmod }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- if gt $daysAgo $hintThreshold }}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-outdated&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  {{- if gt $daysAgo $warnThreshold }}
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;warn&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  {{- else }}
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hint&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  {{- end }}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span>&gt;{{ i18n &#34;outdatedInfoWarningBefore&#34; .}}
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;timeago&#34;</span> <span style="color:#a6e22e">datetime</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ dateFormat &#34;</span><span style="color:#a6e22e">2006-01-02T15:04:05</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">updateTime</span> <span style="color:#960050;background-color:#1e0010">}}&#34;</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ dateFormat &#34;</span><span style="color:#a6e22e">January</span> <span style="color:#a6e22e">2</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">2006</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#a6e22e">updateTime</span> <span style="color:#960050;background-color:#1e0010">}}&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      {{- dateFormat &#34;January 2, 2006&#34; $updateTime -}}
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">span</span>&gt;{{ i18n &#34;outdatedInfoWarningAfter&#34; .}}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>{{- end -}}
</span></span><span style="display:flex;"><span>{{- end -}}
</span></span></code></pre></div><h2 id="2添加到文章模版内">2、添加到文章模版内</h2>
<p>Hugo根目录创建<code>layouts/_default/single.html</code></p>
<p>在目录下方或者文章上方添加</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{ partial &#34;outdated_warning.html&#34; . }}
</span></span><span style="display:flex;"><span>{{- if .Content }}
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    {{- if not (.Param &#34;disableAnchoredHeadings&#34;) }}
</span></span><span style="display:flex;"><span>    {{- partial &#34;anchored_headings.html&#34; .Content -}}
</span></span><span style="display:flex;"><span>    {{- else }}{{ .Content }}{{ end }}
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  {{- end }}
</span></span></code></pre></div><h2 id="3添加内容提醒css">3、添加内容提醒css</h2>
<p>Hugo根目录创建<code>assets/css/extended/blank.css</code></p>
<p>添加下列代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span>.<span style="color:#a6e22e">post-outdated</span> .<span style="color:#a6e22e">hint</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">rem</span> <span style="color:#ae81ff">1.5</span><span style="color:#66d9ef">rem</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">background-color</span>:rgb(<span style="color:#ae81ff">239</span>, <span style="color:#ae81ff">245</span>, <span style="color:#ae81ff">255</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-left</span>: <span style="color:#ae81ff">0.5</span><span style="color:#66d9ef">rem</span> <span style="color:#66d9ef">solid</span> rgb(<span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">172</span>, <span style="color:#ae81ff">243</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#6b5900</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">align-self</span>: <span style="color:#66d9ef">stretch</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin-bottom</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">em</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">post-outdated</span> <span style="color:#f92672">p</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin</span>: <span style="color:#66d9ef">initial</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">post-outdated</span> .<span style="color:#a6e22e">warn</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">rem</span> <span style="color:#ae81ff">1.5</span><span style="color:#66d9ef">rem</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">background-color</span>: <span style="color:#ae81ff">#fff7d0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-left</span>: <span style="color:#ae81ff">0.5</span><span style="color:#66d9ef">rem</span> <span style="color:#66d9ef">solid</span> <span style="color:#ae81ff">#e7c000</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#6b5900</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">align-self</span>: <span style="color:#66d9ef">stretch</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin-bottom</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">em</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="4添加配置参数">4、添加配置参数</h2>
<p><code>config.yml</code>内添加下列参数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">params</span>:
</span></span><span style="display:flex;"><span><span style="color:#f92672">    outdatedInfoWarning</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">    enable</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">    hint</span>: <span style="color:#ae81ff">30</span>                <span style="color:#75715e"># 如果文章最后更新于这天数之前，显示提醒</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">    warn</span>: <span style="color:#ae81ff">180</span>    <span style="color:#75715e"># 如果文章最后更新于这天数之前，显示警告</span>
</span></span></code></pre></div><h2 id="5文章单独配置开关">5、文章单独配置开关</h2>
<p>文章开头增加<code>enableOutdatedInfoWarning: true #内容过时提醒</code></p>
<p>也可把上述代码添加到<code>archetypes/default.md</code></p>
<h2 id="6添加提示文字">6、添加提示文字</h2>
<p>Hugo根目录创建<code>i18n</code> 内复制主题下复制<code>zh.yaml</code>进来，添加下列代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>- <span style="color:#f92672">id</span>: <span style="color:#ae81ff">outdatedInfoWarningBefore</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">translation</span>: <span style="color:#e6db74">&#34;【注意】最后更新于 &#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">id</span>: <span style="color:#ae81ff">outdatedInfoWarningAfter</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">translation</span>: <span style="color:#e6db74">&#34;，文中内容可能已过时，请谨慎使用。&#34;</span>
</span></span></code></pre></div><blockquote>
<p>ps:借助ChatGPT的强大功能做了代码的编辑操作，未来已来🎉</p>
</blockquote>
<hr>
<p>参考：</p>
<blockquote>
<p><a href="https://guanqr.com/tech/website/add-expired-tip-in-meme/">在 MemE 主题文章开头添加过时提醒 | 荷戟独彷徨</a></p>
<p><a href="https://github.com/olOwOlo/hugo-theme-even/blob/master/layouts/partials/post/outdated-info-warning.html">hugo-theme</a></p>
<p><a href="https://chat.openai.com/">ChatGPT</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>搭建 MinIO 高性能对象存储</title>
      <link>https://blog.zsan.cf/posts/minio-service-deployment/</link>
      <pubDate>Tue, 14 Mar 2023 21:25:47 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/minio-service-deployment/</guid>
      <description>MinIO 是一个基于 Apache License v2.0 开源协议的对象存储服务。它兼容亚马逊 S3 云存储服务接口，非常适合于存储大容量非结构化的数据，例如图片、视频、日志文件、备份数据和容器/虚拟机镜像等，而一个对象文件可以是任意大小，从几 kb 到最大 5T 不等。
前段时间搭建播客的时候想找个存储文件的服务，无奈国内没免费的，国外延迟又高，就想起了自己搭建一个对象存储服务，然后就了解了MinIO，搭建很简单，直接docker部署
放一个中文的教程Minio - Docker — 从入门到实践，方便后面来翻阅
MinIO Object Storage for Container — MinIO Object Storage for Container</description>
      <content:encoded><![CDATA[<blockquote>
<p><strong>MinIO</strong> 是一个基于 Apache License v2.0 开源协议的对象存储服务。它兼容亚马逊 S3 云存储服务接口，非常适合于存储大容量非结构化的数据，例如图片、视频、日志文件、备份数据和容器/虚拟机镜像等，而一个对象文件可以是任意大小，从几 kb 到最大 5T 不等。</p>
</blockquote>
<p>前段时间搭建播客的时候想找个存储文件的服务，无奈国内没免费的，国外延迟又高，就想起了自己搭建一个对象存储服务，然后就了解了<strong>MinIO</strong>，搭建很简单，直接docker部署</p>
<p>放一个中文的教程<a href="https://yeasy.gitbook.io/docker_practice/appendix/repo/minio">Minio - Docker — 从入门到实践</a>，方便后面来翻阅</p>
<p><a href="https://min.io/docs/minio/container/index.html">MinIO Object Storage for Container — MinIO Object Storage for Container</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>搭建服务器监控服务-哪吒探针</title>
      <link>https://blog.zsan.cf/posts/setting-up-server-monitoring-service-nezha-probe/</link>
      <pubDate>Tue, 14 Mar 2023 21:20:29 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/setting-up-server-monitoring-service-nezha-probe/</guid>
      <description>本来想写下当时部署时的坑的，刚才重新部署，发现文档特别完善，不像我当时（2年前）部署时的了，就简单记录下吧，详细可以看准备工作 | 哪吒监控
服务器安装管理面板 curl -L https://cdn.jsdelivr.net/gh/naiba/nezha@master/script/install.sh -o nezha.sh &amp;amp;&amp;amp; chmod +x nezha.sh &amp;amp;&amp;amp; sudo CN=true ./nezha.sh` 客户端安装Agent 绿色的 Linux/Windows 图标按钮，复制一键安装命令
PS：官网写的太详细了，我这篇也没必要写了，占个坑，算是知道相关服务</description>
      <content:encoded><![CDATA[<blockquote>
<p>本来想写下当时部署时的坑的，刚才重新部署，发现文档特别完善，不像我当时（2年前）部署时的了，就简单记录下吧，详细可以看<a href="https://nezha.wiki/guide/dashboard.html">准备工作 | 哪吒监控</a></p>
</blockquote>
<h2 id="服务器安装管理面板">服务器安装管理面板</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -L https://cdn.jsdelivr.net/gh/naiba/nezha@master/script/install.sh -o nezha.sh <span style="color:#f92672">&amp;&amp;</span> chmod +x nezha.sh <span style="color:#f92672">&amp;&amp;</span> sudo CN<span style="color:#f92672">=</span>true ./nezha.sh<span style="color:#e6db74">`</span>
</span></span></code></pre></div><h2 id="客户端安装agent">客户端安装Agent</h2>
<p>绿色的 Linux/Windows 图标按钮，复制一键安装命令</p>
<blockquote>
<p>PS：官网写的太详细了，我这篇也没必要写了，占个坑，算是知道相关服务</p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>搭建 frp 内网穿透服务</title>
      <link>https://blog.zsan.cf/posts/building-frp-intranet-penetration-service/</link>
      <pubDate>Tue, 14 Mar 2023 21:12:45 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/building-frp-intranet-penetration-service/</guid>
      <description>简单搭建frps 内网穿透服务</description>
      <content:encoded><![CDATA[<blockquote>
<p>必需：有公网IP的服务器一台</p>
</blockquote>
<h2 id="服务端部署">服务端部署</h2>
<p>在具有公网 IP 的机器上部署</p>
<p>采用<a href="https://github.com/MvsCode/frps-onekey">一键部署脚本安装</a></p>
<blockquote>
<p>作者的github被封了，来补一个gitee的</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget https://gitee.com/mvscode/frps-onekey/raw/master/install-frps.sh -O ./install-frps.sh
</span></span><span style="display:flex;"><span>chmod <span style="color:#ae81ff">700</span> ./install-frps.sh
</span></span><span style="display:flex;"><span>./install-frps.sh install
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget https://raw.githubusercontent.com/MvsCode/frps-onekey/master/install-frps.sh -O ./install-frps.sh
</span></span><span style="display:flex;"><span>chmod <span style="color:#ae81ff">700</span> ./install-frps.sh
</span></span><span style="display:flex;"><span>./install-frps.sh install
</span></span></code></pre></div><p>简单用法</p>
<p><code> Usage: /etc/init.d/frps {start|stop|restart|status|config|version}</code></p>
<h2 id="客户端部署">客户端部署</h2>
<p>下载<a href="https://github.com/fatedier/frp/releases">Releases · fatedier/frp · GitHub</a></p>
<p>解压缩下载的压缩包，将其中的 frpc 拷贝到内网服务所在的机器上</p>
<h2 id="配置">配置</h2>
<p>这里可以下载配置文件<a href="https://github.com/fatedier/frp/tree/dev/conf">frp/conf at dev · fatedier/frp · GitHub</a></p>
<h3 id="服务端配置">服务端配置</h3>
<p>下面是服务端的最全配置，一些配置都是可以不用配置的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#75715e"># [common] is integral section</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[common]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># A literal address or host name for IPv6 must be enclosed</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># in square brackets, as in &#34;[::1]:80&#34;, &#34;[ipv6-host]:http&#34; or &#34;[ipv6-host%zone]:80&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For single &#34;bind_addr&#34; field, no need square brackets, like &#34;bind_addr = ::&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0.0.0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># udp port to help make udp hole to penetrate nat</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">bind_udp_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7001</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># udp port used for kcp protocol, it can be same with &#39;bind_port&#39;.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if not set, kcp is disabled in frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">kcp_bind_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># udp port used for quic protocol.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if not set, quic is disabled in frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_bind_port = 7002</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic protocol options</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_keepalive_period = 10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_max_idle_timeout = 30</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># quic_max_incoming_streams = 100000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># specify which address proxy will listen for, default value is same with bind_addr</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># proxy_bind_addr = 127.0.0.1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if you want to support virtual host, you must set the http port for listening (optional)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Note: http port and https port can be same with bind_port</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vhost_http_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">80</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vhost_https_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">443</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># response header timeout(seconds) for vhost http server, default is 60s</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># vhost_http_timeout = 60</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcpmux_httpconnect_port specifies the port that the server listens for TCP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HTTP CONNECT requests. If the value is 0, the server will not multiplex TCP</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># requests on one single port. If it&#39;s not - it will listen on this value for</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># HTTP CONNECT requests. By default, this value is 0.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcpmux_httpconnect_port = 1337</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If tcpmux_passthrough is true, frps won&#39;t do any update on traffic.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcpmux_passthrough = false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># set dashboard_addr and dashboard_port to view dashboard of frps</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard_addr&#39;s default value is same with bind_addr</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard is available only if dashboard_port is set</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 管理面板</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0.0.0.0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard user and passwd for basic auth protect</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_user</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">admin</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_pwd</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">admin</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard TLS mode</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dashboard_tls_mode</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard_tls_cert_file = server.crt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard_tls_key_file = server.key</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># enable_prometheus will export prometheus metrics on {dashboard_addr}:{dashboard_port} in /metrics api.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">enable_prometheus</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># dashboard assets directory(only for debug mode)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># assets_dir = ./static</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># console or real logFile path like ./frps.log</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_file</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">./frps.log</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># trace, debug, info, warn, error</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_level</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">info</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log_max_days</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># disable log colors when log_file is console, default is false</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">disable_log_color</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># DetailedErrorsToClient defines whether to send the specific error (with debug info) to frpc. By default, this value is true.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">detailed_errors_to_client</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># authentication_method specifies what authentication method to use authenticate frpc with frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If &#34;token&#34; is specified - token will be read into login message.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If &#34;oidc&#34; is specified - OIDC (Open ID Connect) token will be issued using OIDC settings. By default, this value is &#34;token&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">authentication_method</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">token</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># authenticate_heartbeats specifies whether to include authentication token in heartbeats sent to frps. By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">authenticate_heartbeats</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># AuthenticateNewWorkConns specifies whether to include authentication token in new work connections sent to frps. By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">authenticate_new_work_conns</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># auth token</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">12345678</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_issuer specifies the issuer to verify OIDC tokens with.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is &#34;&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_issuer</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_audience specifies the audience OIDC tokens should contain when validated.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is &#34;&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_audience</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_skip_expiry_check specifies whether to skip checking if the OIDC token is expired.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_skip_expiry_check</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># oidc_skip_issuer_check specifies whether to skip checking if the OIDC token&#39;s issuer claim matches the issuer specified in OidcIssuer.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># By default, this value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">oidc_skip_issuer_check</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># heartbeat configure, it&#39;s not recommended to modify the default value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the default value of heartbeat_timeout is 90. Set negative value to disable it.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># heartbeat_timeout = 90</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># user_conn_timeout configure, it&#39;s not recommended to modify the default value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># the default value of user_conn_timeout is 10</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># user_conn_timeout = 10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># only allow frpc to bind ports you list, if you set nothing, there won&#39;t be any limit</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allow_ports</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">2000-3000,3001,3003,4000-50000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># pool_count in each proxy will change to max_pool_count if they exceed the maximum value</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_pool_count</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># max ports can be used for each client, default value is 0 means no limit</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_ports_per_client</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_only specifies whether to only accept TLS-encrypted connections. By default, the value is false.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tls_only</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_cert_file = server.crt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_key_file = server.key</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tls_trusted_ca_file = ca.crt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if subdomain_host is not empty, you can set subdomain when type is http or https in frpc&#39;s configure file</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># when subdomain is test, the host used by routing is test.frps.com</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">subdomain_host</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">frps.com</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># if tcp stream multiplexing is used, default is true</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_mux = true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># specify keep alive interval for tcp mux.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># only valid if tcp_mux is true.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_mux_keepalive_interval = 60</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_keepalive specifies the interval between keep-alive probes for an active network connection between frpc and frps.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If negative, keep-alive probes are disabled.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcp_keepalive = 7200</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># custom 404 page for HTTP requests</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># custom_404_page = /path/to/404.html</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># specify udp packet size, unit is byte. If not set, the default value is 1500.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This parameter should be same between client and server.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># It affects the udp and sudp proxy.</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">udp_packet_size</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Enable golang pprof handlers in dashboard listener.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Dashboard port must be set first</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pprof_enable</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[plugin.user-manager]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">127.0.0.1:9000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">path</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/handler</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ops</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">Login</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[plugin.port-manager]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">127.0.0.1:9001</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">path</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">/handler</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ops</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">NewProxy</span>
</span></span></code></pre></div><p>配置完成之后</p>
<p><code>/etc/init.d/frps start</code></p>
<p><code>公网IP:dashboard_port</code>访问管理面板</p>
<h3 id="客户端配置">客户端配置</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#66d9ef">[common]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server_addr</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">服务端公网IP #服务端bind_addr</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">7000 #服务端bind_port</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">token</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">服务端auth_token</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[服务名字]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 远程访问端口</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">remote_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8888</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">type</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">tcp</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_ip</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">192.168.1.9</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8888</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">[服务名字]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 远程访问端口</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">remote_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8889</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">type</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">tcp</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_ip</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">192.168.1.77</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local_port</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">8889</span>
</span></span></code></pre></div><p>启动</p>
<p><code>./frpc -c ./frpc.ini</code></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>NFC 复制模拟门禁卡</title>
      <link>https://blog.zsan.cf/posts/nfc-card-simulation-access-control/</link>
      <pubDate>Mon, 13 Mar 2023 13:35:25 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/nfc-card-simulation-access-control/</guid>
      <description>iOS手机用卡贴支持模拟门禁</description>
      <content:encoded><![CDATA[<blockquote>
<p>必备：NFC卡贴</p>
<p>android手机支持NFC</p>
</blockquote>
<h1 id="1买卡贴">1、买卡贴</h1>
<p>拼夕夕买CUID卡就行了，大多数可以用</p>
<h1 id="2克隆">2、克隆</h1>
<p>Android 下载 <a href="https://github.com/ikarus23/MifareClassicTool">Mifare Classic Tool</a></p>
<p>关键操作步骤：</p>
<p>1、读标签</p>
<p>选择<code>读标签</code>，然后把门卡贴在手机nfc位置，之后点<code>开始映射并读取标签</code>，就可以读取到了，至于key，可以全选或者选择一个试试就行了。</p>
<p>然后点击右上角菜单，选择<code>写转储</code>就可以到写入界面了。</p>
<p>2、写标签</p>
<p>在上一步中转到<code>写转储</code>界面，直接点击<code>写转储</code>，然后默认全选扇区就可以了，贴上买的nfc卡贴后，点击ok就可以了，不出意外的话就可以写成功了。</p>
<p>3、克隆uid（非必选）</p>
<p>通过上面的步骤，克隆的卡可以进入小区大门，但是对于楼栋的电梯门，是没办法刷的，对比了门禁卡和卡贴，发现卡贴的id和门禁卡不同的，因此我们再做一个克隆uid操作。</p>
<p>在首页<code>写标签</code>进入后，选择<code>克隆uid</code>，然后贴上我们的门禁卡，此时发现克隆的UID的id发生变化了，然后选择<code>计算0并克隆UID</code>，然后贴上卡贴，之后就可以啦。</p>
<p>可以拿着去门口试试了</p>
<blockquote>
<p>参考：</p>
<p><a href="https://yanke.info/?id=171">nfc卡贴模拟门禁卡</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>SillyGril&amp;QQbot一键部署</title>
      <link>https://blog.zsan.cf/posts/sillygril-qqbot-deploy/</link>
      <pubDate>Wed, 31 Aug 2022 14:03:46 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/sillygril-qqbot-deploy/</guid>
      <description>一、docker-compose 编排文件 创建docker-compose.yaml文件并拷贝下面内容
version: &amp;#34;3&amp;#34; services: go-cqhttp: image: mzzsfy/go-cqhttp:latest container_name: go-cqhttp volumes: - ./data:/data restart: always environment: # - token=$Yourtoken #替换为自己生成的token - ws_url=&amp;#39;ws://sillygirl:8080/qq/receive&amp;#39; - TZ=Asia/Shanghai networks: - sillygirl depends_on: - sillygirl sillygirl: image: mzzsfy/sillygirl:latest container_name: sillygirl volumes: - ./sillyGirl:/etc/sillyGirl restart: always environment: # - set__qq__token=$Yourtoken #替换为自己生成的token - TZ=Asia/Shanghai networks: - sillygirl networks: sillygirl: docker-compsoe up -d 启动
docker-compose logs -f 查看日志
二、FAQ 1、go-cqhttp 扫码失败 问题解决 云服务器导致 可以在本地服务器（与手机qq扫码在同一局域网内）启动服务，生成session.token 复制到云服务器相同目录下
看这里解决
2、go-cqhttp 建议修改为手表登录 首先运行一下，会生成device.json
找到protocol字段修改为2
你可能会用到的一些资料
https://hub.docker.com/r/mzzsfy/sillygirl
https://hub.docker.com/r/mzzsfy/go-cqhttp
go-cqhttp配置</description>
      <content:encoded><![CDATA[<h3 id="一docker-compose-编排文件">一、docker-compose 编排文件</h3>
<p>创建<code>docker-compose.yaml</code>文件并拷贝下面内容</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">go-cqhttp</span>:
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mzzsfy/go-cqhttp:latest</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">go-cqhttp</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">./data:/data</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#    - token=$Yourtoken #替换为自己生成的token</span>
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">ws_url=&#39;ws://sillygirl:8080/qq/receive&#39;</span>
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">TZ=Asia/Shanghai</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">networks</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">sillygirl</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">sillygirl</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">sillygirl</span>:
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mzzsfy/sillygirl:latest</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">sillygirl   </span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">./sillyGirl:/etc/sillyGirl</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#    - set__qq__token=$Yourtoken #替换为自己生成的token</span>
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">TZ=Asia/Shanghai</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">networks</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">sillygirl</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">networks</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">sillygirl</span>:
</span></span></code></pre></div><p><code>docker-compsoe up -d</code> 启动</p>
<p><code>docker-compose logs -f</code> 查看日志</p>
<h3 id="二faq">二、FAQ</h3>
<h4 id="1go-cqhttp-扫码失败-问题解决-云服务器导致">1、go-cqhttp 扫码失败 问题解决 云服务器导致</h4>
<p>可以在本地服务器（与手机qq扫码在同一局域网内）启动服务，生成session.token 复制到云服务器相同目录下</p>
<p><a href="https://github.com/Mrs4s/go-cqhttp/issues/1469">看这里解决</a></p>
<h4 id="2go-cqhttp-建议修改为手表登录">2、go-cqhttp 建议修改为手表登录</h4>
<p>首先运行一下，会生成<code>device.json</code></p>
<p>找到<code>protocol</code>字段修改为2</p>
<hr>
<blockquote>
<p>你可能会用到的一些资料</p>
<p><a href="https://hub.docker.com/r/mzzsfy/sillygirl">https://hub.docker.com/r/mzzsfy/sillygirl</a></p>
<p><a href="https://hub.docker.com/r/mzzsfy/go-cqhttp">https://hub.docker.com/r/mzzsfy/go-cqhttp</a></p>
<p><a href="https://docs.go-cqhttp.org/guide/config.html#%E8%AE%BE%E5%A4%87%E4%BF%A1%E6%81%AF">go-cqhttp配置</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>用PWA 改造WEB 为原生App</title>
      <link>https://blog.zsan.cf/posts/pwa-retrofitting/</link>
      <pubDate>Sun, 07 Aug 2022 16:28:27 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/pwa-retrofitting/</guid>
      <description>PWA使WEB网站更丝滑</description>
      <content:encoded><![CDATA[<blockquote>
<p>最近闲来无事，把网站升级了，更加像原生APP</p>
<p>记录下升级过程，免得以后忘了</p>
<p>PWA是什么？可以去网上搜一下，but中文文章少一点</p>
<p>用Google 封装的 好的 workbox 来升级</p>
</blockquote>
<h2 id="注册service-worker">注册Service Worker</h2>
<p>在html页面注册 SW</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;serviceWorker&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">navigator</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">navigator</span>.<span style="color:#a6e22e">serviceWorker</span>.<span style="color:#a6e22e">getRegistrations</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">regs</span> =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">reg</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">regs</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// 注销掉不是当前作用域的所有的 Service Worker
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                     <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">reg</span>.<span style="color:#a6e22e">scope</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#39;http://localhost:8000/&#39;</span>) {
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">reg</span>.<span style="color:#a6e22e">unregister</span>()
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// 注销掉污染 Service Worker 之后再重新注册自己作用域的 Service Worker
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;load&#39;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">navigator</span>.<span style="color:#a6e22e">serviceWorker</span>.<span style="color:#a6e22e">register</span>(<span style="color:#e6db74">&#39;./sw.js&#39;</span>).<span style="color:#a6e22e">then</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">e</span>) { <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;支持sw:&#34;</span>, <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">scope</span>) })
</span></span><span style="display:flex;"><span>                })
</span></span><span style="display:flex;"><span>            })
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><h2 id="生成swjs文件">生成SW.js文件</h2>
<h3 id="google-cdn">google cdn</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">importScripts</span>(<span style="color:#e6db74">&#34;  &#39;https://storage.googleapis.com/workbox-cdn/releases/6.1.1/workbox-sw.js&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;</span>);
</span></span></code></pre></div><p>国内建议不使用Google</p>
<h3 id="jsdelivr-cdn">jsdelivr cdn</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">importScripts</span>(<span style="color:#e6db74">&#34;https://fastly.jsdelivr.net/npm/workbox-sw@6.5.4/build/workbox-sw.min.js&#34;</span>);
</span></span></code></pre></div><h2 id="swjs-编写">SW.js 编写</h2>
<h3 id="配置相关">配置相关</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">setConfig</span>(
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 是否开启debug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">debug</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">cacheSuffixVersion</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;-220806&#39;</span>; <span style="color:#75715e">// 缓存版本号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">maxEntries</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>; <span style="color:#75715e">// 最大条目数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">setCacheNameDetails</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">prefix</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;zsan&#39;</span>, <span style="color:#75715e">// 前缀
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">suffix</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cacheSuffixVersion</span>, <span style="color:#75715e">// 后缀
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//检测是否安装成功
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">workbox</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Yay! Workbox is loaded 🎉&#34;</span>)
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Boo! Workbox didn&#39;t load 😬&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="预缓存文件">预缓存文件</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">cacheFiles</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">url</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;/index.html&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">revision</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cacheSuffixVersion</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">precaching</span>.<span style="color:#a6e22e">precacheAndRoute</span>(<span style="color:#a6e22e">cacheFiles</span>);
</span></span></code></pre></div><h2 id="workbox策略">workbox策略</h2>
<h3 id="cdn策略">cdn策略</h3>
<p>对于一些cdn的使用，使用CacheFirst 缓存优先策略，此策略将首先检查缓存中是否有响应，如果有响应，则使用该策略。如果请求不在缓存中，则将使用网络，并将任何有效响应添加到缓存中，然后再传递给浏览器。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">routing</span>.<span style="color:#a6e22e">registerRoute</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#39;^https://fastly\\.jsdelivr\\.net&#39;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">strategies</span>.<span style="color:#a6e22e">CacheFirst</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cacheName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;static-immutable&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">cacheSuffixVersion</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fetchOptions</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">mode</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;cors&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;omit&#39;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">plugins</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">expiration</span>.<span style="color:#a6e22e">ExpirationPlugin</span>({
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">maxAgeSeconds</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">purgeOnQuotaError</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>            }),
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><h3 id="字体文件">字体文件</h3>
<p>对于字体文件，基本上确定好就不会改动了，这里使用StaleWhileRevalidate，此策略将对网络请求使用缓存来响应（如果有），并在后台更新缓存。如果未缓存，它将等待网络响应并使用它。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">routing</span>.<span style="color:#a6e22e">registerRoute</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 匹配 woff 字体
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#39;.*.woff&#39;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">strategies</span>.<span style="color:#a6e22e">StaleWhileRevalidate</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// cache storage 名称和版本号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">cacheName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;font-cache&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">cacheSuffixVersion</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">plugins</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 使用 expiration 插件实现缓存条目数目和时间控制
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">expiration</span>.<span style="color:#a6e22e">ExpirationPlugin</span>({
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// 最大保存项目
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">maxEntries</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// 缓存 30 天
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">maxAgeSeconds</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">60</span>,
</span></span><span style="display:flex;"><span>            }),
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 使用 cacheableResponse 插件缓存状态码为 0 的请求
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">cacheableResponse</span>.<span style="color:#a6e22e">CacheableResponsePlugin</span>({
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">statuses</span><span style="color:#f92672">:</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">200</span>],
</span></span><span style="display:flex;"><span>            }),
</span></span><span style="display:flex;"><span>        ],
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><h3 id="api资源">API资源</h3>
<p>API数据的请求使用NetworkFirst 策略，此策略将尝试首先从网络获得响应。如果收到响应，它将把它传递给浏览器，并将其保存到缓存中。如果网络请求失败，将使用最后一个缓存的响应。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">routing</span>.<span style="color:#a6e22e">registerRoute</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// 匹配 leancloudapi.xsbb.ml
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#39;^https://(?:blog\\.zsan\\.ml)&#39;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">strategies</span>.<span style="color:#a6e22e">NetworkFirst</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// cache storage 名称和版本号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">cacheName</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;blog-api-cache&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">cacheSuffixVersion</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fetchOptions</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">mode</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;cors&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;omit&#39;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">networkTimeoutSeconds</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><h3 id="google-analytics">Google-Analytics</h3>
<p>官方有<a href="https://developers.google.com/web/tools/workbox/guides/enable-offline-analytics">Google Analytics 离线统计插件</a>,但是英文的，相关资料也少，折腾了好一阵子</p>
<p>1、简单点，一句代码就行,注意用这个时候，head里的代码需要是官方获取的最新的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">googleAnalytics</span>.<span style="color:#a6e22e">initialize</span>()
</span></span></code></pre></div><p>2、带离线统计</p>
<p>需要去Google analytics 添加自定义指标和自定义维度</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">googleAnalytics</span>.<span style="color:#a6e22e">initialize</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">parameterOverrides</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cd1</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;offline&#39;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">hitFilter</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">params</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">queueTimeInSeconds</span> <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">round</span>(<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;qt&#39;</span>) <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#39;cm1&#39;</span>, <span style="color:#a6e22e">queueTimeInSeconds</span>);
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h3 id="其他后缀匹配">其他后缀匹配</h3>
<p>保证体验良好</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">routing</span>.<span style="color:#a6e22e">registerRoute</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#39;.*.(?:png|jpg|jpeg|svg|gif|webp|ico)&#39;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">strategies</span>.<span style="color:#a6e22e">StaleWhileRevalidate</span>()
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">routing</span>.<span style="color:#a6e22e">registerRoute</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">&#39;.*.(css|js)&#39;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">strategies</span>.<span style="color:#a6e22e">StaleWhileRevalidate</span>()
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 默认
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">routing</span>.<span style="color:#a6e22e">setDefaultHandler</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">workbox</span>.<span style="color:#a6e22e">strategies</span>.<span style="color:#a6e22e">NetworkFirst</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">networkTimeoutSeconds</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>改造完成，尽情享用🎉</p>
<h2 id="参考资料">参考资料</h2>
<blockquote>
<p><a href="https://blog.baoshuo.ren/post/workbox-service-worker/">初识 Service Worker —— 使用 Workbox 快速开发 Service Worker - 宝硕博客</a></p>
<p><a href="https://pwa.alienzhou.com/">PWA来了，你准备好了么？ - PWA学习手册</a></p>
<p><a href="https://lavas-project.github.io/pwa-book/">HOME · PWA 应用实战</a></p>
<p><a href="https://developer.chrome.com/docs/workbox/service-worker-overview/">Service worker overview - Chrome Developers</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>在Cloudflare 设置域名 301 重定向</title>
      <link>https://blog.zsan.cf/posts/cloudflare-301-set/</link>
      <pubDate>Sun, 31 Jul 2022 19:54:01 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/cloudflare-301-set/</guid>
      <description>在Cloudflare 设置域名 301 重定向 有点小坑</description>
      <content:encoded><![CDATA[<blockquote>
<p>很久以前遇到的问题了，用cloudflare 设置有大坑，今天来记录下</p>
<p>之前网站的域名需要更换，blog等域名也需要从旧域名到新域名</p>
</blockquote>
<p>旧域名：olddona.com</p>
<p>新域名：newdona.com</p>
<p>现在需要访问 olddona.com 时跳转到 newdona.com</p>
<p>1、clourflare 上 dns 解析 olddona.com</p>
<p>登录clourflare、点击 dns、点击添加一条a记录</p>
<blockquote>
<p>类型：A</p>
<p>名称：olddona.com</p>
<p>ipv4地址：8.8.8.8</p>
</blockquote>
<p>ps：ipv4 地址一定要填一个可用的，这是个坑</p>
<p>2、cloudflare 添加重定向</p>
<ol>
<li>
<p>点击规则</p>
</li>
<li>
<p>点击创建页面规则</p>
</li>
<li>
<blockquote>
<p>url: olddona.com/*</p>
<p>选取设置：转发URL、301永久</p>
<p>输入目标URL：https://newdona.com/$1</p>
</blockquote>
</li>
</ol>
<p>保存之后，去访问olddona.com 可以跳到 newdona.com 成功🎉</p>
<p>也可以试下olddona.com/* 是否成功跳转即可</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Mac Brew Tab 命令自动补全</title>
      <link>https://blog.zsan.cf/posts/mac-brew-tab/</link>
      <pubDate>Tue, 26 Jul 2022 22:17:56 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/mac-brew-tab/</guid>
      <description>Mac系统下brew 按tab命令 自动补全</description>
      <content:encoded><![CDATA[<blockquote>
<p>mac arm版 2021版的brew 一键安装后 命令 按tab 不能补全，今天有点闲，就搜了一下，给解决了</p>
<p>用的 Oh My Zsh，官方文档里写的很详细，不过是英文的，这里给翻译记录下</p>
</blockquote>
<p>1、在 ~/.zshrc 里添加下面code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> type brew &amp;&gt;/dev/null
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  FPATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>brew --prefix<span style="color:#66d9ef">)</span><span style="color:#e6db74">/share/zsh/site-functions:</span><span style="color:#e6db74">${</span>FPATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  autoload -Uz compinit
</span></span><span style="display:flex;"><span>  compinit
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>2、在 ~/.zprofile 里添加下面code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>FPATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>brew --prefix<span style="color:#66d9ef">)</span><span style="color:#e6db74">/share/zsh/site-functions:</span><span style="color:#e6db74">${</span>FPATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>3、强制重建<code>zcompdump</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>rm -f ~/.zcompdump; compinit
</span></span></code></pre></div><p>4、如果出现 zsh compinit: insecure directory 警告</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>chmod -R go-w <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>brew --prefix<span style="color:#66d9ef">)</span><span style="color:#e6db74">/share&#34;</span>
</span></span></code></pre></div><p>参考：</p>
<blockquote>
<p><a href="https://docs.brew.sh/Shell-Completion">Homebrew Shell Completion — Homebrew Documentation</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>低成本搭建高质量播客发布服务</title>
      <link>https://blog.zsan.cf/posts/how-to-make-podcast/</link>
      <pubDate>Tue, 12 Jul 2022 22:04:47 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/how-to-make-podcast/</guid>
      <description>用播客在iPhone上听那些自己喜欢的歌曲</description>
      <content:encoded><![CDATA[<blockquote>
<p>引言：最近用了iPhone手机，听Apple music的时候，有些喜欢的歌曲并没有，想下载到本地但由于iOS的生态封闭，操作太麻烦；</p>
<p>在寻找解决方案时发现用自建播客来实现下载音乐方案可行，于是就有了下面的教程</p>
</blockquote>
<h2 id="what">What</h2>
<p>播客（podcast）创作者将音频或视频上传至<a href="https://zh.wikipedia.org/wiki/RSS" title="RSS">RSS</a>或在线播客平台，听众或观众则通过<a href="https://zh.wikipedia.org/wiki/%E8%BB%9F%E4%BB%B6" title="软件">软件</a>获取节目更新。</p>
<h2 id="how">How</h2>
<p>制作过程不说了，来谈谈发布过程，很简单，一个支持RSS的网站发布音频信息供用户拉取，一个音频托管平台存放音频</p>
<ul>
<li>网站直接Hugo搭建，用zen主题支持podcast，放在GitHub page上，域名可以在freedom上注册，用cloudflare DNS解析和加速</li>
</ul>
<p>hugo 搭建播客</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#新建网站</span>
</span></span><span style="display:flex;"><span>hugo new site podcast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#安装 zen主题</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/frjo/hugo-theme-zen.git themes/zen
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#在content内新建podcast文件夹，此页面内新增音频</span>
</span></span><span style="display:flex;"><span>cd content
</span></span><span style="display:flex;"><span>mkdir podcast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#podcast的一些设置</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#设置的图片，需要现在根目录新建 assets/images 目录，取相对路径即可</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#podcast 音频下面显示链接，如何取消</span>
</span></span><span style="display:flex;"><span>vim layouts/partials/podcast.html
</span></span><span style="display:flex;"><span><span style="color:#75715e">#注释掉下面行</span>
</span></span><span style="display:flex;"><span>&lt;figcaption&gt;&lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ </span>$src<span style="color:#e6db74"> }}&#34;</span>&gt;<span style="color:#f92672">{{</span> .Title <span style="color:#f92672">}}</span>&lt;/a&gt;&lt;/figcaption&gt;
</span></span></code></pre></div><p>podcast 配置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e">#文章顶部新增参数</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">podcast</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mp3</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">duration</span>:
</span></span></code></pre></div><ul>
<li>音频托管平台自建minin服务存储音频</li>
</ul>
<p>minio服务很强大，感兴趣可以了解一下</p>
<p>docker 部署</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.3&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">minio</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">quay.io/minio/minio</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">minio1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">9090</span>:<span style="color:#ae81ff">9090</span>   <span style="color:#75715e">#控制台端口</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">9000</span>:<span style="color:#ae81ff">9000</span>   <span style="color:#75715e">#API端口</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#e6db74">&#39;./data:/data&#39;</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#e6db74">&#39;./config:/root/.minio&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">MINIO_ROOT_USER</span>: <span style="color:#ae81ff">admin    </span> <span style="color:#75715e">#管理用户名</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">MINIO_ROOT_PASSWORD</span>: <span style="color:#ae81ff">admin  </span> <span style="color:#75715e">#管理密码</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: <span style="color:#ae81ff">server /data --console-address &#39;:9090&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span></code></pre></div><p>部署成功，ip:9090访问登录</p>
<p>控制台操作</p>
<p>1、创建存储桶</p>
<p>create bucket</p>
<p>2、点击manage，Access Rules</p>
<p>add rule</p>
<div>
prefix：*.* </br>
access:readonly
</div>
<p>3、上传音频</p>
<p>4、分享文件，链接地址 复制出来，前面ip换成外部ip即可</p>
<p>把地址贴在上面podcast 参数 mp3 的地方</p>
<h2 id="enjoy">enjoy</h2>
<p>这样算下来，除了用了一台服务器外，其他全部费用为零，总费用百元不到</p>
<p>部署全部完成，点击RSS链接放到订阅的地方，尽情享用吧！🎉</p>
<blockquote>
<p>参考：</p>
<p><a href="https://themes.gohugo.io/themes/hugo-theme-zen/">Zen | Hugo Themes</a></p>
<p><a href="https://github.com/frjo/hugo-theme-zen">GitHub - frjo/hugo-theme-zen: A fast and clean Hugo base theme with css-grid and Hugo pipes support.</a></p>
<p><a href="https://liujiacai.net/blog/2022/01/08/how-to-make-podcast/#headline-7">如何零成本开始一档新播客 - Keep Coding</a></p>
<p><a href="https://help.apple.com/itc/podcasts_connect/#/">苹果博客指南</a></p>
<p><a href="https://github.com/minio/minio">GitHub - minio/minio: Multi-Cloud Object Storage</a></p>
<p><a href="https://docs.min.io/docs/minio-quickstart-guide.html">MinIO | The MinIO Quickstart Guide</a></p>
<p><a href="https://blog.foundme.top/archives/154">自建对象存储Minio - 博客小站</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>Autojs 笔记</title>
      <link>https://blog.zsan.cf/posts/autojs-notes/</link>
      <pubDate>Sun, 26 Jun 2022 15:08:44 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/autojs-notes/</guid>
      <description>用autojs在Android上写些小脚本吧！</description>
      <content:encoded><![CDATA[<blockquote>
<p>最近薅🦙接触了autojs，在Android手机上可自动化运行的脚本，不用root，可直接运行，轻量小巧，底层调用Android API，自己可封装API👍</p>
</blockquote>
<h2 id="安装">安装</h2>
<p>autojs原作者已不再维护，推出了autojs.pro版，有钱的大佬可以直接去安装下载，官方文档也很全</p>
<p>没钱的话，可以用autoxjs，从原有开源库接手过来的，开源免费</p>
<p><a href="https://github.com/kkevsekk1/AutoX">GitHub - kkevsekk1/AutoX: A UiAutomator on android, does not need root access(安卓平台上的JavaScript自动化工具)</a></p>
<h2 id="常用语法">常用语法</h2>
<h3 id="获取设备信息">获取设备信息</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// 打印运行环境信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">str</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">str</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;屏幕宽度:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">width</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\n屏幕高度:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">height</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\nbuildId:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">buildId</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\n主板:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">board</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\n制造商:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">brand</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\n型号:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">model</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\n产品名称:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">product</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\nbootloader版本:&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\nbootloader版本:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">bootloader</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\n硬件名称:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">hardware</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\n唯一标识码:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">fingerprint</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\nIMEI: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">getIMEI</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\nAndroidId: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">getAndroidId</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\nMac: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">getMacAddress</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">str</span> <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;\nAPI: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">device</span>.<span style="color:#a6e22e">sdkInt</span>;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">str</span>);
</span></span></code></pre></div><h3 id="打开应用市场app详情页">打开应用市场app详情页</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">//打开应用市场app详情页
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">startAppStore</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">toastLog</span>(<span style="color:#e6db74">&#34;去应用市场...&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">intent</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">action</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;VIEW&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// type: &#34;image/png&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">data</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">parseUri</span>(<span style="color:#e6db74">&#39;market://details?id=&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">pkgName</span>),
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">flags</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;activity_new_task&#34;</span>],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">packageName</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">myDevice</span>(<span style="color:#e6db74">&#34;Markets&#34;</span>),
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">startActivity</span>(<span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="检测app安装状态">检测app安装状态</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// 通过判断包名判断是否安装app
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">getAppName</span>(<span style="color:#a6e22e">pkgName</span>)
</span></span></code></pre></div><h3 id="获取当前时间">获取当前时间</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getCurData</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">now</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">timeNow</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">y</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getFullYear</span>(); <span style="color:#75715e">//得到年份
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getMonth</span>() <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;<span style="color:#75715e">//得到月份
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">d</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getDate</span>();<span style="color:#75715e">//得到日期
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// let day = now.getDay();//得到周几
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">h</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getHours</span>();<span style="color:#75715e">//得到小时数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getMinutes</span>();<span style="color:#75715e">//得到分钟数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getSeconds</span>();<span style="color:#75715e">//得到秒数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">timeNow</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">y</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">m</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">d</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">h</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">s</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// log(timeNow);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">timeNow</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="调试">调试</h2>
<p>在vscode内安装<a href="https://marketplace.visualstudio.com/items?itemName=aaroncheng.auto-js-vsce-fixed">调试插件</a></p>
<blockquote>
<p>1、按 <code>Ctrl+Shift+P</code> 或点击&quot;查看&quot;-&gt;&ldquo;命令面板&quot;可调出命令面板，输入 <code>Autox.js</code> 可以看到几个命令，移动光标到命令<code>Auto.js Autox,js: Start All Server</code>，按回车键执行该命令。</p>
<p>2、通过无线或有线连接</p>
<p>3、之后就可以在电脑上编辑JavaScript文件并通过命令<code>Run</code>或者按键<code>F5</code>在手机上运行了。</p>
</blockquote>
<h2 id="打包">打包</h2>
<p>调试完成后，按 <code>Ctrl+Shift+P</code> 或点击&quot;查看&rdquo;-&gt;&ldquo;命令面板&quot;可调出命令面板，输入 <code>Autox.js</code> 可以看到几个命令，移动光标到命令<code>Auto.js Autox,js: Save On Device</code>，按回车键执行该命令。</p>
<p>保存到手机上后，选择更多—打包应用</p>
<p>等待打包成功后，尽情享用吧！🎉</p>
<p>ps：目前最新版都是X64架构的，如需X32架构需要装老版本即可</p>
<hr>
<blockquote>
<p>ps：如果想想写个简单的小脚本，还是用autojs不错，简单轻便，用appium那一套架构太重了，杀鸡焉用牛刀啊！</p>
<p>提高认知，降维打击！</p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>测试笔记</title>
      <link>https://blog.zsan.cf/posts/test-notes/</link>
      <pubDate>Sun, 26 Jun 2022 13:52:23 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/test-notes/</guid>
      <description>关于测试的一些笔记</description>
      <content:encoded><![CDATA[<blockquote>
<p>关于测试的一些笔记（道）</p>
<p>道是心法，是最难考察的</p>
<p>术是工具，是可以简单考察出来的</p>
<p>目前公司JD还都是偏向术方面的</p>
<p>门槛低，导致测试的地位低下，还希望同行们共同努力💪呀</p>
</blockquote>
<p>1、测试技术领域最难的技术应该是测试分析和设计</p>
<blockquote>
<p>测试最重要的是什么？</p>
<p>有人说 我会 自动化测试，什么selenium，appium，python，玩的飞溜🙄️</p>
<p>而却忘了 最重要的输入——测试用例</p>
<p>一个系统，只要输入是错的，他再聪明、快速，那输出的也是错的</p>
</blockquote>
<p>2、测试价值的体现最主要还是保障自己组织开发的软件在关键应用时不要出故障，给组织造成商业损失。</p>
<p>3、测试分析和设计的深度及系统化，以及掌握广泛的专项测试类型。</p>
<p>4、测试工程师技术水平</p>
<p>5、快速编写测试用例</p>
<blockquote>
<p>1、根据用户行为习惯编写一套case</p>
<p>2、根据需求功能编写一套case</p>
<p>3、探索性测试编写一套case</p>
</blockquote>
<hr>
<p>如何用最通俗的方式给非测试者描述测试者存在的价值，</p>
<p>例如：给老板讲、给项目经理讲、给开发经理讲、给产品总负责人讲：</p>
<p>1、减少遗漏给用户的严重质量问题 （测试者在发布前尽可能发现影响用户体验的问题）</p>
<p>2、减少产品的研发和维护成本 （减少开发人员定位问题和修复问题的成本，减少产品售后维护成本）</p>
<p>3、缩短产品研发的周期 （帮助缺陷预防，尽早发现问题，复现问题，缩短开发修复和定位问题的成本)</p>
<p>参考文档：</p>
<blockquote>
<p>1、<a href="http://www.51testing.com/html/57/293557.html">架构师Jack</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>Docker 部署 Snapdrop</title>
      <link>https://blog.zsan.cf/posts/docker-deploy-snapdrop/</link>
      <pubDate>Sun, 19 Jun 2022 17:44:20 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/docker-deploy-snapdrop/</guid>
      <description>好用的跨平台文件传输工具（无需下载安装、打开网页即可使用）</description>
      <content:encoded><![CDATA[<blockquote>
<p>Snapdrop 是一个开源的在线文件传输工具，可以在 Windows、Mac、Linux、iOS、Android 任何平台使用，只要我们的设备有浏览器就能用他来传输文件</p>
<p>官网有demo，but不稳定，自部署一套稳定可靠可控</p>
</blockquote>
<p>官方已经上传<code>image</code> 了，所以下面手动下载的可以不用看了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">node</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">linuxserver/snapdrop</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># user: &#34;node&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">snapdrop</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>       - <span style="color:#ae81ff">80</span>:<span style="color:#ae81ff">80</span>
</span></span></code></pre></div><hr>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#git clone 下载</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/RobinLinus/snapdrop.git
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cd snapdrop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#国内服务需换源</span>
</span></span><span style="display:flex;"><span>cd docker
</span></span><span style="display:flex;"><span>vim nginx-with-openssl.Dockerfile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#RUN apk add --no-cache openssl 上方添加命令</span>
</span></span><span style="display:flex;"><span>RUN sed -i <span style="color:#e6db74">&#39;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#39;</span> /etc/apk/repositories
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#保存 启动</span>
</span></span><span style="display:flex;"><span>docker-compose up -d
</span></span></code></pre></div><p>常见问题：</p>
<p>    1、启动后日志里报</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">ERR</span><span style="color:#f92672">!</span> Error<span style="color:#f92672">:</span> <span style="color:#a6e22e">EACCES</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">permission</span> <span style="color:#a6e22e">denied</span>, <span style="color:#a6e22e">access</span> <span style="color:#e6db74">&#39;/home/node/app&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">ERR</span><span style="color:#f92672">!</span>  { Error<span style="color:#f92672">:</span> <span style="color:#a6e22e">EACCES</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">permission</span> <span style="color:#a6e22e">denied</span>, <span style="color:#a6e22e">access</span> <span style="color:#e6db74">&#39;/home/node/app&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">ERR</span><span style="color:#f92672">!</span>   <span style="color:#a6e22e">stack</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Error: EACCES: permission denied, access \&#39;/home/node/app\&#39;&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">ERR</span><span style="color:#f92672">!</span>   <span style="color:#a6e22e">errno</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">13</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">ERR</span><span style="color:#f92672">!</span>   <span style="color:#a6e22e">code</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;EACCES&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">ERR</span><span style="color:#f92672">!</span>   <span style="color:#a6e22e">syscall</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;access&#39;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">npm</span> <span style="color:#a6e22e">ERR</span><span style="color:#f92672">!</span>   <span style="color:#a6e22e">path</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;/home/node/app&#39;</span> }
</span></span></code></pre></div><p>权限 user的坑，我默认是root用户，yml里node启动为node用户，导致权限过低，启动失败</p>
<p>此时只需要把docker-compose.yml 里的user: &ldquo;node” 注释即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim docker-compose
</span></span><span style="display:flex;"><span><span style="color:#75715e">#user: &#34;node”</span>
</span></span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>【躺赚】docker部署网心云容器魔方</title>
      <link>https://blog.zsan.cf/posts/docker-deploying-netcentric-cloud-containers/</link>
      <pubDate>Mon, 09 May 2022 21:05:31 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/docker-deploying-netcentric-cloud-containers/</guid>
      <description>N1盒子外挂硬盘跑网心云赚钱</description>
      <content:encoded><![CDATA[<blockquote>
<p>设备：N1</p>
<p>硬盘：400g ssd</p>
<p>已安装服务：docker、docker-compose</p>
</blockquote>
<p>开干！</p>
<h3 id="一挂载ssd挂载过直接跳到第二步">一、挂载ssd（挂载过直接跳到第二步）</h3>
<p>硬盘插到N1上</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lsblk   <span style="color:#75715e">#查看当前磁盘情况</span>
</span></span><span style="display:flex;"><span>fdisk -l <span style="color:#75715e">#查看当前未挂载的磁盘</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#假设磁盘名为 dev/sda</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#创建分区</span>
</span></span><span style="display:flex;"><span>fdisk  dev/sda
</span></span><span style="display:flex;"><span><span style="color:#75715e">#输入n, p, 1, 两次回车，wq</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#新建一个主分区，大小整个磁盘，保存写入</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#写入文件格式</span>
</span></span><span style="display:flex;"><span>mkfs.ext4 /dev/sda  <span style="color:#75715e">#ext4格式</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#挂载</span>
</span></span><span style="display:flex;"><span>mount /dev/sda /media/data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看文件</span>
</span></span><span style="display:flex;"><span>df -lh    <span style="color:#75715e">#查看到刚才挂载的硬盘</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#设置开机自动挂载</span>
</span></span><span style="display:flex;"><span>vim /etc/fstab
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 在最后新增一行</span>
</span></span><span style="display:flex;"><span>/dev/sdb   /media/data    ext4   defaults   <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h3 id="二部署">二、部署</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir wxedge
</span></span><span style="display:flex;"><span>cd wxedge
</span></span><span style="display:flex;"><span>vim docker-compose.yml
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.3&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">wxedge</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">wxedge</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">privileged</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">network_mode</span>: <span style="color:#ae81ff">host</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">tmpfs</span>: 
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">/run</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">/tmp</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#e6db74">&#39;/media/data/wxedge:/storage:rw&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">onething1/wxedge</span>
</span></span></code></pre></div><p>ip:18888 打开 成功🎉🎉🎉</p>
<p>躺着赚钱吧！</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Docker 部署 Nginx服务</title>
      <link>https://blog.zsan.cf/posts/docker-build-nginx/</link>
      <pubDate>Fri, 08 Apr 2022 16:23:01 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/docker-build-nginx/</guid>
      <description>用docker部署nginx官方只给了docker版本的，没有compose的，只好自己转换一下了，记录一下，方便下次部署，这只是简单的部署，至于nginx配置的话，有空再补吧🫠
1、创建docker-nginx目录 新建 docker-compose.yml 文件
mkdir docker-nginx mkdir nginx mkdir log mkdir html vim docker-compose.yml 2、docker-compose.yml version: &amp;#39;3.3&amp;#39; services: web: image: nginx:latest container_name: nginx volumes: - ./nginx:/etc/nginx - ./log:/var/log/nginx - ./html:/usr/share/nginx/html //网站放置目录 ports: - &amp;#34;8081:80&amp;#34; environment: - NGINX_HOST=&amp;#34;192.168.116.10&amp;#34; //访问地址/域名 - NGINX_PORT=&amp;#34;80&amp;#34; //访问端口 - TZ=&amp;#34;Asia/Shanghai&amp;#34; //时区 restart: always 3、手动cp配置文件 由于官方image没有默认映射外部文件，需要手动把配置文件cp出来
# 运行官方命令创建默认容器 docker run --name nginx -p 8080:80 -d nginx #配置文件复制到nginx里,其他文件可用复制 #是个坑，路径必须是全路径 docker cp nginx:/etc/nginx /opt/docker-nginx #删除默认容器 docker stop nginx &amp;amp;&amp;amp; docker rm nginx 4、修改nginx配置文件 端口号、域名，ssl等和以前配置一样，不再赘述
5、运行&amp;amp;测试 docker-compose up -d #查看日志 docker-compose logs -f #浏览器输入IP或域名查看是否可以访问 参考文档：
1、Docker Hub-nginx</description>
      <content:encoded><![CDATA[<blockquote>
<p>用docker部署nginx官方只给了docker版本的，没有compose的，只好自己转换一下了，记录一下，方便下次部署，这只是简单的部署，至于nginx配置的话，有空再补吧🫠</p>
</blockquote>
<h2 id="1创建docker-nginx目录">1、创建docker-nginx目录</h2>
<p>新建 docker-compose.yml 文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mkdir docker-nginx
</span></span><span style="display:flex;"><span>mkdir nginx
</span></span><span style="display:flex;"><span>mkdir log
</span></span><span style="display:flex;"><span>mkdir html
</span></span><span style="display:flex;"><span>vim docker-compose.yml
</span></span></code></pre></div><h2 id="2docker-composeyml">2、docker-compose.yml</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.3&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">web</span>:
</span></span><span style="display:flex;"><span> <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:latest</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">nginx</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>     - <span style="color:#ae81ff">./nginx:/etc/nginx</span>
</span></span><span style="display:flex;"><span>     - <span style="color:#ae81ff">./log:/var/log/nginx</span>
</span></span><span style="display:flex;"><span>     - <span style="color:#ae81ff">./html:/usr/share/nginx/html  //网站放置目录</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>     - <span style="color:#e6db74">&#34;8081:80&#34;</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>     - <span style="color:#ae81ff">NGINX_HOST=&#34;192.168.116.10&#34; //访问地址/域名</span>
</span></span><span style="display:flex;"><span>     - <span style="color:#ae81ff">NGINX_PORT=&#34;80&#34; //访问端口</span>
</span></span><span style="display:flex;"><span>     - <span style="color:#ae81ff">TZ=&#34;Asia/Shanghai&#34; //时区</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span></code></pre></div><h2 id="3手动cp配置文件">3、手动cp配置文件</h2>
<p>由于官方image没有默认映射外部文件，需要手动把配置文件cp出来</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># 运行官方命令创建默认容器</span>
</span></span><span style="display:flex;"><span>docker run --name nginx -p 8080:80 -d nginx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#配置文件复制到nginx里,其他文件可用复制</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#是个坑，路径必须是全路径</span>
</span></span><span style="display:flex;"><span>docker cp nginx:/etc/nginx /opt/docker-nginx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#删除默认容器</span>
</span></span><span style="display:flex;"><span>docker stop nginx <span style="color:#f92672">&amp;&amp;</span> docker rm nginx
</span></span></code></pre></div><h2 id="4修改nginx配置文件">4、修改nginx配置文件</h2>
<p>端口号、域名，ssl等和以前配置一样，不再赘述</p>
<h2 id="5运行测试">5、运行&amp;测试</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker-compose up -d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#查看日志</span>
</span></span><span style="display:flex;"><span>docker-compose logs -f     
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#浏览器输入IP或域名查看是否可以访问</span>
</span></span></code></pre></div><hr>
<p>参考文档：</p>
<blockquote>
<p>1、<a href="https://hub.docker.com/_/nginx">Docker Hub-nginx</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>打破信息茧房</title>
      <link>https://blog.zsan.cf/posts/rss-build/</link>
      <pubDate>Sun, 13 Mar 2022 13:05:35 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/rss-build/</guid>
      <description>RSS服务快速搭建</description>
      <content:encoded><![CDATA[<p>何为信息茧房：</p>
<blockquote>
<p>哈佛大学凯斯·桑斯坦教授在《信息乌托邦》一书中提出，人类社会存在一种“信息茧房”现象。他认为，在信息传播中人们自身的信息需求并非全方位的，只会注意选择想要的或能使自己愉悦的信息，久而久之接触的信息就越来越局限，越来越窄，就像蚕吐出来的丝一样，细细密密地把自己包裹起来，最终像一个蚕宝宝一样被桎梏在“信息茧房”内，失去对其他不同事物的了解能力和接触机会。当时，他的这一观点还只是作为一种推论和预测，但随着网络信息和人工智能技术的飞速发展，这种“信息茧房”现象，正越来越多地发生在现实生活中和我们的身边。</p>
</blockquote>
<p>说人话就是：</p>
<blockquote>
<p>在现如今的生活中，人们接受信息的来源（主要指生活在大陆，国外也差不多），主要从微信、微博、抖音、快手等中心化的平台，各家相互关闭自己的开放接口，强迫用户留在自己平台上，有时候只关注某个大V的信息，却不得不安装一个app，就这样手机上装了很多app（这些app们平均一周更新一次，要吐了）再加上平台的推荐算法，只推荐你喜欢的（兼听则明，偏信则暗），这样下去，整个人的认知无法被提高</p>
</blockquote>
<p>经过一段时间的探索，搭建了RSS这套服务，RSS服务属于古老服务了，估计只有数字原住民才听说过，目前来说还可以，正在慢慢过渡，在此记录下搭建过程，方便下次迁移</p>
<blockquote>
<p><strong>RSS</strong>（英文全称：<a href="https://zh.wikipedia.org/wiki/Resource_Description_Framework" title="Resource Description Framework">RDF</a> Site Summary 或 Really Simple Syndication<a href="https://zh.wikipedia.org/wiki/RSS#cite_note-powers-2003-1-2">[2]</a>），中文译作<strong>简易信息聚合</strong><a href="https://zh.wikipedia.org/wiki/RSS#cite_note-3">[3]</a>，也称<strong>聚合内容</strong><a href="https://zh.wikipedia.org/wiki/RSS#cite_note-%E5%BC%A0%E9%94%902015-4">[4]</a>，是一种<a href="https://zh.wikipedia.org/wiki/%E6%B6%88%E6%81%AF%E4%BE%86%E6%BA%90" title="消息来源">消息来源</a>格式规范，用以聚合多个网站更新的内容并自动通知网站订阅者。使用 RSS 后，网站订阅者便无需再手动查看网站是否有新的内容，同时 RSS 可将多个网站更新的内容进行整合，以摘要的形式呈现，有助于订阅者快速获取重要信息，并选择性地点阅查看。</p>
<p>                                                                                                             ——引用wikipedia</p>
</blockquote>
<p>准备：</p>
<ul>
<li>需要一台服务器，运行linux即可       </li>
</ul>
<blockquote>
<p>配置不用太大，我用的是阿里云的服务器，生活在大陆，国内访问比较快</p>
</blockquote>
<p>用到的服务：</p>
<blockquote>
<p><a href="https://docs.rsshub.app/">RSSHub</a>：一个开源、简单易用、易于扩展的 RSS 生成器，可以给任何奇奇怪怪的内容生成 RSS 订阅源。</p>
<p><a href="http://ttrss.henry.wang/">TTRSS</a>：一款基于 PHP 的免费开源 RSS 聚合阅读器。</p>
</blockquote>
<p>用rsshub生成官方没有的订阅源，ttrss来管理订阅源的阅读记录，支持各端同步</p>
<h3 id="一部署rsshub">一、部署RSSHub</h3>
<p>支持docker部署，不过，我是部署到 Vercel 上的，好处是免费、国外的机子，真正连接到互联网的，国内可访问。</p>
<p>1、注册 <a href="https://vercel.com/import/project?template=https://github.com/DIYgod/RSSHub"> Vercel</a></p>
<blockquote>
<p>有帐户的直接可以登录部署</p>
<p>没有的先注册，建议用GitHub账号登录注册，github账号邮箱建议用gmail等国外的，通过率高，如果提示失败，可以和官方人员发email解封，我的当时就直接被冻结了，发了email后，一会就解封了，态度超好👍</p>
</blockquote>
<p>2、成功后可以直接点去部署了，我是没有用官方的库部署，fork官方库后去授权部署的，效果一样，vercel 用默认的就行，等待一会，撒花，表示部署成功</p>
<p>3、直接访问域名成功打开即部署成功</p>
<p>4、rsshub配置环境可参考 <a href="https://docs.rsshub.app/install/#pei-zhi">部署 | RSSHub</a> 配置</p>
<ul>
<li>
<p>用户认证</p>
</li>
<li>
<p>日志配置</p>
</li>
<li>
<p>其他一些服务需要的api-key</p>
</li>
</ul>
<p>5、在vercel 配置完 重新部署服务，才生效</p>
<h5 id="更新">更新</h5>
<p>支持vercel自动拉取代码更新</p>
<h3 id="二部署ttrss">二、部署TTRSS</h3>
<p>部署到vps 阿里云上，支持docker、docker-composr即可</p>
<h4 id="docker-compose部署">docker-compose部署</h4>
<ol>
<li>下载 <a href="https://github.com/HenryQW/Awesome-TTRSS/blob/main/docker-compose.yml">docker-compose.yml</a>至任意目录。</li>
<li>更改 <code>docker-compose.yml</code> 中的设置，请务必更改 postgres 用户密码。</li>
<li>通过终端在同目录下运行 <code>docker-compose up -d</code> 后等待部署完成。</li>
<li>默认通过 181 端口访问 TTRSS，默认账户：<code>admin</code> 密码：<code>password</code>，请第一时间更改。</li>
<li><code>wangqiru/mercury-parser-api</code> 及 <code>wangqiru/opencc-api-server</code> 为支持高级功能而加入的可选服务类容器，删除不会影响 TTRSS 基础功能。</li>
</ol>
<p>SELF_URL_PATH: TTRSS 实例地址。<strong>🔴 请注意，该变量值必须与你在浏览器中用于访问 TTRSS 的 URL 保持完全一致，否则 TTRSS 将无法启动。</strong></p>
<p>这里说明一下，如果没有域名就要配置为 ip:端口号 的形式</p>
<p>更多配置参考 <a href="http://ttrss.henry.wang/zh/#%E9%83%A8%E7%BD%B2">官方文档</a></p>
<h4 id="更新-1">更新</h4>
<p>推荐使用手动更新</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> <span style="color:#75715e">#自用</span>
</span></span><span style="display:flex;"><span> docker-compose pull
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#官方推荐</span>
</span></span><span style="display:flex;"><span> docker pull wangqiru/ttrss:latest
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># docker pull wangqiru/mercury-parser-api:latest</span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e"># docker pull wangqiru/opencc-api-server:latest</span>
</span></span><span style="display:flex;"><span> docker-compose up -d <span style="color:#75715e"># 如果您没有使用 docker-compose，我确信您知道该怎么做。</span>
</span></span></code></pre></div><h4 id="备份">备份</h4>
<p>养成定期备份的习惯，有些订阅源很重要的资料可以永久保存，避免404</p>
<ul>
<li>
<p>复制 Postgres 数据卷 <code>~/postgres/data/</code>（或者你在 docker-compose 中指定的目录）至其他任何地方作为备份，这非常重要！</p>
</li>
<li>
<p>执行如下命令来导出所有数据：</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#docker exec postgres pg_dumpall -c -U 数据库用户名 &gt; export.sql</span>
</span></span><span style="display:flex;"><span>docker exec postgres pg_dumpall -c -U postgres &gt; export.sql
</span></span></code></pre></div><ul>
<li>执行如下命令来导入所有数据：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#cat export.sql | docker exec -i postgres psql -U 数据库用户名</span>
</span></span><span style="display:flex;"><span>cat export.sql | docker exec -i postgres psql -U postgres
</span></span></code></pre></div><h3 id="三客户端推荐">三、客户端推荐</h3>
<p>服务端都配置好了，接下来就是如何阅读了</p>
<p>iOS/macOS：<a href="https://reederapp.com/">Reeder 5</a> 内置的 <a href="http://ttrss.henry.wang/zh/#fever-api">Fever API 模拟插件</a> 可以使用</p>
<p>android：FeedMe</p>
<p>Web：直接网页登录查看即可</p>
<h3 id="四订阅源订阅小技巧">四、订阅源订阅小技巧</h3>
<p>服务都搭建好了，下面就该订阅订阅源了，分享一些小技巧</p>
<ul>
<li>
<p>微博的可以使用 <a href="https://rssfeed.today/weibo/">Weibo to RSS</a> 订阅</p>
</li>
<li>
<p>微信的封锁严重，rsshub订阅有限，可以用 <a href="https://wechat2rss.xlab.app/posts/list/">公众号列表 | 微信公众号转RSS服务</a> 来订阅，如果没有想订阅的，可以提 <a href="https://github.com/ttttmr/wechat2rss/issues/7">提交新公众号前看这里 · Issue #7 · ttttmr/wechat2rss · GitHub</a></p>
</li>
<li>
<p>blogspot的rsshub没有提供，可以用cf反代后订阅</p>
</li>
<li>
<p>twitter 的开发者api太难申请了，可以用 <a href="https://nitter.net/">nitter</a> 输出的rss 访问困难再结合cf反代，完美</p>
</li>
</ul>
<p>以上，一个低成本，服务稳定，数据可控RSS生态部署成功，尽情享用吧！🎉</p>
<hr>
<p>参考文档：</p>
<blockquote>
<p><a href="https://docs.rsshub.app">RSSHub</a></p>
<p><a href="http://ttrss.henry.wang/zh/">🐋 Awesome TTRSS | 🐋 Awesome TTRSS</a></p>
<p><a href="https://diygod.me/ohmyrss/">我有特别的 RSS 使用技巧</a></p>
<p><a href="https://www.alpaca.plus/archives/my-rss-solution.html">我的RSS解决方案 - alpaca++</a></p>
<p><a href="http://www.mod.gov.cn/jmsd/2021-03/15/content_4880922.htm">警惕陷入“信息茧房” - 中华人民共和国国防部</a></p>
<p><a href="https://wiki.mbalib.com/wiki/%E4%BF%A1%E6%81%AF%E8%8C%A7%E6%88%BF">信息茧房 - MBA智库百科</a></p>
<p><a href="https://zh.wikipedia.org/wiki/RSS">RSS 维基百科</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>Linux设置代理</title>
      <link>https://blog.zsan.cf/posts/linux-unset-proxy/</link>
      <pubDate>Fri, 18 Feb 2022 18:04:50 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/linux-unset-proxy/</guid>
      <description>最近遇到一个很有点麻烦的事，以前在国内机上装了clash代理，用的编译包安装的，后来感觉用的不爽，就给卸载了，服务也去了，但是proxy代理经常会自动设置，有时候手动给取消了，下次再用又有了，这次终于忍不了了，就搜了一下给解决了
1、定位bug export 查看下，有相应端口，手动取消后，再查看没有了，重启后又有了，判断是某个脚本里带相关命令
2、搜索资料 通过查找得知有个.bashrc文件也可以设置环境变量，只对当前用户有效，vim进去看了下，果然有相应命令，删除，重启，再export，代理没了，结束🎉</description>
      <content:encoded><![CDATA[<blockquote>
<p>最近遇到一个很有点麻烦的事，以前在国内机上装了clash代理，用的编译包安装的，后来感觉用的不爽，就给卸载了，服务也去了，但是proxy代理经常会自动设置，有时候手动给取消了，下次再用又有了，这次终于忍不了了，就搜了一下给解决了</p>
</blockquote>
<h3 id="1定位bug">1、定位bug</h3>
<p>export 查看下，有相应端口，手动取消后，再查看没有了，重启后又有了，判断是某个脚本里带相关命令</p>
<h3 id="2搜索资料">2、搜索资料</h3>
<p>通过查找得知有个.bashrc文件也可以设置环境变量，只对当前用户有效，vim进去看了下，果然有相应命令，删除，重启，再export，代理没了，结束🎉</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>比价助手机器人docker快速部署</title>
      <link>https://blog.zsan.cf/posts/comparison-robot-building-for-docker/</link>
      <pubDate>Sun, 06 Feb 2022 17:05:32 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/comparison-robot-building-for-docker/</guid>
      <description>对于商品比价是个不错的购买商品的方法，可以给我们是否值得入手这件商品提供决策。各大商城有这方面数据但不会免费给分享出来，第三方网站有相关服务，但体验不好，相关api也太贵，这次找到了大佬免费提供的对话bot的比价助手——傻妞助手，应该是内置比价api吧！目前来说数据还可以值得参考的，用了docker部署，很快搞定！
一、部署傻妞助手bot 项目地址：GitHub - cdle/sillyGirl: 傻妞机器人
一键安装：支持linux arm64和amd64位 cd /opt s=sillyGirl;a=arm64;if [[ $(uname -a | grep &amp;#34;x86_64&amp;#34;) != &amp;#34;&amp;#34; ]];then a=amd64;fi ;if [ ! -d $s ];then mkdir $s;fi ;cd $s;wget https://github.com/cdle/${s}/releases/download/main/${s}_linux_$a -O $s &amp;amp;&amp;amp; chmod 777 $s;pkill -9 $s;$(pwd)/$s 在目录/etc/sillyGirl下新建sets.conf可以进行初始化配置
主要是配置管理员账号等，也可以通过对话配置
### 一些基础设置 ### # 傻妞机器人名 set sillyGirl name 傻妞 # 傻妞http服务端口 set sillyGirl port 800 # 傻妞消息撤回等待时间，单位秒 set sillyGirl duration 5 # 傻妞自动升级是否通知 set sillyGirl update_notify true # 是否开启傻妞自动更新 set sillyGirl auto_update false # 傻妞内置赞赏码 set sillyGirl appreciate https://gitee.com/aiancandle/sillyGirl/raw/main/appreciate.jpg #是否启动http服务 set sillyGirl enable_http_server true # 关闭守护模式，守护模式会导致没法自动升级 #systemctl disable sillyGirl ### 对接青龙的设置 ### # 设置青龙openapi的client_id参数 #set qinglong client_id ? # 设置青龙openapi的client_secret参数 #set qinglong client_secret ? # 青龙是否开启自动隐藏重复任务功能 #set qinglong autoCronHideDuplicate true # 设置青龙面板地址 #set qinglong host http://127.0.0.1:5700 ### 对接QQ的设置 ### # 设置qq登录账号 #set qq uin ? # 设置qq登录密码 #set qq password ? # 设置qq临时消息默认群号 #set qq tempMessageGroupCode ? # 指定要监听的qq群 #set qq onGroups g1&amp;amp;g2&amp;amp;g3... # 设置是否自动同意好友请求 #set qq auto_friend false # 设置是否对监听自身消息 #set qq onself true # 设置qq管理员 #set qq masters q1&amp;amp;q2&amp;amp;q3.</description>
      <content:encoded><![CDATA[<blockquote>
<p>对于商品比价是个不错的购买商品的方法，可以给我们是否值得入手这件商品提供决策。各大商城有这方面数据但不会免费给分享出来，第三方网站有相关服务，但体验不好，相关api也太贵，这次找到了大佬免费提供的对话bot的比价助手——傻妞助手，应该是内置比价api吧！目前来说数据还可以值得参考的，用了docker部署，很快搞定！</p>
</blockquote>
<h1 id="一部署傻妞助手bot">一、部署傻妞助手bot</h1>
<p>项目地址：<a href="https://github.com/cdle/sillyGirl">GitHub - cdle/sillyGirl: 傻妞机器人</a></p>
<h3 id="一键安装支持linux-arm64和amd64位">一键安装：支持linux arm64和amd64位</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /opt
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">=</span>sillyGirl;a<span style="color:#f92672">=</span>arm64;<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#66d9ef">$(</span>uname -a | grep <span style="color:#e6db74">&#34;x86_64&#34;</span><span style="color:#66d9ef">)</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">]]</span>;<span style="color:#66d9ef">then</span> a<span style="color:#f92672">=</span>amd64;<span style="color:#66d9ef">fi</span> ;<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! -d $s <span style="color:#f92672">]</span>;<span style="color:#66d9ef">then</span> mkdir $s;<span style="color:#66d9ef">fi</span> ;cd $s;wget https://github.com/cdle/<span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span>/releases/download/main/<span style="color:#e6db74">${</span>s<span style="color:#e6db74">}</span>_linux_$a -O $s <span style="color:#f92672">&amp;&amp;</span> chmod <span style="color:#ae81ff">777</span> $s;pkill -9 $s;<span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span>/$s
</span></span></code></pre></div><p>在目录/etc/sillyGirl下新建sets.conf可以进行初始化配置</p>
<p>主要是配置管理员账号等，也可以通过对话配置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>### 一些基础设置 ###
</span></span><span style="display:flex;"><span># 傻妞机器人名
</span></span><span style="display:flex;"><span>set sillyGirl name 傻妞
</span></span><span style="display:flex;"><span># 傻妞http服务端口
</span></span><span style="display:flex;"><span>set sillyGirl port 800
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 傻妞消息撤回等待时间，单位秒
</span></span><span style="display:flex;"><span>set sillyGirl duration 5
</span></span><span style="display:flex;"><span># 傻妞自动升级是否通知
</span></span><span style="display:flex;"><span>set sillyGirl update_notify true
</span></span><span style="display:flex;"><span># 是否开启傻妞自动更新
</span></span><span style="display:flex;"><span>set sillyGirl auto_update false
</span></span><span style="display:flex;"><span># 傻妞内置赞赏码
</span></span><span style="display:flex;"><span>set sillyGirl appreciate https://gitee.com/aiancandle/sillyGirl/raw/main/appreciate.jpg
</span></span><span style="display:flex;"><span>#是否启动http服务
</span></span><span style="display:flex;"><span>set sillyGirl enable_http_server true
</span></span><span style="display:flex;"><span># 关闭守护模式，守护模式会导致没法自动升级
</span></span><span style="display:flex;"><span>#systemctl disable sillyGirl
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接青龙的设置 ###
</span></span><span style="display:flex;"><span># 设置青龙openapi的client_id参数
</span></span><span style="display:flex;"><span>#set qinglong client_id ?
</span></span><span style="display:flex;"><span># 设置青龙openapi的client_secret参数
</span></span><span style="display:flex;"><span>#set qinglong client_secret ?
</span></span><span style="display:flex;"><span># 青龙是否开启自动隐藏重复任务功能
</span></span><span style="display:flex;"><span>#set qinglong autoCronHideDuplicate true
</span></span><span style="display:flex;"><span># 设置青龙面板地址
</span></span><span style="display:flex;"><span>#set qinglong host http://127.0.0.1:5700
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接QQ的设置 ###
</span></span><span style="display:flex;"><span># 设置qq登录账号
</span></span><span style="display:flex;"><span>#set qq uin ?
</span></span><span style="display:flex;"><span># 设置qq登录密码
</span></span><span style="display:flex;"><span>#set qq password ?
</span></span><span style="display:flex;"><span># 设置qq临时消息默认群号
</span></span><span style="display:flex;"><span>#set qq tempMessageGroupCode ?
</span></span><span style="display:flex;"><span># 指定要监听的qq群
</span></span><span style="display:flex;"><span>#set qq onGroups g1&amp;g2&amp;g3...
</span></span><span style="display:flex;"><span># 设置是否自动同意好友请求
</span></span><span style="display:flex;"><span>#set qq auto_friend false
</span></span><span style="display:flex;"><span># 设置是否对监听自身消息
</span></span><span style="display:flex;"><span>#set qq onself true
</span></span><span style="display:flex;"><span># 设置qq管理员
</span></span><span style="display:flex;"><span>#set qq masters q1&amp;q2&amp;q3...
</span></span><span style="display:flex;"><span># 设置接受通知的qq账号
</span></span><span style="display:flex;"><span>#set qq notifier q1&amp;q2&amp;q3...
</span></span><span style="display:flex;"><span># 设置qq设备信息(自动生成)
</span></span><span style="display:flex;"><span>#set qq device.json ?
</span></span><span style="display:flex;"><span># 设置qq登录令牌(自动生成)
</span></span><span style="display:flex;"><span>#set qq session.token ?
</span></span><span style="display:flex;"><span># 注销qqbot命令，重新运行扫码即可
</span></span><span style="display:flex;"><span>#delete qq session.token
</span></span><span style="display:flex;"><span># 指定系统通知发送对象命令，如不设置默认发送给所有管理员。
</span></span><span style="display:flex;"><span>#set [im type] notifiers [accounts join by &#39;&amp;&#39;] 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接telegram的设置 ###
</span></span><span style="display:flex;"><span># 设置telegram机器人token
</span></span><span style="display:flex;"><span>#set tg token ?
</span></span><span style="display:flex;"><span># 设置telegram机器人代理
</span></span><span style="display:flex;"><span>#set tg http_proxy ?
</span></span><span style="display:flex;"><span># 设置telegram机器人管理员
</span></span><span style="display:flex;"><span>#set tg masters t1&amp;t2&amp;t3...
</span></span><span style="display:flex;"><span># 设置接受通知的telegram账号
</span></span><span style="display:flex;"><span>#set tg notifier t1&amp;t2&amp;t3...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接微信公众号的设置 ###
</span></span><span style="display:flex;"><span># 设置微信公众平台app_id
</span></span><span style="display:flex;"><span>#set wxmp app_id ?
</span></span><span style="display:flex;"><span># 设置微信公众平台app_secret
</span></span><span style="display:flex;"><span>#set wxmp app_secret ?
</span></span><span style="display:flex;"><span># 设置微信公众平台token
</span></span><span style="display:flex;"><span>#set wxmp token ?
</span></span><span style="display:flex;"><span># 设置微信公众平台encoding_aes_key
</span></span><span style="display:flex;"><span>#set wxmp encoding_aes_key ?
</span></span><span style="display:flex;"><span># 设置微信公众平台管理员
</span></span><span style="display:flex;"><span>#set wxmp masters w1&amp;w2&amp;w3...
</span></span><span style="display:flex;"><span># 设置公众号关注事件回复
</span></span><span style="display:flex;"><span>#set wxmp subscribe_reply 感谢关注！
</span></span><span style="display:flex;"><span># 设置公众号默认回复
</span></span><span style="display:flex;"><span>#set wxmp default_reply 无法回复该消息
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接微信号的设置 ###
</span></span><span style="display:flex;"><span># 傻妞内置微信插件，依赖于可爱猫和http-sdk
</span></span><span style="display:flex;"><span># 傻妞远程处理接口 /wx/receive
</span></span><span style="display:flex;"><span># 设置插件调用地址，确保傻妞可以访问可爱猫端口
</span></span><span style="display:flex;"><span>#set wx api_url ?
</span></span><span style="display:flex;"><span># 设置图片转发模式，否则可能会出现此图片来自xx未经允许不得使用的提示
</span></span><span style="display:flex;"><span>set wx relay_mode true
</span></span><span style="display:flex;"><span># 设置指定转发地址，格式为 https://域名/relay?url=%s，不知道不用填
</span></span><span style="display:flex;"><span>#set wx relaier ?
</span></span><span style="display:flex;"><span># 设置# 傻妞是否动态网络地址，适用于# 傻妞家庭宽带而可爱猫在云服务器的情况下
</span></span><span style="display:flex;"><span>#set wx sillyGirl_dynamic_ip true
</span></span><span style="display:flex;"><span># 设置可爱猫是否动态网络地址，适用于可爱猫家庭宽带而# 傻妞在云服务器的情况下
</span></span><span style="display:flex;"><span>#set wx keaimao_dynamic_ip true
</span></span><span style="display:flex;"><span># 设置可爱猫端口
</span></span><span style="display:flex;"><span>#set wx keaimao_port ?
</span></span><span style="display:flex;"><span># 设置微信管理员
</span></span><span style="display:flex;"><span>#set wx masters ?
</span></span><span style="display:flex;"><span># vlw的API调用地址
</span></span><span style="display:flex;"><span>#set wx vlw_addr http://ip:port
</span></span><span style="display:flex;"><span># vlw的token
</span></span><span style="display:flex;"><span>#set wx vlw_token ?
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接pushplus的设置 ###
</span></span><span style="display:flex;"><span># 管理员推送绑定pushplus指令
</span></span><span style="display:flex;"><span>#set sillyGirl pushplus [token]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 关键词撤回功能，关键词支持正则表达式。
</span></span><span style="display:flex;"><span>#set sillyGirl recall 关键词1&amp;关键词2...
</span></span><span style="display:flex;"><span># 关键词回复功能，第一个问号是支持正则的关键词，第二个问号是回复的内容。
</span></span><span style="display:flex;"><span>#set reply ? ?
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接芝士的设置 ###
</span></span><span style="display:flex;"><span># 资产推送定时，以九点为例，包括失效提醒。
</span></span><span style="display:flex;"><span>set jd_cookie asset_push 0 9 * * *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 设置阿东登录地址，例：set jd_cookie adong_addr 192.168.1.1:5702
</span></span><span style="display:flex;"><span>#set jd_cookie adong_addr 阿东ip:端口
</span></span><span style="display:flex;"><span># 设置阿东qq机器人账号，这里的机器人qq账号，请务必和阿东go-cqhttp配置中config.yml里qq一样。
</span></span><span style="display:flex;"><span>#set jd_cookie selfQid 机器人qq账号
</span></span><span style="display:flex;"><span># 设置登录坑位
</span></span><span style="display:flex;"><span>#set jd_cookie login_num ?
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#设置诺兰登陆地址
</span></span><span style="display:flex;"><span>#set jd_cookie nolan_addr http://诺兰ip:端口
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># 对接xdd，额外设置参数
</span></span><span style="display:flex;"><span>#set jd_cookie xdd_token ?
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接小爱同学的设置 ###
</span></span><span style="display:flex;"><span># 小爱同学，可以指定API，对小爱说对话模式即可开启连续对话模式，闭嘴可关闭。
</span></span><span style="display:flex;"><span>#set sillyGirl 小爱同学 http://81.70.100.130/api/xiaoai.php?msg=%s&amp;n=text #挂了就自己换
</span></span><span style="display:flex;"><span>#set sillyGirl 小爱同学 http://jiuli.xiaoapi.cn/i/xiaoai_tts.php?msg=%s #挂了就自己换
</span></span><span style="display:flex;"><span># 处理json格式数据的小爱api，不填获取整个文本
</span></span><span style="display:flex;"><span>#set sillyGirl 小爱同学gjson text
</span></span><span style="display:flex;"><span># 删除处理json格式数据的小爱api
</span></span><span style="display:flex;"><span>#silly delete 小爱同学gjson
</span></span><span style="display:flex;"><span># 使用方法：
</span></span><span style="display:flex;"><span>#1、唤起小爱：发送“小爱+想说的话”，例如：小爱今天天气。
</span></span><span style="display:flex;"><span>#2、对话模式：发送“小爱对话模式”开启，发送“闭嘴”结束。
</span></span><span style="display:flex;"><span>#3、成语接龙：发送“成语接龙”开始。这个可应该不是小爱同学的功能，但我懒得单独写它了。
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>### 对接短网址的设置 ###
</span></span><span style="display:flex;"><span># 设置短网址服务地址，填傻妞对外的可以访问的地址。
</span></span><span style="display:flex;"><span>#set dwz address ?
</span></span><span style="display:flex;"><span># 设置短网址服务前缀
</span></span><span style="display:flex;"><span>#set dwz prefix d
</span></span><span style="display:flex;"><span># 使用方法
</span></span><span style="display:flex;"><span>#发送“短网址+你想要转换的网址“ #例：短网址 http://kejiwanjia.com/
</span></span></code></pre></div><h3 id="启动命令">启动命令</h3>
<p>配置完成后，在/opt/sillyGirl下执行 ./sillyGirl -t 查看是否运行成功</p>
<p>输入  time</p>
<p>成功后 执行 ./sillyGirl -d 后台运行</p>
<h3 id="其他常用命令">其他常用命令</h3>
<p>杀掉进程</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ps -A|grep sillyGirl
</span></span><span style="display:flex;"><span>kill pid 
</span></span></code></pre></div><p>查看端口是否开启</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>netstat -tlan
</span></span></code></pre></div><h1 id="二部署node-onebot">二、部署node-onebot</h1>
<blockquote>
<p>傻妞开发者把内置qq登录给去掉了，需要自己对接qqbot</p>
<p>官方给的是node安装的，需要安装node环境，太麻烦，改为用docker安装</p>
</blockquote>
<h3 id="1拉取代码">1、拉取代码</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>//国外机
</span></span><span style="display:flex;"><span>git clone https://github.com/takayama-lily/node-onebot
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>//国内机
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>git clone https://ghproxy.realproxy.workers.dev/https://github.com/takayama-lily/node-onebot
</span></span><span style="display:flex;"><span>机
</span></span></code></pre></div><h3 id="2修改dockerfile文件">2、修改Dockerfile文件</h3>
<p>修改默认Dockerfile里面最后一行的QQ号成自己的bot账号</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>FROM node:14-alpine
</span></span><span style="display:flex;"><span>WORKDIR /app
</span></span><span style="display:flex;"><span>COPY . .
</span></span><span style="display:flex;"><span>CMD [&#34;node&#34;, &#34;main&#34;,&#34;这里改为自己的bot账号&#34;]
</span></span></code></pre></div><h3 id="3创建configjs文件">3、创建config.js文件</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp config.sample.js config.js
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#e6db74">&#34;use strict&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 将此文件更名为config.js才能生效哦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//通用配置
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">general</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">platform</span><span style="color:#f92672">:</span>           <span style="color:#ae81ff">5</span>,      <span style="color:#75715e">//1:安卓手机 2:aPad 3:安卓手表 4:MacOS 5:iPad
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">debug</span><span style="color:#f92672">:</span>              <span style="color:#66d9ef">false</span>,  <span style="color:#75715e">//开启debug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">use_cqhttp_notice</span><span style="color:#f92672">:</span>  <span style="color:#66d9ef">true</span>,   <span style="color:#75715e">//是否使用cqhttp标准的notice事件格式
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">host</span><span style="color:#f92672">:</span>               <span style="color:#e6db74">&#34;localhost&#34;</span>,  <span style="color:#75715e">//监听主机名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">port</span><span style="color:#f92672">:</span>               <span style="color:#ae81ff">5700</span>,       <span style="color:#75715e">//端口
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">use_http</span><span style="color:#f92672">:</span>           <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//启用http
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">use_ws</span><span style="color:#f92672">:</span>             <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//启用正向ws，和http使用相同地址和端口
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">access_token</span><span style="color:#f92672">:</span>       <span style="color:#e6db74">&#34;&#34;</span>,         <span style="color:#75715e">//访问api的token
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">secret</span><span style="color:#f92672">:</span>             <span style="color:#e6db74">&#34;&#34;</span>,         <span style="color:#75715e">//上报数据的sha1签名密钥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">post_timeout</span><span style="color:#f92672">:</span>       <span style="color:#ae81ff">30</span>,         <span style="color:#75715e">//post超时时间(秒)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">post_message_format</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;array&#34;</span>,    <span style="color:#75715e">//&#34;string&#34;或&#34;array&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">enable_cors</span><span style="color:#f92672">:</span>        <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//是否允许跨域请求
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">enable_heartbeat</span><span style="color:#f92672">:</span>   <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//是否启用ws心跳
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">heartbeat_interval</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">15000</span>,      <span style="color:#75715e">//ws心跳间隔(毫秒)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">rate_limit_interval</span><span style="color:#f92672">:</span><span style="color:#ae81ff">500</span>,        <span style="color:#75715e">//使用_rate_limited后缀限速调用api的排队间隔时间(毫秒)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">event_filter</span><span style="color:#f92672">:</span>       <span style="color:#e6db74">&#34;&#34;</span>,         <span style="color:#75715e">//json格式的事件过滤器文件路径
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">post_url</span><span style="color:#f92672">:</span> [ <span style="color:#75715e">//上报地址，可以添加多个url
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// &#34;http://your.address.com:80&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ws_reverse_url</span><span style="color:#f92672">:</span> [ <span style="color:#75715e">//反向ws地址，可以添加多个url
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;ws://127.0.0.1:8080/qq/receive&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//这是傻妞的反向链接地址，其中的8080端口记得改成你傻妞的端口，同时开启傻妞的傻妞的http server，即set sillyGirl enable_http_server true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ws_reverse_reconnect_interval</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3000</span>, <span style="color:#75715e">//反向ws断线重连间隔(毫秒)，设为负数直接不重连
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">ws_reverse_reconnect_on_code_1000</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>, <span style="color:#75715e">//反向ws是否在关闭状态码为1000的时候重连
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//每个账号的单独配置(用于覆盖通用配置)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#ae81ff">147258369</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 安全注意：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 监听0.0.0.0表示监听网卡上的所有地址。如果你的机器可以通过公网ip直接访问，同时你也没有设定access_token，则被认为是极不安全的。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 你应该知道这样做会导致以下后果：任何人都可以无限制地访问你的Bot的所有API接口。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 如果只需要在本地访问，建议将监听地址改为localhost。需要通过公网访问，你最好设定access_token。
</span></span></span></code></pre></div><p>终极防风控：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#e6db74">&#34;use strict&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 将此文件更名为config.js才能生效哦
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//通用配置
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">general</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">platform</span><span style="color:#f92672">:</span>           <span style="color:#ae81ff">3</span>,      <span style="color:#75715e">//1:安卓手机 2:aPad 3:安卓手表 4:MacOS 5:iPad
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">debug</span><span style="color:#f92672">:</span>              <span style="color:#66d9ef">false</span>,  <span style="color:#75715e">//开启debug
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">use_cqhttp_notice</span><span style="color:#f92672">:</span>  <span style="color:#66d9ef">true</span>,   <span style="color:#75715e">//是否使用cqhttp标准的notice事件格式
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">host</span><span style="color:#f92672">:</span>               <span style="color:#e6db74">&#34;localhost&#34;</span>,  <span style="color:#75715e">//监听主机名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">port</span><span style="color:#f92672">:</span>               <span style="color:#ae81ff">5700</span>,       <span style="color:#75715e">//端口
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">use_http</span><span style="color:#f92672">:</span>           <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//启用http
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">use_ws</span><span style="color:#f92672">:</span>             <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//启用正向ws，和http使用相同地址和端口
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">access_token</span><span style="color:#f92672">:</span>       <span style="color:#e6db74">&#34;&#34;</span>,         <span style="color:#75715e">//访问api的token
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">secret</span><span style="color:#f92672">:</span>             <span style="color:#e6db74">&#34;&#34;</span>,         <span style="color:#75715e">//上报数据的sha1签名密钥
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">post_timeout</span><span style="color:#f92672">:</span>       <span style="color:#ae81ff">30</span>,         <span style="color:#75715e">//post超时时间(秒)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">post_message_format</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#34;array&#34;</span>,    <span style="color:#75715e">//&#34;string&#34;或&#34;array&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">enable_cors</span><span style="color:#f92672">:</span>        <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//是否允许跨域请求
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">enable_heartbeat</span><span style="color:#f92672">:</span>   <span style="color:#66d9ef">false</span>,      <span style="color:#75715e">//是否启用ws心跳
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">heartbeat_interval</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">15000</span>,      <span style="color:#75715e">//ws心跳间隔(毫秒)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">rate_limit_interval</span><span style="color:#f92672">:</span><span style="color:#ae81ff">500</span>,        <span style="color:#75715e">//使用_rate_limited后缀限速调用api的排队间隔时间(毫秒)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">event_filter</span><span style="color:#f92672">:</span>       <span style="color:#e6db74">&#34;&#34;</span>,         <span style="color:#75715e">//json格式的事件过滤器文件路径
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">post_url</span><span style="color:#f92672">:</span> [ <span style="color:#75715e">//上报地址，可以添加多个url
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#75715e">// &#34;http://your.address.com:80&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ws_reverse_url</span><span style="color:#f92672">:</span> [ <span style="color:#75715e">//反向ws地址，可以添加多个url
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;ws://127.0.0.1:8080/qq/receive&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//这是傻妞的反向链接地址，其中的8080端口记得改成你傻妞的端口，同时开启傻妞的傻妞的http server，即set sillyGirl enable_http_server true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        ],
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ws_reverse_reconnect_interval</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3000</span>, <span style="color:#75715e">//反向ws断线重连间隔(毫秒)，设为负数直接不重连
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">ws_reverse_reconnect_on_code_1000</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>, <span style="color:#75715e">//反向ws是否在关闭状态码为1000的时候重连
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//每个账号的单独配置(用于覆盖通用配置)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#ae81ff">147258369</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 安全注意：
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 监听0.0.0.0表示监听网卡上的所有地址。如果你的机器可以通过公网ip直接访问，同时你也没有设定access_token，则被认为是极不安全的。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 你应该知道这样做会导致以下后果：任何人都可以无限制地访问你的Bot的所有API接口。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// 如果只需要在本地访问，建议将监听地址改为localhost。需要通过公网访问，你最好设定access_token。
</span></span></span></code></pre></div><h3 id="4编译docker-image">4、编译docker image</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker build -t yongs/node-onebot:latest .
</span></span></code></pre></div><p>yongs自定义的，随便起，一定不要忘了 最后有个<u> . </u>表示在当前目录文件编译</p>
<h3 id="5启动image">5、启动image</h3>
<p>用的是docker-compose启动的，刚才拉的代码已经有yaml文件了，</p>
<p>需要注意 image名字是刚才编译的名字，不知道可以用</p>
<p>docker images 查看，修改image名字即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">miraiok</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">yongs/node-onebot</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">network_mode</span>: <span style="color:#e6db74">&#34;host&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./config.js:/root/config.js</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./data:/app/data</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">stdin_open</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">tty</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">docker-onebot</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose up -d
</span></span></code></pre></div><h3 id="6查看日志扫码登录不能登录进入容器内扫码">6、查看日志，<del>扫码登录，不能登录进入容器内扫码</del></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#查看日志</span>
</span></span><span style="display:flex;"><span>docker logs -f -n <span style="color:#ae81ff">500</span> docker-onebot
</span></span><span style="display:flex;"><span><span style="color:#75715e">#进入容器</span>
</span></span><span style="display:flex;"><span>docker exec -it docker-onebot /bin/sh
</span></span><span style="display:flex;"><span><span style="color:#75715e">#执行登录</span>
</span></span><span style="display:flex;"><span>node main <span style="color:#e6db74">&#34;botqq号&#34;</span>
</span></span></code></pre></div><p>给小助手发送命令看是否成功，比如 发送 name</p>
<p>发送 淘宝京豆拼多多链接看是否回复，回复即部署成功。</p>
<p>登录成功后，重启docker即可</p>
<p>这里的坑就是傻妞启动失败，导致onebot连接不上傻妞。</p>
<h3 id="7群被风控的解决办法">7、群被风控的解决办法</h3>
<p>参考了大佬的解决办法<a href="https://github.com/Mrs4s/go-cqhttp/issues/958#issuecomment-890430577">风控解除最终版</a></p>
<ol>
<li>
<p>开启设备锁，账号设置里面的</p>
</li>
<li>
<p>删除session.token 我是直接把整个账号文件夹删了</p>
</li>
<li>
<p>切换安卓协议  1或者3 我用的3</p>
</li>
<li>
<p>填写密码登陆</p>
</li>
<li>
<p>需要验证信息，根据提示一步一步操作即可（链接推荐在Chrome里打开查找）</p>
</li>
</ol>
<blockquote>
<p>参考链接：</p>
<p>1、<a href="https://www.kejiwanjia.com/jiaocheng/zheteng/19778.html#node-onebotqqbot">群晖傻妞SillyGirl完整部署教程 12.13更新node-onebot - 科技玩家</a></p>
<p>2、<a href="https://www.kejiwanjia.com/jiaocheng/51905.html">Docker编译node-onebot，傻妞又活了 - 科技玩家</a></p>
<p>3、<a href="https://github.com/AboutCXJ/SillyGirlDockerDeploy">GitHub - AboutCXJ/SillyGirlDockerDeploy</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>Hugo 自动更新文章修改时间</title>
      <link>https://blog.zsan.cf/posts/hugo-auto-update-lastmod/</link>
      <pubDate>Sat, 22 Jan 2022 21:34:31 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/hugo-auto-update-lastmod/</guid>
      <description>config配置文件里加上如下参数：
frontmatter: lastmod: - lastmod - :git - :fileModTime - :default 依次取的顺序为：
lastmod :最后提交时间
:git: 根据git提交版本时间
:fileModTime：文件修改时间
Configure Hugo | Hugo 写的都有,but是英文的🙃</description>
      <content:encoded><![CDATA[<p>config配置文件里加上如下参数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">frontmatter</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">lastmod</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">lastmod</span>
</span></span><span style="display:flex;"><span>        - :<span style="color:#ae81ff">git</span>
</span></span><span style="display:flex;"><span>        - :<span style="color:#ae81ff">fileModTime</span>
</span></span><span style="display:flex;"><span>        - :<span style="color:#ae81ff">default</span>
</span></span></code></pre></div><p>依次取的顺序为：</p>
<blockquote>
<p>lastmod :最后提交时间</p>
<p>:git: 根据git提交版本时间</p>
<p>:fileModTime：文件修改时间</p>
</blockquote>
<p><a href="https://gohugo.io/getting-started/configuration/#configure-front-matter">Configure Hugo | Hugo</a> 写的都有,but是英文的🙃</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Docker Compose部署filebrowser</title>
      <link>https://blog.zsan.cf/posts/docker-deploy-filebrowser/</link>
      <pubDate>Fri, 21 Jan 2022 11:24:05 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/posts/docker-deploy-filebrowser/</guid>
      <description>docker快速搭建个人网盘</description>
      <content:encoded><![CDATA[<p>在linuxserver服务器上安装</p>
<p>环境：docker、docker- compose</p>
<p>需要了解docker基本知识，不懂可以翻翻以前的博客或者搜下教程学习</p>
<p><a href="https://filebrowser.org/installation">filebrowser</a>官网上给的是docker命令执行的，但用compose习惯了，所以转换了一下格式，但是这里有个坑，官网也提示了</p>
<blockquote>
<p>By default, we already have a <a href="https://github.com/filebrowser/filebrowser/blob/master/docker/root/defaults/settings.json">configuration file with some defaults</a> so you can just mount the root and the database. Although you can overwrite by mounting a directory with a new config file. If you don&rsquo;t already have a database file, make sure to create a new empty file under the path you specified. Otherwise, Docker will create an empty folder instead of an empty file, resulting in an error when mounting the database into the container.</p>
</blockquote>
<p>翻译过来就是需要提前创建所需的文件和文件夹，否则，Docker会创建一个空的文件夹而不是空的文件，导致在将数据库挂载到容器中时出现错误！这点一定要注意啊！！！</p>
<h1 id="1创建docker-compose文件">1、创建docker-compose文件</h1>
<p>内容如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.3&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:     
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">filebrowser</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">filebrowser/filebrowser:s6</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">filebrowser</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumes</span>:  
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./root:/srv           </span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./database/filebrowser.db:/database/filebrowser.db </span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./settings.json:/config/settings.json</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">PUID=0</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">PGID=0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>: 
</span></span><span style="display:flex;"><span>            - <span style="color:#e6db74">&#39;8080:80&#39;</span>         
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span></code></pre></div><h1 id="2创建默认文件和文件夹">2、创建默认文件和文件夹</h1>
<p>对照上述docker-compose的路径，需要在当前目录创建 settings.json 文件，内容如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;port&#34;</span>: <span style="color:#ae81ff">80</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;baseURL&#34;</span>: <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;address&#34;</span>: <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;log&#34;</span>: <span style="color:#e6db74">&#34;stdout&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;database&#34;</span>: <span style="color:#e6db74">&#34;/database/filebrowser.db&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;root&#34;</span>: <span style="color:#e6db74">&#34;/srv&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>在当前目录创建 database/filebrowser.db 文件夹和文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir database
</span></span><span style="display:flex;"><span>cd database
</span></span><span style="display:flex;"><span>touch filebrowser.db
</span></span></code></pre></div><h1 id="3运行测试是否成功">3、运行测试是否成功</h1>
<p>执行 docker- compose logs -f 看下日志是否报错</p>
<p>需要其他机器访问记得防火墙 把端口打开，本例用的8080端口</p>
<p>浏览器访问 服务器ip:8080 成功打开即可，Enjoy it！🎉🎉🎉</p>
<h1 id="4n1小钢炮安装">4、n1小钢炮安装</h1>
<blockquote>
<p>灯大魔改的好久没更新了，功能好多不支持了，今天给升级（踩坑）了一下</p>
</blockquote>
<p>1、docker-compose需要改下配置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.3&#39;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:     
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">filebrowser</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">image</span>: <span style="color:#ae81ff">filebrowser/filebrowser</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">filebrowser</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">volumes</span>:  
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">/media:/srv           </span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./database/filebrowser.db:/database/filebrowser.db </span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">./settings.json:/config/settings.json</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">/etc/timezone:/etc/timezone   </span> <span style="color:#75715e">#时区 cst</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">/etc/localtime:/etc/localtime </span> <span style="color:#75715e">#时区 cst</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">PUID=1002</span>
</span></span><span style="display:flex;"><span>            - <span style="color:#ae81ff">PGID=100</span>
</span></span><span style="display:flex;"><span>              <span style="color:#75715e"># - TZ=Asia/Shanghai</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">ports</span>: 
</span></span><span style="display:flex;"><span>            - <span style="color:#e6db74">&#39;8081:80&#39;</span>         
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span></code></pre></div><p>2、灯大版的移除，执行这个即可</p>
<p>两个小坑，1、镜像要用laster的 2、时区设置用挂载的</p>
<blockquote>
<p>参考：</p>
<p>1、<a href="https://filebrowser.org">filebrowser官网</a></p>
<p>2、<a href="https://www.liuhaolin.com/zhuanzai/906.html">filebrowser 一个跨平台的文件管理器的使用方法-森林的个人博客</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>About</title>
      <link>https://blog.zsan.cf/about/</link>
      <pubDate>Thu, 13 Jan 2022 20:56:38 +0800</pubDate>
      
      <guid>https://blog.zsan.cf/about/</guid>
      <description>如果真的是你，请打招呼！
🏠 关于本站 内容+主题：Hugo &amp;amp; PaperMod
托管：GitHub Pages
域名：freenom
防护+CDN：Cloudflare
编辑器：VS code
这里主要记录一些平常遇到的一些技术坑(有些东西用完就忘了)，方便以后可以查阅😄
本站最开始是2019年就搭建了，当时用的hexo构建，部署在github，用netlify缓存服务，无奈当时穷，用的还是Windows本，命令敲的太不爽了，导致写文章没什么激情，基本断更🤣
来到2021年，经常在网上看大佬们的blog，时间有点空，就想把blog给拾起来，接触的技术也多了，也想记录下一些笔记，方便后面随时翻阅，正好在推上看到大佬们推荐gridea: ✍️ A static blog writing client (一个静态博客写作客户端)
傻瓜式操作，根据界面提示设置就行了，专注于写作，当时就下下来用了一段时间，也有比较鸡肋的地方，比如主题太少，自定义空间太小，还有就是windows7上不太稳定，有时会卡，可能我电脑垃圾吧，主题太少，有的主题不支持侧边目录栏，当时搜了好多文章，才改了一下主题，具体看这篇，还有就是，作者好久不更新了，专注于搞web端了，所以就在换了Mac后就换到了hugo上😄
hugo用go开发的，据说生成文章非常快，相比hexo来说，hugo在Mac上用命令也很舒服，主题也很多，所以就果断换了上来，专注写作，主题用的papermod，这是国外开发者开发的，中文资料太少，不过，搜了好多大佬的文章，基本上调试ok；还是用github做仓库来提供服务，用markdown来写文章，vs code来配置文件，在freenom上白嫖的一年域名，用脚本自动监控，到期提示；用cf来做域名解析和缓存服务。🎉
👨‍💻 张三是谁 🐜孤独时代的蚂蚁
🏫克莱登大学毕业
🍚欢迎老板打赏 要🍚｜老板行行好，赏点🍚吧</description>
      <content:encoded><![CDATA[<blockquote>
<p>如果真的是你，请打招呼！</p>
</blockquote>
<h2 id="-关于本站">🏠 关于本站</h2>
<blockquote>
<p>内容+主题：<a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/adityatelange/hugo-PaperMod/">PaperMod</a></p>
<p>托管：GitHub Pages</p>
<p>域名：<a href="https://www.freenom.com/">freenom</a></p>
<p>防护+CDN：<a href="https://www.cloudflare.com/">Cloudflare</a></p>
<p>编辑器：VS code</p>
</blockquote>
<p>这里主要记录一些平常遇到的一些技术坑(有些东西用完就忘了)，方便以后可以查阅😄</p>
<p>        本站最开始是2019年就搭建了，当时用的hexo构建，部署在github，用netlify缓存服务，无奈当时穷，用的还是Windows本，命令敲的太不爽了，导致写文章没什么激情，基本断更🤣</p>
<p>来到2021年，经常在网上看大佬们的blog，时间有点空，就想把blog给拾起来，接触的技术也多了，也想记录下一些笔记，方便后面随时翻阅，正好在推上看到大佬们推荐<a href="https://github.com/getgridea/gridea">gridea: ✍️ A static blog writing client (一个静态博客写作客户端)</a></p>
<p>        傻瓜式操作，根据界面提示设置就行了，专注于写作，当时就下下来用了一段时间，也有比较鸡肋的地方，比如主题太少，自定义空间太小，还有就是windows7上不太稳定，有时会卡，可能我电脑垃圾吧，主题太少，有的主题不支持侧边目录栏，当时搜了好多文章，才改了一下主题，具体看<a href="../posts/girde-simple-support-for-sidebar-directory/">这篇</a>，还有就是，作者好久不更新了，专注于搞web端了，所以就在换了Mac后就换到了hugo上😄</p>
<p>        <a href="https://gohugo.io/">hugo</a>用go开发的，据说生成文章非常快，相比hexo来说，hugo在Mac上用命令也很舒服，主题也很多，所以就果断换了上来，专注写作，主题用的<a href="https://git.io/hugopapermod">papermod</a>，这是国外开发者开发的，中文资料太少，不过，搜了好多大佬的文章，基本上调试ok；还是用github做仓库来提供服务，用markdown来写文章，vs code来配置文件，在<a href="https://www.freenom.com/">freenom</a>上白嫖的一年域名，用脚本自动监控，到期提示；用cf来做域名解析和缓存服务。🎉</p>
<h2 id="-张三是谁">👨‍💻 张三是谁</h2>
<p>🐜孤独时代的蚂蚁</p>
<p>🏫克莱登大学毕业</p>
<h2 id="欢迎老板打赏">🍚欢迎老板打赏</h2>
<p><a href="https://yaofan.site/">要🍚｜老板行行好，赏点🍚吧</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>docker 生成自己的镜像</title>
      <link>https://blog.zsan.cf/posts/docker-generate-image/</link>
      <pubDate>Mon, 21 Jun 2021 23:26:34 +0000</pubDate>
      
      <guid>https://blog.zsan.cf/posts/docker-generate-image/</guid>
      <description>看过前面的文章知道，大佬的库仓库也锁了，不能pull，只能换取仓库地址才行，为了一劳永逸，索性换了自己的库，只谈技术，不谈其他&amp;hellip;
1、创建Dockerfile文件 比较懒，直接把大佬的Dockerfile拉来换了仓库地址，rsa记着也要换
换完在当前目录 docker build -t jd_scripts .
直接生成自己的image
docker images 查看镜像
2、修改docker-compose文件 修改docker-compose里面的仓库地址为自己的地址，其他参数不用变
docker-compose up -d 启动镜像
完美运行！
继续躺平。
建议学学docker，真的好强大！
附上一个不错的docker教程
Docker —— 从入门到实践</description>
      <content:encoded><![CDATA[<p>看过前面的文章知道，大佬的库仓库也锁了，不能pull，只能换取仓库地址才行，为了一劳永逸，索性换了自己的库，只谈技术，不谈其他&hellip;</p>
<!-- more -->
<h3 id="1创建dockerfile文件">1、创建Dockerfile文件</h3>
<p>比较懒，直接把大佬的Dockerfile拉来换了仓库地址，rsa记着也要换</p>
<p>换完在当前目录 <code>docker build -t jd_scripts .</code></p>
<p>直接生成自己的image</p>
<p><code>docker images</code> 查看镜像</p>
<h3 id="2修改docker-compose文件">2、修改docker-compose文件</h3>
<p>修改docker-compose里面的仓库地址为自己的地址，其他参数不用变</p>
<p><code>docker-compose up -d</code> 启动镜像</p>
<p>完美运行！</p>
<p>继续躺平。</p>
<p>建议学学docker，真的好强大！</p>
<p>附上一个不错的docker教程</p>
<p><a href="https://yeasy.gitbook.io/docker_practice/"><img loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAABk0lEQVRYR&#43;2W3UvCUByGX7fchQpZuvmRq1WEUElWEEPMDMz&#43;mf7Bym4qJCjJCCsUJeii8hOhAt3AWGBkkc6dpF2c3e685zzn&#43;f3O2Syd4l4HJn4sFJCwOtQgoUBQg9QgqQHSPO1BapDUAGm&#43;bw9mr3K4zN70rMEwDFyTToRCQUwH/LAwDClD37wuQK&#43;Xh91u&#43;5hIaSt4LlfRarUhij7EohvgOG5kkLoAt&#43;MypBnxE0JVFZxfXOMuX8TCvISIvAaGZUcCaQhQI9EgU0dpVGt17O7EwPMucwFqNIVCCafpDFbDiwivLJkPsFKpYf/wGIEpH&#43;JbsnkBJ5zjSCY2kbvN/zj1g6hnJbHv5gz3oLZw12AX8OX1DY1GcxBTz3uHwwZBcP&#43;a&#43;RNA05bY1IdEu7APUieoN5pIJqLwePihSqt3sKESa3DpswxK9w/muKi/f&#43;oen8pQVBVzkoiIvA4rZ9UrZOhxugx&#43;nZUdYyG4XQgtB&#43;H3Cf/7szD0dkcQoL/8pFKpQWqQ1ABpnvYgNUhqgDRPe5DU4DsPyz1QKJJZDwAAAABJRU5ErkJggg==" alt="img"  />
Docker —— 从入门到实践</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>girde simple修改添加支持侧边栏目录</title>
      <link>https://blog.zsan.cf/posts/girde-simple-support-for-sidebar-directory/</link>
      <pubDate>Sun, 06 Jun 2021 18:50:26 +0000</pubDate>
      
      <guid>https://blog.zsan.cf/posts/girde-simple-support-for-sidebar-directory/</guid>
      <description>修改主题文件支持侧边栏目录
simple主题整体还行，但文章无侧边栏目录，一般写的技术性文章很长，就需要侧边栏目录和这个功能了，在网上搜了一下资料，对于前端小学生的我费了好长时间才搞定，记录一下过程。
1、修改post.ejs文件 head新增
&amp;lt;script src=&amp;quot;https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
搜索&amp;lt;%- post.content %&amp;gt;复制一下代码覆盖copy
&amp;lt;div class=&amp;#34;post-content-wrapper&amp;#34;&amp;gt; &amp;lt;div class=&amp;#34;post-content&amp;#34; v-pre&amp;gt; &amp;lt;%- post.content %&amp;gt; &amp;lt;/div&amp;gt; &amp;lt;div class=&amp;#34;toc-container&amp;#34;&amp;gt; &amp;lt;%- post.toc %&amp;gt; &amp;lt;/div&amp;gt; &amp;lt;/div&amp;gt; 新增高亮js
&amp;lt;script&amp;gt; hljs.initHighlightingOnLoad() let mainNavLinks = document.querySelectorAll(&amp;#34;.markdownIt-TOC a&amp;#34;); // This should probably be throttled. // Especially because it triggers during smooth scrolling. // https://lodash.com/docs/4.17.10#throttle // You could do like... // window.addEventListener(&amp;#34;scroll&amp;#34;, () =&amp;gt; { // _.throttle(doThatStuff, 100); // }); // Only not doing it here to keep this Pen dependency-free. window.addEventListener(&amp;#34;scroll&amp;#34;, event =&amp;gt; { let fromTop = window.scrollY; mainNavLinks.forEach((link, index) =&amp;gt; { let section = document.getElementById(decodeURI(link.hash).substring(1)); let nextSection = null if (mainNavLinks[index + 1]) { nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1)); } if (section.offsetTop &amp;lt;= fromTop) { if (nextSection) { if (nextSection.offsetTop &amp;gt; fromTop) { link.classList.add(&amp;#34;current&amp;#34;); } else { link.classList.remove(&amp;#34;current&amp;#34;); } } else { link.classList.add(&amp;#34;current&amp;#34;); } } else { link.classList.remove(&amp;#34;current&amp;#34;); } }); }); &amp;lt;/script&amp;gt; 2、客户端新增自定义css .toc-container .markdownIt-TOC { position: sticky; top: 32px; width: 200px; font-size: 12px; list-style: none; padding-left: 0; padding: 16px 8px; } .</description>
      <content:encoded><![CDATA[<p>修改主题文件支持侧边栏目录</p>
<!-- more -->
<p>simple主题整体还行，但文章无侧边栏目录，一般写的技术性文章很长，就需要侧边栏目录和这个功能了，在网上搜了一下资料，对于前端小学生的我费了好长时间才搞定，记录一下过程。</p>
<h3 id="1修改postejs文件">1、修改post.ejs文件</h3>
<p><code>head</code>新增</p>
<p><code>&lt;script src=&quot;https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js&quot;&gt;&lt;/script&gt;</code></p>
<p>搜索<code>&lt;%- post.content %&gt;</code>复制一下代码覆盖copy</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-content-wrapper&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-content&#34;</span> <span style="color:#a6e22e">v-pre</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">&lt;</span>%- post.content %&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;toc-container&#34;</span>&gt;
</span></span><span style="display:flex;"><span>   <span style="color:#960050;background-color:#1e0010">&lt;</span>%- post.toc %&gt;
</span></span><span style="display:flex;"><span> &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">div</span>&gt;
</span></span></code></pre></div><p>新增高亮js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">hljs</span>.<span style="color:#a6e22e">initHighlightingOnLoad</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">mainNavLinks</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelectorAll</span>(<span style="color:#e6db74">&#34;.markdownIt-TOC a&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// This should probably be throttled.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">// Especially because it triggers during smooth scrolling.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">// https://lodash.com/docs/4.17.10#throttle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">// You could do like...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">// window.addEventListener(&#34;scroll&#34;, () =&gt; {
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">//    _.throttle(doThatStuff, 100);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">// });
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#75715e">// Only not doing it here to keep this Pen dependency-free.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>      window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;scroll&#34;</span>, <span style="color:#a6e22e">event</span> =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">fromTop</span> <span style="color:#f92672">=</span> window.<span style="color:#a6e22e">scrollY</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">mainNavLinks</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">link</span>, <span style="color:#a6e22e">index</span>) =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">section</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(decodeURI(<span style="color:#a6e22e">link</span>.<span style="color:#a6e22e">hash</span>).<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">nextSection</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">mainNavLinks</span>[<span style="color:#a6e22e">index</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">nextSection</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(decodeURI(<span style="color:#a6e22e">mainNavLinks</span>[<span style="color:#a6e22e">index</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>].<span style="color:#a6e22e">hash</span>).<span style="color:#a6e22e">substring</span>(<span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">section</span>.<span style="color:#a6e22e">offsetTop</span> <span style="color:#f92672">&lt;=</span> <span style="color:#a6e22e">fromTop</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">nextSection</span>) {
</span></span><span style="display:flex;"><span>              <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">nextSection</span>.<span style="color:#a6e22e">offsetTop</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">fromTop</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">link</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;current&#34;</span>);
</span></span><span style="display:flex;"><span>              } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">link</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">remove</span>(<span style="color:#e6db74">&#34;current&#34;</span>);    
</span></span><span style="display:flex;"><span>              }
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>              <span style="color:#a6e22e">link</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;current&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">link</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">remove</span>(<span style="color:#e6db74">&#34;current&#34;</span>);
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/script&gt;</span>
</span></span></code></pre></div><h3 id="2客户端新增自定义css">2、客户端新增自定义css</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>  .<span style="color:#a6e22e">markdownIt-TOC</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">position</span>: <span style="color:#66d9ef">sticky</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">top</span>: <span style="color:#ae81ff">32</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">width</span>: <span style="color:#ae81ff">200</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-size</span>: <span style="color:#ae81ff">12</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">list-style</span>: <span style="color:#66d9ef">none</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding-left</span>: <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">16</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">8</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span> }
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>  .<span style="color:#a6e22e">markdownIt-TOC</span>:<span style="color:#a6e22e">before</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">content</span>: <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">position</span>: <span style="color:#66d9ef">absolute</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">top</span>: <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">left</span>: <span style="color:#ae81ff">8</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">bottom</span>: <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">width</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">background-color</span>: <span style="color:#ae81ff">#ebedef</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">.5</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>  <span style="color:#f92672">ul</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">list-style</span>: <span style="color:#66d9ef">none</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>  <span style="color:#f92672">li</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding-left</span>: <span style="color:#ae81ff">16</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>  <span style="color:#f92672">li</span> <span style="color:#f92672">a</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#868e96</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">4</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">block</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">transition</span>: <span style="color:#66d9ef">all</span> <span style="color:#ae81ff">0.3</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>  <span style="color:#f92672">li</span> <span style="color:#f92672">a</span>:<span style="color:#a6e22e">hover</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">background</span>: <span style="color:#ae81ff">#cddbef</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>  <span style="color:#f92672">li</span> <span style="color:#f92672">a</span>.<span style="color:#a6e22e">current</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#006CFF</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">background</span>: <span style="color:#ae81ff">#fafafa</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">post-content-wrapper</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">flex</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">post-content</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">width</span>: <span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">margin-right</span>: <span style="color:#ae81ff">20</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>@<span style="color:#66d9ef">media</span> <span style="color:#f92672">(</span><span style="color:#f92672">max-width</span><span style="color:#f92672">:</span> <span style="color:#f92672">1150px</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">toc-container</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">none</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="3修改maincss文件">3、修改main.css文件</h3>
<p>搜索<code>.post-detail</code> 修改<code>margin: 0 auto;</code>为</p>
<p><code>margin: 0 20px;</code></p>
<p>重新渲染网页即可尽情享用吧！</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>云服务器docker搭建自动领京豆bot互动指令</title>
      <link>https://blog.zsan.cf/posts/docker-build-jdbot/</link>
      <pubDate>Fri, 30 Apr 2021 22:49:08 +0000</pubDate>
      
      <guid>https://blog.zsan.cf/posts/docker-build-jdbot/</guid>
      <description>使用docker部署自动领金豆bot脚本
使用的版本：
服务器：centos 8
docker： 20.10.6
docker-compose： 1.27.4
1、服务器安装docker，docker-compose 推荐使用centos服务器安装docker、docker-compose
Docker安装
国内一键安装 curl -sSL https://get.daocloud.io/docker | sh 国外一键安装 curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun docker-compose安装
$ sudo curl -L &amp;quot;https://github.com/docker/compose/releases/download/1.24.1/docker-compose-$(uname -s)-$(uname -m)&amp;quot; -o /usr/local/bin/docker-compose
要安装其他版本的 Compose，请替换 1.24.1。
最新发行的版本地址：https://github.com/docker/compose/releases。
将可执行权限应用于二进制文件：
$ sudo chmod +x /usr/local/bin/docker-compose
创建软链：
$ sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
通过docker-compose version查看docker-compose版本，确认是否安装成功。
2、安装jd_scripts 创建一个目录jd_scripts用于存放备份配置等数据，迁移重装的时候只需要备份整个jd_scripts目录即可
需要新建的目录文件结构参考如下:
jd_scripts ├── logs │ ├── XXXX.log │ └── XXXX.log ├── my_crontab_list.sh └── docker-compose.yml jd_scripts/logs建一个空文件夹就行 jd_scripts/docker-compose.yml 参考内容如下(自己动手能力不行搞不定请使用默认配置)： 根据文档一步一步下去就ok了，下面主要记录下可能用到的命令
目录文件配置好之后在 jd_scripts目录执行。
docker-compose up -d 启动（修改docker-compose.yml后需要使用此命令使更改生效）；
docker-compose logs 打印日志；
docker-compose logs -f 打印日志，-f表示跟随日志； docker logs -f jd_scripts 和上面两条相比可以显示汉字； docker-compose pull 更新镜像；
docker-compose stop 停止容器；
docker-compose restart 重启容器；
docker-compose down 停止并删除容器；
3、开代理机器，激活tg-bot 这里是个大坑，拿个小本本记下来，其实就是docker内代理宿主机代理的问题
由于众所周知的原因，国内的机器不能访问tg，而又想使用tg-bot来控制，无奈，国外机子太贵（穷），最低也要5美刀！遂买国内机子开代理使用
1、买国内机器，推荐大厂的 这里应该放各大厂的aff的，留个坑
2、安装clash 一直在使用clash，直接网上搜索clash下载，找到对应版本下载，博主用的是centos，下载linux-amd64的
1、下载clash，最新版本可去官网找
wget https://github.com/Dreamacro/clash/releases/download/v0.19.0/clash-linux-amd64-v0.19.0.gz 2、解压
gzip -d clash-linux-amd64-v0.19.0.gz 3、移动至usr/bin/clash并重命名为clash
sudo mv clash-linux-amd64-v0.19.0 /usr/bin/clash 4、赋予clash运行权限
sudo chmod +x /usr/bin/clash 5、检查是否安装成功
clash -v 3、创建配置文件、安装控制面板 1.创建配置文件目录
mkdir -p /etc/clash/ 2.进入目录
cd /etc/clash/ 3.创建配置文件
vim config.yaml 4.手动编辑很麻烦，可用winscp上传
配置参数自行查找
5.下载前端代码
wget https://github.com/Dreamacro/clash-dashboard/tree/gh-pages 6.解压</description>
      <content:encoded><![CDATA[<p>使用docker部署自动领金豆bot脚本</p>
<!-- more -->
<p>使用的版本：</p>
<p>服务器：centos 8</p>
<p>docker： 20.10.6</p>
<p>docker-compose： 1.27.4</p>
<h3 id="1服务器安装dockerdocker-compose">1、服务器安装docker，docker-compose</h3>
<p>推荐使用centos服务器安装docker、docker-compose</p>
<p>Docker安装</p>
<ul>
<li>国内一键安装 <code>curl -sSL https://get.daocloud.io/docker | sh</code></li>
<li>国外一键安装 <code>curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</code></li>
</ul>
<p>docker-compose安装</p>
<p><code>$ sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.24.1/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</code></p>
<p>要安装其他版本的 Compose，请替换 1.24.1。</p>
<p>最新发行的版本地址：https://github.com/docker/compose/releases。</p>
<p>将可执行权限应用于二进制文件：</p>
<p><code>$ sudo chmod +x /usr/local/bin/docker-compose</code></p>
<p>创建软链：</p>
<p><code>$ sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose</code></p>
<p>通过<code>docker-compose version</code>查看<code>docker-compose</code>版本，确认是否安装成功。</p>
<h3 id="2安装jd_scripts">2、安装jd_scripts</h3>
<p>创建一个目录<code>jd_scripts</code>用于存放备份配置等数据，迁移重装的时候只需要备份整个jd_scripts目录即可</p>
<p>需要新建的目录文件结构参考如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>jd_scripts
</span></span><span style="display:flex;"><span>├── logs
</span></span><span style="display:flex;"><span>│   ├── XXXX.log
</span></span><span style="display:flex;"><span>│   └── XXXX.log
</span></span><span style="display:flex;"><span>├── my_crontab_list.sh
</span></span><span style="display:flex;"><span>└── docker-compose.yml
</span></span></code></pre></div><ul>
<li><code>jd_scripts/logs</code>建一个空文件夹就行</li>
<li><code>jd_scripts/docker-compose.yml</code> 参考内容如下(自己动手能力不行搞不定请使用默认配置)：</li>
</ul>
<p>根据文档一步一步下去就ok了，下面主要记录下可能用到的命令</p>
<p>目录文件配置好之后在 <code>jd_scripts</code>目录执行。<br>
<code>docker-compose up -d</code> 启动（修改docker-compose.yml后需要使用此命令使更改生效）；<br>
<code>docker-compose logs</code> 打印日志；<br>
<code>docker-compose logs -f</code> 打印日志，-f表示跟随日志；
<code>docker logs -f jd_scripts</code> 和上面两条相比可以显示汉字；
<code>docker-compose pull</code> 更新镜像；<br>
<code>docker-compose stop</code> 停止容器；<br>
<code>docker-compose restart</code> 重启容器；<br>
<code>docker-compose down</code> 停止并删除容器；</p>
<h3 id="3开代理机器激活tg-bot">3、开代理机器，激活tg-bot</h3>
<p>这里是个大坑，拿个小本本记下来，其实就是docker内代理宿主机代理的问题</p>
<p>由于众所周知的原因，国内的机器不能访问tg，而又想使用tg-bot来控制，无奈，国外机子太贵（穷），最低也要5美刀！遂买国内机子开代理使用</p>
<h5 id="1买国内机器推荐大厂的">1、买国内机器，推荐大厂的</h5>
<p>这里应该放各大厂的aff的，留个坑</p>
<h5 id="2安装clash">2、安装clash</h5>
<p>一直在使用clash，直接网上搜索clash<a href="https://github.com/Dreamacro/clash/releases">下载</a>，找到对应版本下载，博主用的是centos，下载linux-amd64的</p>
<p>1、下载clash，最新版本可去官网找</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget https://github.com/Dreamacro/clash/releases/download/v0.19.0/clash-linux-amd64-v0.19.0.gz
</span></span></code></pre></div><p>2、解压</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gzip -d clash-linux-amd64-v0.19.0.gz
</span></span></code></pre></div><p>3、移动至usr/bin/clash并重命名为clash</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo mv clash-linux-amd64-v0.19.0 /usr/bin/clash
</span></span></code></pre></div><p>4、赋予clash运行权限</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo chmod +x /usr/bin/clash
</span></span></code></pre></div><p>5、检查是否安装成功</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>clash -v 
</span></span></code></pre></div><h5 id="3创建配置文件安装控制面板">3、创建配置文件、安装控制面板</h5>
<p>1.创建配置文件目录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mkdir -p /etc/clash/
</span></span></code></pre></div><p>2.进入目录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd /etc/clash/
</span></span></code></pre></div><p>3.创建配置文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim config.yaml
</span></span></code></pre></div><p>4.手动编辑很麻烦，可用winscp上传</p>
<p>配置参数自行查找</p>
<p>5.下载前端代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wget https://github.com/Dreamacro/clash-dashboard/tree/gh-pages
</span></span></code></pre></div><p>6.解压</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>unzip gh-pages.zip
</span></span></code></pre></div><p>7.修改目录名,这里的目录名是上面配置文件里的 external-ui: dashboard</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mv clash-dashboard-gh-pages dashboard
</span></span></code></pre></div><p><a href="http://clash.razord.top/">可用这个面板远程控制</a></p>
<h5 id="4设置clash开机启动">4、设置clash开机启动</h5>
<p>1.创建service文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo vim /usr/lib/systemd/system/clash.service
</span></span></code></pre></div><p>2.输入下面代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>Unit<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Description<span style="color:#f92672">=</span>clash proxy
</span></span><span style="display:flex;"><span>After<span style="color:#f92672">=</span>network.target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Service<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Type<span style="color:#f92672">=</span>simple
</span></span><span style="display:flex;"><span>ExecStart<span style="color:#f92672">=</span>/usr/bin/clash -d /etc/clash
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Install<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>WantedBy<span style="color:#f92672">=</span>multi-user.target
</span></span></code></pre></div><p>3.重新加载 systemd 模块</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo systemctl daemon-reload
</span></span></code></pre></div><p>4.启动Clash</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo systemctl start clash.service
</span></span></code></pre></div><p>5.设置Clash开机自启动</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo systemctl enable clash.service
</span></span></code></pre></div><p>6.判断是否成功开启代理</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -I https://www.google.com
</span></span></code></pre></div><p>返回200即表示代理已经成功</p>
<h5 id="5自动更新订阅配置文件">5、自动更新订阅配置文件</h5>
<blockquote>
<p>通过shell脚本自动更新Clash在线配置</p>
</blockquote>
<p>通过systemctl来管理Clash的进程，对应<code>clash.service</code>文件，通过两个脚本<code>start-clash.sh</code>和<code>stop-clash.sh</code>来管理Clash的启停：</p>
<p>把上面的配置文件修改下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim /usr/lib/systemd/system/clash.service
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>Unit<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Description<span style="color:#f92672">=</span>clash proxy
</span></span><span style="display:flex;"><span>After<span style="color:#f92672">=</span>network.target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Service<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>WorkingDirectory<span style="color:#f92672">=</span>/当前用户目录/.config/clash
</span></span><span style="display:flex;"><span>Type<span style="color:#f92672">=</span>simple
</span></span><span style="display:flex;"><span>ExecStart<span style="color:#f92672">=</span>/当前用户目录/.config/clash/start-clash.sh
</span></span><span style="display:flex;"><span>ExecStop<span style="color:#f92672">=</span>/当前用户目录/.config/clash/stop-clash.sh
</span></span><span style="display:flex;"><span>Environment<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;HOME=/当前用户目录&#34;</span>
</span></span><span style="display:flex;"><span>Environment<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CLASH_URL=你的订阅链接&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Install<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>WantedBy<span style="color:#f92672">=</span>multi-user.target
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim /当前用户目录/.config/clash/start-clash.sh
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># save this file to ${HOME}/.config/clash/start-clash.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># save pid file</span>
</span></span><span style="display:flex;"><span>echo $$ &gt; <span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span>/.config/clash/clash.pid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>diff <span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span>/.config/clash/config.yaml &lt;<span style="color:#f92672">(</span>curl -s <span style="color:#e6db74">${</span>CLASH_URL<span style="color:#e6db74">}</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span>$?<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    /usr/bin/clash
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    TIME<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>date <span style="color:#e6db74">&#39;+%Y-%m-%d %H:%M:%S&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>    cp <span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span>/.config/clash/config.yaml <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span><span style="color:#e6db74">/.config/clash/config.yaml.bak</span><span style="color:#e6db74">${</span>TIME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    curl -L -o <span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span>/.config/clash/config.yaml <span style="color:#e6db74">${</span>CLASH_URL<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>    /usr/bin/clash
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim /当前用户目录/.config/clash/stop-clash.sh
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e"># save this file to ${HOME}/.config/clash/stop-clash.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># read pid file</span>
</span></span><span style="display:flex;"><span>PID<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cat <span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span>/.config/clash/clash.pid<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>kill -9 <span style="color:#e6db74">${</span>PID<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>rm <span style="color:#e6db74">${</span>HOME<span style="color:#e6db74">}</span>/.config/clash/clash.pid
</span></span></code></pre></div><p>配置添加完成后，如果你的clash 正在运行中，需要重新加载配置文件并重启</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ systemctl daemon-reload
</span></span><span style="display:flex;"><span>$ sudo systemctl restart clash.service
</span></span></code></pre></div><p>这样每次启动clash时就会自动更新配置文件了，接下来通过crontab 自动重启 clash.service实现自动更新节点</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#新建shell文件</span>
</span></span><span style="display:flex;"><span>vim restart-clash.sh
</span></span></code></pre></div><p>新增一条命令</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#/bin/sh</span>
</span></span><span style="display:flex;"><span>sudo systemctl restart clash.service
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod +x restart-clash.sh
</span></span><span style="display:flex;"><span>crontab -e
</span></span><span style="display:flex;"><span><span style="color:#75715e">#插入下面命令</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#每3小时重启一次</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0</span> */3 * * * restart-clash.sh
</span></span><span style="display:flex;"><span><span style="color:#75715e">#每分钟重启一次</span>
</span></span><span style="display:flex;"><span>* * * * * restart-clash.sh
</span></span></code></pre></div><p>大功告成，可通过<code>tail -500f /var/log/cron</code>查看定时任务是否执行</p>
<p><code>sudo systemctl status clash.service</code>  查看是否重启成功</p>
<h3 id="4docker内开代理">4、docker内开代理</h3>
<p>由于主要用来使用tg-bot，故只检测tgapi即可</p>
<p>1、判断宿主机可连接tgapi</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -sX POST <span style="color:#e6db74">&#34;https://api.telegram.org/bot&#39;&#39;&#39;Your Token&#39;&#39;&#39;/sendMessage&#34;</span> -d <span style="color:#e6db74">&#34;chat_id=&#34;</span>Some Chat id<span style="color:#e6db74">&#34;&amp;text=hello&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>curl -sX POST <span style="color:#e6db74">&#34;https://api.telegram.org/botxxxxxxxxugt5A/sendMessage&#34;</span> -d <span style="color:#e6db74">&#34;chat_id=48xxxxxx&amp;text=hello&#34;</span>
</span></span></code></pre></div><p>如果返回成功，即表示成功</p>
<p>2、进入容器</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker exec -it jd_scripts /bin/sh
</span></span></code></pre></div><p>执行步骤1命令，如若响应时间长或失败，则需要配置代理</p>
<p>3、配置容器代理走宿主机</p>
<p><a href="https://docs.docker.com/network/proxy/#use-environment-variables">docker官方有教程</a></p>
<p>docker版本大于 17.07以上可用下面的方法</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd
</span></span><span style="display:flex;"><span>mkdir .docker
</span></span><span style="display:flex;"><span>vim  ~/.docker/config.json
</span></span></code></pre></div><p>填入下面json</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span> <span style="color:#f92672">&#34;proxies&#34;</span>:
</span></span><span style="display:flex;"><span> {
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&#34;default&#34;</span>:
</span></span><span style="display:flex;"><span>   {
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&#34;httpProxy&#34;</span>: <span style="color:#e6db74">&#34;http://172.17.0.1:7890&#34;</span>,
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&#34;httpsProxy&#34;</span>: <span style="color:#e6db74">&#34;http://172.17.0.1:7890&#34;</span>,
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&#34;noProxy&#34;</span>: <span style="color:#e6db74">&#34;localhost,127.0.0.1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&#34;</span>
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>保存文件<strong>创建或者启动新容器时才生效</strong></p>
<p>这里有个大坑，搞了一天，就是</p>
<p><strong>代理的ip一定要写对！</strong></p>
<p><strong>代理的ip一定要写对！</strong></p>
<p><strong>代理的ip一定要写对!</strong></p>
<blockquote>
<p>下午调试的时候https的写成了127的了，机器启动起来，pull代码的时候，直接找不到文件，当时还骂这破代理，没法，就把报错ip不走代理了，没想到下面不报错了，直接无限重启，搞得头都大了，还在想是不是内存爆了呢！晚上，打开配置文件，定睛一看，WC！&ldquo;httpsProxy&quot;端口写的127&hellip;赶紧改了，重新跑遍，妥了，bot成功了！</p>
</blockquote>
<p>4、删除容器，重新启用</p>
<p>接下来在jd_scripts 目录内</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker-compose down
</span></span><span style="display:flex;"><span>docker-compose up -d
</span></span></code></pre></div><p>启动成功后，tgbot即可收到成功的消息，尽情享用吧！</p>
<h3 id="clash相关的管理命令">Clash相关的管理命令</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">## 启动Clash ##</span>
</span></span><span style="display:flex;"><span>sudo systemctl start clash.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 重启Clash ##</span>
</span></span><span style="display:flex;"><span>sudo systemctl restart clash.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 查看Clash运行状态 ##</span>
</span></span><span style="display:flex;"><span>sudo systemctl status clash.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 实时滚动状态 ##</span>
</span></span><span style="display:flex;"><span>sudo journalctl -u clash.service -f
</span></span></code></pre></div><h3 id="docker相关命令">docker相关命令</h3>
<p><code>docker exec -it jd_scripts /bin/sh -c 'git -C /scripts pull &amp;&amp; node /scripts/jd_bean_change.js'</code>  手动运行一脚本</p>
<p><code>docker exec -it jd_scripts /bin/sh -c 'env'</code>  查看设置的环境变量</p>
<p><code>docker exec -it jd_scripts /bin/sh -c 'crontab -l'</code>  查看已生效的crontab_list定时器任务</p>
<p><code>docker exec -it jd_scripts sh -c &quot;docker_entrypoint.sh&quot;</code> 手动更新jd_scripts仓库最新脚本</p>
<p><code>docker exec -it jd_scripts /bin/sh</code> 仅进入容器命令</p>
<p><code>rm -rf  logs/*.log</code> 删除logs文件夹里面所有的日志文件</p>
<ul>
<li>[1] <a href="https://github.com/wisz2021/jd_docker">jd_docker</a></li>
<li>[2] <a href="https://github.com/yuanlam/Clash-Linux">clash安装参考</a></li>
<li>[3] <a href="https://kebingzao.com/2019/02/22/docker-container-proxy/">docker内代理参考</a></li>
<li>[4] <a href="https://akillcool.github.io/post/clash-with-auto-update-config/">clash自动更新订阅配置</a></li>
</ul>
]]></content:encoded>
    </item>
    
    
    
  </channel>
</rss>
